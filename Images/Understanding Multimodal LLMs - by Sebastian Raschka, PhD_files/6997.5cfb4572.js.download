"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["6997"],{25938:function(e,t,n){n.d(t,{Z:()=>r});let r={submenu:"submenu-QuQCnq"}},96855:function(e,t,n){n.d(t,{Z:()=>r});let r={container:"container-WYWNQ7",enabled:"enabled-FrokEl",checked:"checked-qUvq71",unchecked:"unchecked-YpAQwg",disabled:"disabled-w7hZI3",nub:"nub-XpaYD_",theme_accent:"theme_accent-eoXELK",themeAccent:"theme_accent-eoXELK",theme_success:"theme_success-my5UzI",themeSuccess:"theme_success-my5UzI",theme_error:"theme_error-Uoe9a5",themeError:"theme_error-Uoe9a5",theme_select:"theme_select-TR6faD",themeSelect:"theme_select-TR6faD",theme_highlight:"theme_highlight-sw2S4n",themeHighlight:"theme_highlight-sw2S4n",theme_dark:"theme_dark-m15H85",themeDark:"theme_dark-m15H85",input:"input-b61VGF"}},87815:function(e,t,n){n.d(t,{Z:()=>r});let r={group:"group-JuxKi2",segment:"segment-XiSgAE",outlined:"outlined-kJWSK2"}},63029:function(e,t,n){n.d(t,{Z:()=>r});let r={mobileContainer:"mobileContainer-VYHM_K",imageContainer:"imageContainer-Xqytjt",hRule:"hRule-h3Z3UF",assetButtons:"assetButtons-qLcYTo",aspectRatioButton:"aspectRatioButton-x1zjUA",aspectRatioSelected:"aspectRatioSelected-FTsOFP",aspectRatioSelectedIcon:"aspectRatioSelectedIcon-VNG8Se"}},28775:function(e,t,n){n.d(t,{C:()=>p});var r=n(16584),i=n(30396),o=n(94184),a=n.n(o),l=n(7409),c=n(99282),s=n(64515);let u=e=>(0,r.BX)(s.l,(0,c._)((0,l._)({},e),{name:"DownloadIconNoBorder",svgParams:{height:32,width:32},children:[(0,r.tZ)("path",{d:"M23.5 18.5V21.8333C23.5 22.2754 23.3244 22.6993 23.0118 23.0118C22.6993 23.3244 22.2754 23.5 21.8333 23.5H10.1667C9.72464 23.5 9.30072 23.3244 8.98816 23.0118C8.67559 22.6993 8.5 22.2754 8.5 21.8333V18.5",stroke:e.stroke||"white",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"rgba(255,255,255,0)"}),(0,r.tZ)("path",{d:"M11.8333 14.3335L16 18.5002L20.1667 14.3335",stroke:e.stroke||"white",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"rgba(255,255,255,0)"}),(0,r.tZ)("path",{d:"M16 18.5V8.5",stroke:e.stroke||"white",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",fill:"rgba(255,255,255,0)"})]}));var d=n(95441),m=n(98248),h=n(81821);let g={root:"root-gpHBEU",fullSize:"fullSize-W6Pwju",link:"link-HgTAJz",linkHovered:"linkHovered-rnE2Gn",image:"image-ZSouY2",download:"download-aYXb5J",imageLoading:"imageLoading-BULJ5E"},p=e=>{let{img:t,imgDownload:n,shareData:o,useNativeShare:l,onClick:c}=e,{iString:s}=(0,d.M1)(),p=(0,i.sO)(null),v=(0,i.sO)(null),[f,w]=(0,i.eJ)(!1),[_,b]=(0,i.eJ)({right:0,bottom:0});(0,i.d4)(()=>{var e,t;let n=null===(e=p.current)||void 0===e?void 0:e.getBoundingClientRect(),r=null===(t=v.current)||void 0===t?void 0:t.getBoundingClientRect();n&&r&&b({right:r.right-n.right,bottom:r.bottom-n.bottom})},[p,v,t]);let k=(0,i.I4)(async e=>{if(null==c||c(),l&&o)try{await navigator.share(o)}catch(e){}else{var t;let n=null===(t=p.current)||void 0===t?void 0:t.getBoundingClientRect();if(n){let t=e.clientX,r=e.clientY;(t<n.left||t>n.right||r<n.top||r>n.bottom)&&e.preventDefault()}}},[c,l,o]);return(0,r.tZ)("a",{onClick:k,href:l?void 0:n,download:!0,className:a()(g.link,f&&g.linkHovered,g.fullSize),target:"_blank",children:(0,r.BX)("div",{ref:v,className:a()(g.root,g.fullSize),children:[!(0,h.tq)()&&t&&(0,r.tZ)("div",{className:g.download,style:_,children:(0,r.tZ)(u,{stroke:"#404040",fill:"white"})}),!t&&(0,r.tZ)("div",{className:a()(g.image,g.imageLoading),children:(0,r.tZ)(m.$j,{"aria-label":s("Loading")})}),t&&(0,r.tZ)("img",{ref:p,src:t,alt:s("Download Image"),className:a()(g.fullSize,g.image),onMouseEnter:()=>{w(!0)},onMouseLeave:()=>{w(!1)}})]})})}},57061:function(e,t,n){n.d(t,{d:()=>v});var r=n(58865),i=n(16584),o=n(28775),a=n(64719),l=n(95441),c=n(4038),s=n(68833),u=n(73943),d=n(60308);function m(){let e=(0,r._)([""," has reached $10,000 in annual revenue"]);return m=function(){return e},e}function h(){let e=(0,r._)([""," has reached $1,000 in annual revenue"]);return h=function(){return e},e}function g(){let e=(0,r._)([""," has reached 100 subscribers"]);return g=function(){return e},e}function p(){let e=(0,r._)([""," has reached 1,000 subscribers"]);return p=function(){return e},e}n(67844);let v=e=>{let t,{pub:n,style:r,milestone:v}=e,{iString:f,iTemplate:w}=(0,l.M1)(),_=(0,a.Cq)();switch(v){case u.dD.ARR10K:t=w(m(),n.name);break;case u.dD.ARR1K:t=w(h(),n.name);break;case u.bq.List100:t=w(g(),n.name);break;case u.bq.List1K:t=w(p(),n.name)}let{img:b,imgDownload:k,shareData:Z,useNativeShare:y}=(0,c.Q)({shareTitle:f("Share this milestone"),shareText:t,shareUrl:(0,d.SVA)(n),imageDownloadUrl:(0,d.iNT)(n,v,r,"".concat(v).concat(r.aspectRatio?" - ".concat(r.aspectRatio):"")),imageUrl:(0,d.iNT)(n,v,r,void 0),imageUrlSameOrigin:(0,d.RwZ)(n,v,r,{useRootDomain:null==_?void 0:_.isSubstack})});return(0,i.tZ)(o.C,{img:b,imgDownload:k,shareData:Z,useNativeShare:y,onClick:()=>{(0,s.j)(s.FP.MILESTONE_MEDIA_ASSETS_IMAGE_DOWNLOADED,{milestone:v,aspectRatio:r.aspectRatio,source:"image"})}})}},63049:function(e,t,n){n.d(t,{H:()=>u});var r=n(16584),i=n(28775),o=n(64719),a=n(95441),l=n(4038),c=n(68833),s=n(60308);n(76511);let u=e=>{let{pub:t,style:n}=e,{iString:u}=(0,a.M1)(),d=(0,o.Cq)(),{img:m,imgDownload:h,shareData:g,useNativeShare:p}=(0,l.Q)({shareTitle:u("Share this publication"),shareText:t.hero_text,shareUrl:(0,s.SVA)(t),imageDownloadUrl:(0,s.p5u)(t,null,n,{fileToDownload:"Message".concat(n.aspectRatio?" - ".concat(n.aspectRatio):"")}),imageUrl:(0,s.p5u)(t,null,n),imageUrlSameOrigin:(0,s.eq9)(t,n,{useRootDomain:null==d?void 0:d.isSubstack})});return(0,r.tZ)(i.C,{img:m,imgDownload:h,shareData:g,useNativeShare:p,onClick:()=>{(0,c.j)(c.FP.PUBLICATION_MEDIA_ASSETS_IMAGE_DOWNLOADED,{aspectRatio:n.aspectRatio,source:"image"})}})}},53687:function(e,t,n){n.d(t,{$I:()=>v,ar:()=>p,rn:()=>g,sl:()=>h});var r=n(16584),i=n(94184),o=n.n(i),a=n(13742),l=n(2922),c=n(30890),s=n(95441),u=n(15771),d=n(81821),m=n(66782);let h=["stories","instagram","square"],g=e=>{let{isSelected:t,value:n,onClick:i,coverImageUrl:l,themeVariables:c}=e,s=c.web_bg_color||c.cover_bg_color,d=c.print_on_web_bg_color||c.cover_print_primary||"#1a1a1a";return"accent"===n?(s=c.background_pop_color||c.background_pop,d=c.print_on_pop):"image"===n?(d="#ffffff",s="rgba(0,0,0,0.5)"):"black&white"===n&&(d="#404040",s="#ffffff"),(0,r.BX)(u.kG,{width:28,height:28,style:{backgroundColor:s},flex:"auto",radius:"sm",overflow:"hidden",alignItems:"center",justifyContent:"center",sizing:"border-box",className:o()(m.Z.customizeAssetButton,m.Z.themeButton,t&&m.Z.selected,"image"===n&&m.Z.image),onClick:e=>{e.preventDefault(),i()},tabIndex:0,children:["image"===n&&(0,r.tZ)("div",{className:m.Z.imageBg,style:{backgroundImage:"url(".concat(l,")")}}),(0,r.tZ)("div",{className:o()(m.Z.inner,"image"===n&&m.Z.image),children:t&&(0,r.tZ)(a.Z,{stroke:d,size:16,strokeWidth:2.5})})]})},p=e=>{let{isSelected:t,value:n,onClick:i}=e,o=function(e){let{iString:t}=(0,s.M1)(),n=(0,d.tq)({checkFirst4:!0}),r={instagram:t("Instagram"),square:t("Square"),stories:t("Vertical")};return(n?{square:"1:1",instagram:"4:5",stories:"9:16"}:r)[e]}(n);return(0,r.tZ)(u.zx,{size:"sm",priority:t?"primary-mono":"secondary",onClick:i,leading:"square"===n?(0,r.tZ)(l.Z,{size:20}):(0,r.tZ)(c.Z,{size:20}),children:o})},v=e=>{let{isSelected:t,label:n,onClick:i}=e;return(0,r.tZ)(u.zx,{size:"sm",priority:t?"primary-mono":"secondary",onClick:i,children:n})}},44404:function(e,t,n){n.d(t,{hi:()=>d,uP:()=>u});var r=n(16584),i=n(28775),o=n(64719),a=n(95441),l=n(4038),c=n(68833),s=n(60308);n(30279);let u=e=>{let{pub:t,user:n,note:u,style:d}=e,{iString:m}=(0,a.M1)(),h=(0,o.Cq)(),{img:g,imgDownload:p,shareData:v,useNativeShare:f}=(0,l.Q)({shareTitle:m("Share this message"),shareText:(null==u?void 0:u.note)||"",shareUrl:(0,s.SVA)(t),imageDownloadUrl:(0,s.gGz)(t,n,d,{fileToDownload:"Message".concat(d.aspectRatio?" - ".concat(d.aspectRatio):"")}),imageUrl:(0,s.gGz)(t,n,d),imageUrlSameOrigin:(0,s.MBd)(t,n,d,{useRootDomain:null==h?void 0:h.isSubstack})});return(0,r.tZ)(i.C,{img:g,imgDownload:p,shareData:v,useNativeShare:f,onClick:()=>{(0,c.j)(c.FP.SUBSCRIPTION_NOTE_MEDIA_ASSETS_IMAGE_DOWNLOADED,{note_from_user_id:n.id,aspectRatio:d.aspectRatio,source:"image"})}})},d=e=>{let{pub:t,user:n,note:u,style:d}=e,{iString:m}=(0,a.M1)(),h=(0,o.Cq)(),{img:g,imgDownload:p,shareData:v,useNativeShare:f}=(0,l.Q)({shareTitle:m("Share this message"),shareText:(null==u?void 0:u.note)||"",shareUrl:(0,s.SVA)(t),imageDownloadUrl:(0,s.uQO)(t,n,d,{fileToDownload:"Message".concat(d.aspectRatio?" - ".concat(d.aspectRatio):"")}),imageUrl:(0,s.uQO)(t,n,d),imageUrlSameOrigin:(0,s.BtY)(t,n,d,{useRootDomain:null==h?void 0:h.isSubstack})});return(0,r.tZ)(i.C,{img:g,imgDownload:p,shareData:v,useNativeShare:f,onClick:()=>{(0,c.j)(c.FP.PLEDGE_NOTE_MEDIA_ASSETS_IMAGE_DOWNLOADED,{note_from_user_id:n.id,aspectRatio:d.aspectRatio,source:"image"})}})}},29493:function(e,t,n){n.d(t,{Z:()=>l});var r=n(27412),i=n(16584),o=n(6400);let a=!1;"undefined"!=typeof window&&(window.__captchaOnloadCallback=function(){if(a&&Array.isArray(a)){let e=a;for(let t of(a=!0,e))t()}});class l extends o.Component{async componentDidMount(){await new Promise(e=>{!0===a?e():!1===a?(a=[e],function(){var e;let t=document.getElementsByTagName("script")[0],n=document.createElement("script");n.type="text/javascript",n.async=!0,n.defer=!0,n.src="https://www.google.com/recaptcha/api.js?render=explicit&onload=__captchaOnloadCallback",null==t||null===(e=t.parentNode)||void 0===e||e.insertBefore(n,t)}()):a.push(e)}),this.captchaId=window.grecaptcha.render(this.base,{sitekey:window._preloads.captcha_site_key,size:"compact"})}getResponse(){var e;return null===(e=window.grecaptcha)||void 0===e?void 0:e.getResponse(this.captchaId)}render(e){let{className:t}=e;return(0,i.tZ)("div",{className:t})}constructor(...e){super(...e),(0,r._)(this,"captchaId",void 0)}}},64719:function(e,t,n){n.d(t,{Cq:()=>l,UN:()=>c,_j:()=>a});var r=n(16584),i=n(6400),o=n(30396);let a=(0,i.createContext)({isSubstack:!1,customDomain:null});function l(){return(0,o.qp)(a)}function c(e){let{value:t,children:n}=e,i=(0,o.Ye)(()=>t,Object.values(t));return(0,r.tZ)(a.Provider,{value:i,children:n})}a.displayName="DomainInfoContext"},30372:function(e,t,n){n.d(t,{PS:()=>p,Pi:()=>g,UO:()=>f,aG:()=>v});var r=n(7409),i=n(99282),o=n(16584),a=n(6400),l=n(98661),c=n(30396),s=n(68833),u=n(21159),d=n(98914);let m={1:30,2:20,3:10},h=(0,a.createContext)({startInterval:()=>void 0,stopInterval:()=>void 0,trackInterval:()=>void 0,getCurrentUuid:()=>""});function g(e){let{children:t}=e,n=(0,c.sO)(null),r=(0,c.sO)(null),i=(0,c.sO)({top:0,bottom:0}),a=(0,c.sO)(null),l=(0,c.I4)(()=>{if(a.current){let{uuid:e,postId:t,containerElementRef:n,elementIsStatic:o,phase:l,count:c}=a.current;if(l&&l>3){g();return}if(c&&c>=m[l]){v();return}a.current.count=c+1;let d=(null==n?void 0:n.current)?(0,u.X)(n.current,null!=o&&o):i.current,h=d.top.toFixed(2),p=d.bottom.toFixed(2);(0,s.j)(s.FP.POST_PINGBACK_SEEN,{tracker_uuid:e,post_id:t,top_scroll_percentage:h,bottom_scroll_percentage:p,phase:l,count:c+1}),r.current!==h&&(r.current=h,t&&f(t,"read",d.top/100))}},[]),g=(0,c.I4)(()=>{n.current&&(clearInterval(n.current),n.current=null)},[]),p=()=>{var e,t;return 10**(null!==(t=null===(e=a.current)||void 0===e?void 0:e.phase)&&void 0!==t?t:1)*1e3},v=()=>{g(),a.current&&(a.current.phase+=1,a.current.count=0),n.current=setInterval(l,p())},w=(0,c.I4)(e=>{var t;let{postId:r,containerElementRef:i,elementIsStatic:o,phase:c=1,count:s=0}=e;"undefined"!=typeof window&&r&&i&&((null===(t=a.current)||void 0===t?void 0:t.postId)!==r&&(a.current={uuid:(0,d.EH)(),postId:r,containerElementRef:i,elementIsStatic:o,phase:c,count:s}),g(),n.current=setInterval(l,p()))},[l,g]),_=(0,c.I4)(()=>{var e;return(null===(e=a.current)||void 0===e?void 0:e.uuid)||""},[]);return(0,c.d4)(()=>{let e=()=>{var e,t,n,r,i,o,c;document.hidden?(l(),g()):(null===(e=a.current)||void 0===e?void 0:e.postId)&&(null===(t=a.current)||void 0===t?void 0:t.containerElementRef)&&w({postId:null===(n=a.current)||void 0===n?void 0:n.postId,containerElementRef:null===(r=a.current)||void 0===r?void 0:r.containerElementRef,elementIsStatic:null===(i=a.current)||void 0===i?void 0:i.elementIsStatic,phase:null===(o=a.current)||void 0===o?void 0:o.phase,count:null===(c=a.current)||void 0===c?void 0:c.count})};return document.addEventListener("visibilitychange",e),()=>{l(),a.current=null,g(),document.removeEventListener("visibilitychange",e)}},[w,g]),(0,c.d4)(()=>{let e=e=>{var t,n,r,o,l;let c=null===(n=a.current)||void 0===n?void 0:null===(t=n.containerElementRef)||void 0===t?void 0:t.current,s=null===(r=a.current)||void 0===r?void 0:r.elementIsStatic;c&&e.target===c&&(null===(l=a.current)||void 0===l?void 0:null===(o=l.containerElementRef)||void 0===o?void 0:o.current)&&(i.current=(0,u.X)(c,null!=s&&s))};return window.addEventListener("scroll",e,!0),()=>{window.removeEventListener("scroll",e,!0)}},[w,g]),(0,o.tZ)(h.Provider,{value:{startInterval:w,stopInterval:g,trackInterval:l,getCurrentUuid:_},children:t})}function p(){return(0,c.qp)(h)}function v(e){let t=(0,l.forwardRef)((t,n)=>{let a=p();return(0,o.tZ)(e,(0,i._)((0,r._)({},a,t),{ref:n}))});return t.displayName="withPostPingbackTrackerContext(".concat(e.displayName||e.name||"Anonymous",")"),t}function f(e,t,n){var r;"undefined"!=typeof window&&(null===(r=window._preloads)||void 0===r?void 0:r.user)&&!window._preloads.user.is_magic&&fetch("/api/v1/posts/".concat(e,"/progress?type=").concat(t,"&progress=").concat(n),{method:"POST"}).catch(e=>{console.error("Failed to mark video progress:",e)})}h.displayName="PostPingbackTrackerContext"},6910:function(e,t,n){n.d(t,{m:()=>l});var r=n(7409),i=n(99282),o=n(98848),a=n(16584);function l(e){var{size:t=20,stroke:n="var(--color-light-fg-secondary)"}=e,l=(0,o._)(e,["size","stroke"]);return(0,a.tZ)("svg",(0,i._)((0,r._)({},l),{width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:n,xmlns:"http://www.w3.org/2000/svg",children:(0,a.tZ)("path",{id:"Vector",d:"M3 22C3 17.7044 6.69722 14.2222 11.258 14.2222C11.5081 14.2222 11.7556 14.2326 12 14.2531M21.0039 16.3098L18.6469 18.6668M18.6469 18.6668L16.2899 21.0239M18.6469 18.6668L21.0178 21.0377M18.6469 18.6668L16.276 16.2959M16.4118 6.44444C16.4118 8.89904 14.4102 10.8889 11.9412 10.8889C9.47214 10.8889 7.47059 8.89904 7.47059 6.44444C7.47059 3.98985 9.47214 2 11.9412 2C14.4102 2 16.4118 3.98985 16.4118 6.44444Z",strokeWidth:"2",strokeLinecap:"round","stroke-linejoin":"round"})}))}},33668:function(e,t,n){n.d(t,{e:()=>i});var r=n(30396);function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=(0,r.sO)(e);return(0,r.d4)(()=>{var e;null===(e=t.current)||void 0===e||e.focus()},[]),t}},4038:function(e,t,n){n.d(t,{Q:()=>l});var r=n(30396),i=n(52384),o=n(98914),a=n(81821);function l(e){let[t,n]=(0,r.eJ)(""),[l,c]=(0,r.eJ)(""),[s,u]=(0,r.eJ)({}),[d,m]=(0,r.eJ)(!1);(0,r.d4)(()=>{(0,a.tq)()&&navigator.share&&navigator.canShare(s)&&m(!0)},[s]),(0,r.d4)(()=>{(async function(){n("");let t=e.imageUrl;if((0,o.pt)(e.imageUrl,()=>{n(t),c(e.imageDownloadUrl)}),(0,a.tq)()){var r,i;let n=await fetch(e.imageUrlSameOrigin||t),o=["instagram","instagram-stories"].includes(null!==(r=e.shareApp)&&void 0!==r?r:"");u({title:o?void 0:e.shareTitle,text:o?void 0:null!==(i=e.shareText)&&void 0!==i?i:void 0,files:[new File([await n.blob()],"image.png",{type:"image/png"})],url:o?void 0:e.shareUrl})}})()},[e.imageDownloadUrl,e.imageUrl,e.shareApp,e.shareText,e.shareTitle,e.shareUrl]);let{refetch:h}=(0,i.Q)({method:"post",pathname:"/api/v1/press_kit/notification",body:{title:e.shareText,imageUrl:e.imageUrl,shareApp:e.shareApp},deps:[e.shareText,e.imageUrl,e.shareApp]});return{img:t,imgDownload:l,sendPushNotification:(0,r.I4)(async()=>{let e=await h();return!(e instanceof Error)&&e.success},[h]),shareData:s,useNativeShare:d}}},21159:function(e,t,n){n.d(t,{X:()=>i,m:()=>r});let r=(e,t)=>{if(!e)return 0;let{scrollHeight:n,clientHeight:r}=e;return Math.min(t/100*(n-r),Math.max(0,n-r))},i=(e,t)=>{var n,r,i,o;let{scrollTop:a,scrollHeight:l,clientHeight:c}=t?{scrollTop:document.documentElement.scrollTop||document.body.scrollTop,scrollHeight:null!==(n=null==e?void 0:e.scrollHeight)&&void 0!==n?n:0,clientHeight:window.innerHeight}:{scrollTop:null!==(r=null==e?void 0:e.scrollTop)&&void 0!==r?r:0,scrollHeight:null!==(i=null==e?void 0:e.scrollHeight)&&void 0!==i?i:0,clientHeight:null!==(o=null==e?void 0:e.clientHeight)&&void 0!==o?o:0};return l&&c?l===c?{top:0,bottom:100}:{top:Math.min(100,a/(l-c)*100),bottom:Math.min(100,(a+c)/l*100)}:{top:0,bottom:0}}},57640:function(e,t,n){n.d(t,{Y:()=>m});var r=n(7409),i=n(99282),o=n(98848),a=n(16584),l=n(94184),c=n.n(l),s=n(71068),u=n(19081),d=n(96855);let m=e=>{var{checked:t,disabled:n,theme:l="accent",id:m}=e,h=(0,o._)(e,["checked","disabled","theme","id"]);return(0,a.BX)(u.hs,{height:20,width:20,position:"relative",radius:"full",sizing:"border-box",className:c()(d.Z.container,t?d.Z.checked:d.Z.unchecked,n?d.Z.disabled:d.Z.enabled,d.Z["theme_".concat(l)]),justifyContent:"center",alignItems:"center",flex:"auto",children:[(0,a.tZ)("input",(0,i._)((0,r._)({},h),{id:m,checked:t,disabled:n,type:"radio",className:c()(d.Z.input,n?d.Z.disabled:d.Z.enabled,d.Z["theme_".concat(l)])})),(0,a.tZ)(s.xu,{as:"span",radius:"full","aria-hidden":"true",className:c()(d.Z.nub,t?d.Z.checked:d.Z.unchecked,n?d.Z.disabled:d.Z.enabled,d.Z["theme_".concat(l)])})]})}},11742:function(e,t,n){n.d(t,{g:()=>c});var r=n(16584),i=n(30396),o=n(4038),a=n(98471),l=n(81821);function c(e){let{pub:t,post:n,style:c,source:s,size:u,hoverOverlay:d=!0}=e,{img:m,imgDownload:h,shareData:g,useNativeShare:p}=(0,o.Q)((0,a.lx)({pub:t,post:n,style:c})),v=(0,i.I4)(async()=>{await (0,a.mT)({post_id:n.id,type:"post_asset",aspect_ratio:c.aspectRatio,source:s,shareData:p?g:void 0,eventName:"WRITER_MEDIA_ASSETS_IMAGE_DOWNLOADED"})},[n.id,c.aspectRatio,s,p,g]);return(0,r.tZ)(a.kA,{onClick:v,href:p?void 0:h,children:(0,r.BX)(a.A4,{size:u,children:[!(0,l.tq)()&&m&&d&&(0,r.tZ)(a.rA,{onClick:v}),(0,r.tZ)(a.M$,{img:m})]})})}},98471:function(e,t,n){n.d(t,{A4:()=>y,M$:()=>_,kA:()=>k,lx:()=>C,mT:()=>S,rA:()=>Z});var r=n(7409),i=n(99282),o=n(16584),a=n(98661),l=n(94184),c=n.n(l),s=n(13025),u=n(95441),d=n(68833),m=n(15771),h=n(19081),g=n(98248),p=n(63474),v=n(60308),f=n(63651),w=n(18816);let _=(0,a.forwardRef)((e,t)=>{let{img:n}=e,[r,i]=(0,a.useState)(!1);return n?(0,o.BX)(o.HY,{children:[!r&&(0,o.tZ)(b,{}),(0,o.tZ)("img",{src:n,className:c()(w.Z.image,r&&w.Z.loaded),ref:t,onLoad:()=>i(!0),style:{display:r?"block":"none"}})]}):(0,o.tZ)(b,{})});function b(){return(0,o.tZ)(h.sg,{alignItems:"center",justifyContent:"center",bg:"secondary",className:c()(w.Z.image,w.Z.loading),children:(0,o.tZ)(g.$j,{})})}function k(e){let{children:t,onClick:n,href:r}=e,{iString:i}=(0,u.M1)();return(0,o.tZ)(p.A0,{onClick:n,href:r,"aria-label":i("Download image"),download:!0,className:c()(w.Z.link),target:"_blank",rel:"noreferrer",children:t})}function Z(e){let{onClick:t}=e,{iString:n}=(0,u.M1)();return(0,o.tZ)(h.sg,{className:w.Z.overlay,animate:!0,position:"absolute",inset:0,alignItems:"center",justifyContent:"end",padding:12,children:(0,o.tZ)(m.zx,{className:w.Z.downloadButton,priority:"primary-mono",size:"sm",leading:(0,o.tZ)(s.Z,{size:20}),onClick:e=>{e.stopPropagation(),t()},children:n("Download")})})}function y(e){let{children:t,size:n=300}=e;return(0,o.tZ)(h.sg,{className:w.Z.imageContainer,flex:"auto",position:"relative",cursor:"grab",style:{"--image-max-size":"".concat(n,"px")},children:t})}async function S(e){let{post_id:t,type:n,aspect_ratio:o,selection_id:a,source:l,auto_selected:c,shareData:s,eventName:u,additionalTrackingData:m={}}=e;if((0,d.j)(d.FP[u],(0,i._)((0,r._)({post_id:t,type:n},o&&{aspect_ratio:o},a&&{selection_id:a},l&&{source:l},c&&{auto_selected:c},m),{interaction:"click"})),s)try{await navigator.share(s)}catch(e){}}function C(e){let{pub:t,post:n,selectionId:r,style:i}=e;return r?{shareTitle:"Share this post",shareText:n.title,shareUrl:(0,f.uRy)(t,n),imageDownloadUrl:(0,v.BPe)(t,n,r,i),imageUrl:(0,v.BPe)(t,n,r,i),imageUrlSameOrigin:(0,v.MWO)(t,n,r,i)}:{shareTitle:"Share this post",shareText:n.title,shareUrl:(0,f.uRy)(t,n),imageDownloadUrl:(0,v.ChS)(t,n,i),imageUrl:(0,v.ChS)(t,n,i),imageUrlSameOrigin:(0,v.FEI)(t,n,i)}}},54584:function(e,t,n){n.d(t,{o:()=>i,y:()=>o});var r=n(98661);let i=(0,r.createContext)("unknown");function o(){return(0,r.useContext)(i)}},78308:function(e,t,n){n.d(t,{A:()=>r});function r(e){return"direct-message"===e?"people":"all"}},97842:function(e,t,n){n.d(t,{I0:()=>c,RN:()=>u,UX:()=>a,WG:()=>d,ge:()=>l,ky:()=>s});var r=n(6400),i=n(30396),o=n(63018);let a={user:null,inbox:{threadList:[],threads:new Map,filter:"all",resources:{all:{isLoading:!0,hasMore:!1},people:{isLoading:!0,hasMore:!1}}},users:new Map,profiles:new Map,communityPosts:new Map,communityComments:new Map,chats:new Map,comments:new Map,replies:new Map,conversations:new Map,publications:new Map,notes:new Map,editingPost:null},l=(0,r.createContext)(()=>Promise.resolve());function c(){return(0,i.qp)(l)}let s=(0,r.createContext)(a);function u(){return(0,i.qp)(s)}function d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return(0,o._I)("/api/v1/messages/unread-count",e,t)}},46603:function(e,t,n){n.d(t,{_:()=>o});var r=n(10928),i=n.n(r);function o(e,t){var n;let r;let o=e.conversations.get(t.messageThreadId),a=t.recentMessageId?e.communityComments.get(t.recentMessageId):null,l=i()(null!==(n=null==o?void 0:o.replyIds)&&void 0!==n?n:[]),c=l?e.communityComments.get(l):null;return a?c?a.comment.created_at>c.comment.created_at?a:c:a:c}},75822:function(e,t,n){n.d(t,{KS:()=>u,qS:()=>s});var r=n(16584),i=n(6400),o=n(30396),a=n(60807);let l=(0,i.createContext)({registerVideo:()=>void 0,unregisterVideo:()=>void 0,updatePaywallState:()=>void 0}),c=()=>(0,o.qp)(l),s=e=>{let{children:t}=e,[n,i]=(0,o.eJ)(0),c=(0,o.sO)([]),s=(0,o.sO)(new Map),u=(0,a.Fl)().autoPlayVideo;(0,o.d4)(()=>{let e=new IntersectionObserver(e=>{e.forEach(e=>{let t=e.target;if(!e.isIntersecting){t.pause();return}!s.current.get(t)&&u&&t.play().catch(e=>{console.log("Unable to autoplay prior to user interaction with the dom.",e),t.muted=!0,t.play().catch(e=>{console.error("Unable to autoplay prior to user interaction with the dom when muted.",e)})})})},{threshold:1});return c.current.forEach(t=>{var n;(null===(n=t.current)||void 0===n?void 0:n.player)&&e.observe(t.current.player)}),()=>{c.current.forEach(t=>{var n;(null===(n=t.current)||void 0===n?void 0:n.player)&&e.unobserve(t.current.player)})}},[n]);let d=(0,o.I4)(e=>{e&&!c.current.includes(e)&&(c.current.push(e),i(e=>e+1))},[]),m=(0,o.I4)(e=>{c.current=c.current.filter(t=>t!==e),i(e=>e+1)},[]),h=(0,o.I4)(e=>{var t;let{videoPlayerRef:n,showPaywall:r}=e;(null===(t=n.current)||void 0===t?void 0:t.player)&&s.current.set(n.current.player,r)},[]);return(0,r.tZ)(l.Provider,{value:{registerVideo:d,unregisterVideo:m,updatePaywallState:h},children:t})},u=e=>{let{disable:t,showPaywall:n,videoPlayerRef:r}=e,{registerVideo:i,unregisterVideo:a,updatePaywallState:l}=c();(0,o.d4)(()=>{if(r.current&&!t)return i(r),()=>{a(r)}},[t,i,a,r]),(0,o.d4)(()=>{l({showPaywall:n,videoPlayerRef:r})},[n,l,r])}},16889:function(e,t,n){n.d(t,{n:()=>r});function r(e){let t=0,n=()=>{let{visibilityState:n="visible"}=document,r=Date.now();"hidden"!==n&&r-t>2e3&&(e(),t=r)};return window.addEventListener("online",n),document.addEventListener("visibilitychange",n),window.addEventListener("focus",n),()=>{window.removeEventListener("online",n),document.removeEventListener("visibilitychange",n),window.removeEventListener("focus",n)}}},46464:function(e,t,n){n.d(t,{Z:()=>r});function r(e){var t;return"twitter"===e.source?"From Twitter":"facebook"===e.source?"From Facebook":"contacts_email"===e.source||"contacts_phone"===e.source?"From your contacts":e.publication?"".concat(e.publication.name):null!==(t=e.user.handle)&&void 0!==t?t:"Suggested"}}}]);