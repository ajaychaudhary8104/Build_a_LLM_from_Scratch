"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["2274"],{33803:function(e,t,n){n.d(t,{Z:()=>r});let r={elevatedTheme:"elevatedTheme-fBklGV"}},75983:function(e,t,n){n.d(t,{Z:()=>r});let r={avatarButton:"avatarButton-lZBlGB",dropdownBadge:"dropdownBadge-CARUw5"}},30351:function(e,t,n){n.d(t,{Z:()=>r});let r={signInAppUpsell:"signInAppUpsell-u9SVL0",isDesktop:"isDesktop-_mI6rc",appDownloadButton:"appDownloadButton-Lbsixg",qrContainer:"qrContainer-ApUIIX",qrCode:"qrCode-f8T8_u"}},7083:function(e,t,n){n.d(t,{Z:()=>r});let r={avatarLink:"avatarLink-M6ZJnW",inlineComposer:"inlineComposer-v8PLSi",disabled:"disabled-YAsoUi",mobileInlineComposer:"mobileInlineComposer-jKgh_1",isDragging:"isDragging-TcoucF",floatingComposer:"floatingComposer-np5rUF",inputSpacer:"inputSpacer-x19EDg",wordCountIndicator:"wordCountIndicator-KkYqEv",exceded:"exceded-x1z6ce",composerModal:"composerModal-q2ZgZt",setupProfileModalContent:"setupProfileModalContent-IhiQBI",modalColumn:"modalColumn-qiWdAx",editorContainer:"editorContainer-Lfneza",dropdownIcon:"dropdownIcon-HzL2Jt",dropdownMenu:"dropdownMenu-RAjGgB",pubRow:"pubRow-ZqkbZG",pubName:"pubName-DndaDy",linkImage:"linkImage-VNRJEM",imageContainer:"imageContainer-sSgwnk",imageActions:"imageActions-J_pVYc",removeAttachment:"removeAttachment-lybT5W",shareImageButton:"shareImageButton-O3Fvsx",notifyConformModalPubRow:"notifyConformModalPubRow-929y7D"}},14942:function(e,t,n){n.d(t,{Z:()=>r});let r={modalBody:"modalBody-yrSvJm",captcha:"captcha-awCBm5"}},15345:function(e,t,n){n.d(t,{Pp:()=>I,Gi:()=>x});var r=n(16584),i=n(6400);n(98661);var o=n(30396),a=n(19425),l=n(94184),d=n.n(l),c=n(13742),s=n(41352),u=n(28142),p=n(23254),h=n(20888),m=n(95441),g=n(68833),Z=n(45708),f=n(15771),v=n(19081),y=n(58175),w=n(75419),b=n(60308);let C={shimmer:"shimmer-DF054A",icon:"icon-kVFYHC",errorIcon:"errorIcon-yltUsD"},B=()=>(0,r.tZ)(v.gq,{radius:"full",className:C.shimmer,style:{height:"var(--size-6)",width:"100%"}}),_=(0,i.createContext)({addMediaUpload:e=>{let{}=e;throw Error("Adding a download requires a DownloadProvider.")},markAsDownloaded:()=>{throw Error("Marking as downloaded requires a DownloadProvider.")},hasBeenDownloaded:()=>{throw Error("Checking download status requires a DownloadProvider.")}}),k=e=>{var t;let{context:n,download:{mediaUpload:i,title:a,thumbnailUrl:l,source:_},pub:k,onRemoveItem:I}=e,{markAsDownloaded:S,hasBeenDownloaded:P}=x(),{iString:M}=(0,m.M1)(),{mediaUpload:D,downloadUrl:X}=(0,p.f8)(i.id),A=(0,w.i3)(),z=(null==D?void 0:D.state)==="error",L="downloads";(0,o.d4)(()=>{X&&D&&!P(i.id)&&((0,Z.I)(D,a),S(i.id),(0,g.j)(g.FP.MEDIA_CLIP_DOWNLOAD_COMPLETED,{video_upload_id:i.id,is_post_editor:!1,type:_,surface:L}))},[i.id,X,D,P,S,_,a]);let T=(0,o.I4)(e=>{e.preventDefault(),(0,g.j)(g.FP.MEDIA_CLIP_BUTTON_CLICKED,{button:"share_to_notes",source:"download_toast",surface:L});let t="publisher"===n?"".concat(M("Subscribe to get the full video when it's released."),"\n"):"";A.open({initialText:"".concat(t),videoUploadId:i.id,onCompose:e=>{(0,g.j)(g.FP.MEDIA_CLIP_SHARED,{destination:"notes",note_id:e.id,video_upload_id:i.id,is_post_editor:"publisher"===n,surface:L})}})},[A,n,M,i.id,k]);return(0,r.BX)(v.gq,{gap:16,children:[(0,r.tZ)("div",{children:(0,r.BX)(v.gq,{position:"relative",children:[(0,r.tZ)(h.e,{src:null!==(t=null!=l?l:(0,b.kOB)(i))&&void 0!==t?t:"",maxWidth:40,radius:"xs",imageProps:{height:Math.round(40),smartCrop:!0}}),X&&(0,r.tZ)(v.hs,{bg:"white",radius:"full",width:20,height:20,position:"absolute",alignItems:"center",justifyContent:"center",className:C.icon,children:(0,r.tZ)(c.Z,{stroke:"black",strokeWidth:2,size:14})}),z&&(0,r.tZ)(v.hs,{radius:"full",width:20,height:20,position:"absolute",alignItems:"center",justifyContent:"center",className:d()(C.icon,C.errorIcon),children:(0,r.tZ)(s.Z,{stroke:"white",strokeWidth:2,size:14})})]})}),(0,r.BX)(v.tu,{gap:8,children:[(0,r.BX)(v.gq,{gap:12,children:[(0,r.BX)(v.gq,{style:{width:"250px"},alignItems:"center",gap:8,children:[(0,r.BX)(v.tu,{flex:"grow",children:[(0,r.tZ)(y.xv.B4,{color:"white",weight:"semibold",style:{overflowWrap:"anywhere"},children:a}),X?(0,r.tZ)(y.xv.B4,{color:"white",children:M("Complete")}):(0,r.BX)(y.xv.B4,{color:"white",children:[M("Downloading clip"),"â€¦"]}),z&&(0,r.tZ)(y.xv.B4,{color:"error",weight:"semibold",style:{overflowWrap:"anywhere"},children:M("Download failed")})]}),X&&(0,r.tZ)(f.zx,{leading:(0,r.tZ)(u.Z,{size:16}),priority:"primary",size:"sm",onClick:T,children:M("Share")})]}),(0,r.tZ)(v.gq,{cursor:"pointer",onClick:e=>{e.stopPropagation(),I()},children:(0,r.tZ)(s.Z,{stroke:"gray"})})]}),X||z?null:(0,r.tZ)(B,{})]})]})};function I(e){let{children:t,pub:n,context:i}=e,[l,d]=(0,o.eJ)([]),[c,s]=(0,o.eJ)(new Set);return(0,r.BX)(_.Provider,{value:{addMediaUpload:e=>{d(t=>[...t,e])},markAsDownloaded:e=>{s(t=>{let n=new Set(t);return n.add(e),n})},hasBeenDownloaded:e=>c.has(e)},children:[t,!!l.length&&(0,r.tZ)("div",{style:{position:"fixed",right:"var(--size-24)",bottom:"var(--size-24)",zIndex:20},children:(0,r.tZ)(a.u,{show:!0,appear:!0,enter:"tw-transition-all tw-duration-fast transform-gpu",enterFrom:"tw-opacity-0 tw-translate-y-4",enterTo:"tw-opacity-100 tw-translate-y-0",leave:"tw-transition-all tw-duration-fast transform-gpu",leaveFrom:"tw-opacity-100 tw-translate-y-0",leaveTo:"tw-opacity-0 tw-translate-y-4",children:(0,r.tZ)(v.tu,{style:{backgroundColor:"#232525"},radius:"md",padding:16,gap:8,children:l.map((e,t)=>(0,r.tZ)(k,{context:i,download:e,pub:n,onRemoveItem:()=>d(l.filter(t=>{let{mediaUpload:n}=t;return n.id!==e.mediaUpload.id}))},"".concat(t,"_").concat(e.mediaUpload.id)))})})})]})}function x(){return(0,o.qp)(_)}},47348:function(e,t,n){n.d(t,{j:()=>a});var r=n(27412),i=n(7409),o=n(12281);class a extends o.Z{trackMedia(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={content_type:"livestream",entity_type:"livestream",primary_entity_type:"livestream",entity_key:String(this.props.liveStreamId),primary_entity_key:String(this.props.liveStreamId)};super.trackMedia(e,(0,i._)({},t,n))}constructor(...e){super(...e),(0,r._)(this,"getBaseVideoSrc",e=>{let t="/api/v1/live_stream/".concat(this.props.liveStreamId),n=new URLSearchParams;return e&&n.append("type",e),n.append("src","true"),this.props.noJoin&&n.append("noJoin","true"),this.props.portrait&&n.append("portrait","true"),"".concat(t,"?").concat(n.toString())}),(0,r._)(this,"onPreviewClick",e=>{var t;this.player&&this.player.duration&&this.player.duration>1&&!isNaN(this.player.duration)&&(null===(t=this.player)||void 0===t?void 0:t.paused)&&(this.player.currentTime=this.player.duration-1),this.player&&this.player.paused&&(this.player.playbackRate=1),super.onPreviewClick(e)}),(0,r._)(this,"refreshVideoSrc",()=>{var e;this.setState({autoPlay:!(null===(e=this.player)||void 0===e?void 0:e.paused)}),n.e("4754").then(n.t.bind(n,67631,23)).then(e=>{this._initHlsjsWrapped(e.default)})})}}o.Z},96726:function(e,t,n){n.d(t,{X:()=>d,h:()=>c});var r=n(16584),i=n(6400),o=n(98661),a=n(30396);let l=(0,i.createContext)(null);function d(e){let{root:t,children:n}=e,i=(0,a.sO)(t);return(0,r.BX)(l.Provider,{value:i,children:[n,!t&&(0,r.tZ)("div",{ref:i})]})}function c(e){let{children:t}=e,n=(0,a.qp)(l).current;return n?(0,o.createPortal)(t,n):null}},10605:function(e,t,n){n.d(t,{Z:()=>M});var r=n(16584);n(65205);var i=n(15345),o=n(96726),a=n(42347),l=n(57391),d=n(37168),c=n(98585),s=n(95441),u=n(99259),p=n(36848),h=n(93155),m=n(36518),g=n(30372),Z=n(85095),f=n(14952),v=n(39648),y=n(56629),w=n(44471),b=n(40647),C=n(45261),B=n(60807),_=n(70379),k=n(97434),I=n(75419),x=n(64172),S=n(25479),P=n(31406);function M(e){let{user:t=null,pub:n=null,children:M,siteConfigs:D={},hasThemedBackground:X=!1,language:A="en",preferredLanguage:z=null,locale:L,country:T,experimentInfo:E={variantOverrides:{},experimentFeatures:{},experimentExposures:{}},portalRoot:j,shouldLoad:q,shouldPollNotifications:N=!1,publicationSettings:U={},userSettings:F,publicationUserSettings:O={},activityToken:Y,loadPubClientSearch:R,enablePubClientSearchShortcuts:W=!0,loadGlobalSearch:H,includePodcasts:J=!1,context:V="reader",isMarketingPage:G=!1,browser:K}=e;void 0===q&&(q=!!t);let Q=(0,x.lV)({isLoggedIn:!!t,includePodcasts:J});return(0,r.tZ)(a.At,{browser:K,children:(0,r.tZ)(p.Qu,{country:T||"US",children:(0,r.tZ)(s._7,{language:A||"en",preferredLanguage:z,locale:L,children:(0,r.tZ)(C.ze,{value:{hasThemedBackground:X},children:(0,r.tZ)(b.vC,{siteConfigs:D,children:(0,r.tZ)(l.Vt,{siteConfigs:D,experimentInfo:E,children:(0,r.tZ)(d.ZN,{siteConfigs:D,experimentInfo:E,children:(0,r.tZ)(y.Iz,{settings:U,children:(0,r.tZ)(w.m$,{preloadPubUserSettings:O,children:(0,r.tZ)(m.N$,{shouldLoad:q,shouldPoll:N,activityToken:Y,children:(0,r.tZ)(o.X,{root:j,children:(0,r.tZ)(B.dr,{defaultValue:t,userSettings:F,children:(0,r.tZ)(Z.am,{children:(0,r.tZ)(u.Nj,{children:(0,r.tZ)(_.VW,{children:(0,r.tZ)(h.DY,{children:(0,r.tZ)(I.Au,{children:(0,r.tZ)(i.Pp,{context:V,pub:n,children:(0,r.tZ)(x.e.Provider,{value:Q,children:(0,r.tZ)(k.c,{children:(0,r.tZ)(f.G5.Provider,{value:n,children:(0,r.tZ)(S.yk,{user:t,children:(0,r.tZ)(c.Ml,{load:H,useLocalNavigation:!G,children:(0,r.tZ)(v.Nx,{load:R,pub:n,enableShortcuts:W,children:(0,r.tZ)(g.Pi,{children:(0,r.tZ)(P.SX,{children:M})})})})})})})})})})})})})})})})})})})})})})})})})})}},27625:function(e,t,n){n.d(t,{HU:()=>f,Sl:()=>g,cD:()=>Z});var r=n(58865),i=n(16584),o=n(30396),a=n(11607),l=n(29032),d=n(95441),c=n(7271),s=n(15771),u=n(19081),p=n(58175),h=n(60308);function m(){let e=(0,r._)(["This "," was automatically hidden by your content settings."]);return m=function(){return e},e}function g(e){let t=(0,c.M)(),[n,r]=(0,o.eJ)(e&&!t);return{isHidden:n,onShow:()=>r(!1)}}function Z(e){let{onShow:t,itemName:n,radius:r}=e,{iString:o,iTemplate:a}=(0,d.M1)(),c=a(m(),n||"item");return(0,i.tZ)(f,{onShow:t,radius:r,children:(0,i.BX)(l.C,{children:[(0,i.BX)(u.tu,{gap:4,alignItems:"center",justifyContent:"center",children:[(0,i.tZ)(p.xv.B4,{align:"center",color:"vibrance-primary",weight:"semibold",translated:!0,children:"May contain explicit content"}),(0,i.tZ)(p.xv.B4,{align:"center",color:"vibrance-secondary",children:c})]}),(0,i.BX)(u.gq,{gap:8,alignItems:"center",wrap:"wrap",justifyContent:"center",children:[(0,i.tZ)(s.zx,{priority:"primary-mono",children:o("Show anyway")}),(0,i.tZ)(s.zx,{priority:"secondary-outline",href:(0,h.v3t)({section:"privacy"}),newTab:!0,children:o("Adjust settings")})]})]})})}function f(e){let{onShow:t,children:n,radius:r}=e;return(0,i.BX)(u.tu,{justifyContent:"center",alignItems:"center",position:"absolute",inset:0,bg:"glass-inverted-thick",gap:16,padding:16,cursor:"pointer",onClick:e=>{e.preventDefault(),t()},radius:r,children:[(0,i.tZ)(a.Z,{size:24,stroke:"var(--color-utility-white)"}),n]})}},76721:function(e,t,n){n.d(t,{Z:()=>a});var r=n(30396),i=n(81821),o=n(85446);function a(e){let{truncationProfile:t="medium"}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,r.Ye)(()=>(0,o.X)(e,{truncationProfile:t,isMobile:(0,i.tq)()}),[null==e?void 0:e.body,null==e?void 0:e.body_json])}},83786:function(e,t,n){n.d(t,{M:()=>o});var r=n(98661);let i=0;function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return(0,r.useMemo)(()=>(i=++i>Number.MAX_SAFE_INTEGER?1:i,"".concat(e).concat(i)),t)}},8635:function(e,t,n){n.d(t,{Z:()=>i});var r=n(30396);let i=(e,t)=>{let n=(0,r.sO)();(0,r.d4)(()=>{n.current=e},[e]),(0,r.d4)(()=>{if(null!==t){let e=setInterval(function(){var e;null===(e=n.current)||void 0===e||e.call(n)},t);return()=>clearInterval(e)}},[t])}},52099:function(e,t,n){n.d(t,{o$:()=>f});var r=n(16584),i=n(94184),o=n.n(i);n(20042);var a=n(83034);n(28161),n(42952),n(32351),n(57391),n(40647);var l=n(68833),d=n(80878);n(59480),n(91700),n(99027);var c=n(19081),s=n(58175);n(6070);var u=n(60308),p=n(81821),h=n(47929),m=n(30351);let g=h.VX.appMarketing,Z=h.fZ.signInPage;function f(e){let{abTestingId:t}=e,n=(0,p.s)()?"ios":(0,p.Dt)()?"android":"desktop",i="desktop"===n?180:120;return(0,r.tZ)(c.hs,{padding:20,paddingTop:32,alignItems:"center",justifyContent:"center",children:(0,r.BX)(c.gq,{radius:"lg",border:"detail",className:o()(m.Z.signInAppUpsell,{[m.Z.isDesktop]:"desktop"===n}),paddingX:20,paddingTop:20,gap:20,shadow:"lg",cursor:"pointer",onClick:e=>{(0,l.j)(l.FP.SIGN_IN_APP_UPSELL_CLICKED,{position:"sign-in-page"}),(0,d.Q)(e,(0,u.D4e)({utm_campaign:g,utm_content:Z,utm_source:h.b3.upsell}),{native:!0,newTab:!0})},children:[(0,r.BX)(c.tu,{justifyContent:"space-between",flex:"grow",paddingBottom:20,gap:8,children:[(0,r.BX)(c.tu,{gap:8,children:[(0,r.tZ)(s.xv.H3,{weight:"heavy",children:"Stay signed in"}),(0,r.tZ)(s.xv.B4,{color:"secondary",children:"Download the Substack app for ".concat("ios"===n?"iOS":"android"===n?"Android":"Android or iOS")})]}),"desktop"===n?(0,r.tZ)(v,{abTestingId:t}):(0,r.tZ)(w,{type:n})]}),(0,r.tZ)(c.hs,{alignItems:"end",children:(0,r.tZ)("img",{style:{maxWidth:i},src:(0,u.zF4)("/img/app_page/highlight-6-ios-v2.png",2*i)})})]})})}function v(e){let{abTestingId:t}=e;return(0,r.BX)(c.tu,{gap:16,alignItems:"center",children:[(0,r.tZ)(y,{abTestingId:t}),(0,r.BX)(c.gq,{gap:8,children:[(0,r.tZ)(w,{type:"ios"}),(0,r.tZ)(w,{type:"android"})]})]})}function y(e){let{abTestingId:t}=e;return(0,r.tZ)(c.hs,{border:"detail",radius:"lg",className:m.Z.qrContainer,children:(0,r.tZ)(c.hs,{className:m.Z.qrCode,padding:8,children:(0,r.tZ)(a.AppStoreQrCode,{abTestingId:t,width:160,height:160,utm_campaign:g,utm_content:Z,utm_source:h.b3.qr})})})}function w(e){let{type:t}=e;return(0,r.tZ)(c.hs,{style:{minWidth:135},radius:"sm",overflowX:"hidden",overflowY:"hidden",className:m.Z.appDownloadButton,as:"a",href:(0,u.D4e)({utm_campaign:g,utm_content:Z,utm_source:h.b3.badge,force:"android"===t?"android":"ios"}),onClick:e=>e.stopPropagation(),children:(0,r.tZ)("img",{className:"app-upsell",src:(0,u.zF4)("android"===t?"/img/app_page/google-play.png":"/img/app_page/app-store.png",320),height:40})})}},52513:function(e,t,n){n.d(t,{E:()=>f,R:()=>v});var r=n(7409),i=n(16584),o=n(94184),a=n.n(o),l=n(70871),d=n(98661),c=n(95441),s=n(48980),u=n(12900),p=n(71068),h=n(19081),m=n(1844),g=n(58175),Z=n(68686);function f(e){let{email:t,redirect:n,forPub:o,onIsAttemptingLoginChange:a}=e,[c,p]=(0,d.useState)(""),[h,m]=(0,d.useState)(!1),[g,Z]=(0,d.useState)(!1),[f,v]=(0,d.useState)(!1),B=async()=>{m(!0),a&&a(!0);try{let[e]=await Promise.all([(0,s.rd)("/api/v1/email-otp-login/complete",{method:"POST",json:{code:c,email:t,redirect:n,for_pub:o}}),new Promise(e=>setTimeout(e,250))]);window.location.href=e.redirect}catch(e){e instanceof s.kp&&"login_guard_challenge"===e.body.type&&v(!0),m(!1),a&&a(!1),Z(!0),p("")}};return t?(0,i.BX)(b,{children:[(0,i.tZ)(l.uZ,{autoFocus:!0,maxLength:6,pattern:l.Ww,onChange:e=>{p(e),e.length&&Z(!1)},onComplete:B,value:c,render:e=>{let{slots:t}=e;return(0,i.tZ)(C,{children:t.map((e,t)=>(0,i.tZ)(y,(0,r._)({disabled:h},e),t))})}}),(0,i.tZ)(u.H,{expanded:!!g,children:(0,i.tZ)(w,{suspiciousLogin:f})})]}):null}function v(e){let{onComplete:t,error:n,isLoading:o}=e,[a,s]=(0,d.useState)(""),{iString:u}=(0,c.M1)();return(0,i.BX)(b,{children:[(0,i.tZ)(l.uZ,{autoFocus:!0,maxLength:6,pattern:l.Ww,onChange:e=>{s(e)},onComplete:e=>{o||t(e)},value:a,disabled:o,render:e=>{let{slots:t}=e;return(0,i.tZ)(C,{children:t.map((e,t)=>(0,i.tZ)(y,(0,r._)({disabled:o},e),t))})}}),n&&(0,i.tZ)(m.y,{style:{textAlign:"center"},children:u("You entered an incorrect code. Please try again.")})]})}function y(e){let{char:t,isActive:n,disabled:r}=e;return(0,i.tZ)(h.X2,{justifyContent:"center",alignItems:"center",width:36,height:40,className:a()(Z.Z.input,n&&Z.Z.focus,r&&Z.Z.disabled),children:(0,i.tZ)(g.xv.B2,{textAlign:"center",children:t||""})})}function w(e){let{suspiciousLogin:t}=e,{iString:n}=(0,c.M1)(),r=n(t?"Please check your email for instructions to complete signing in.":"You entered an incorrect code. Please try again.");return(0,i.tZ)(m.y,{style:{textAlign:"center"},children:r})}let b=(0,p.zo)({display:"flex",direction:"column",alignItems:"center",gap:8}),C=(0,p.zo)({display:"flex",direction:"row",justifyContent:"center",alignItems:"center",gap:8})},58505:function(e,t,n){n.d(t,{x:()=>h});var r=n(16584),i=n(45977),o=n(95441),a=n(60807),l=n(7882),d=n(15771),c=n(6490),s=n(65523),u=n(63651),p=n(47929);function h(e){let{isOpen:t,onClose:n,requirement:h,writerId:m}=e,g=(0,a.aF)(),{iString:Z}=(0,o.M1)(),{result:f}=(0,l.ib)({pathname:"/api/v1/user/".concat(m,"/primary-publication"),deps:[m],auto:!0}),v=Z("free_subscriber"===h?"Subscribers only":"Paid subscribers only"),y=Z("free_subscriber"===h?"To join the conversation, become a subscriber.":"To join the conversation, become a paying subscriber.");return(0,r.BX)(c.u_,{isOpen:t,onClose:n,children:[(0,r.tZ)(c.xB,{alignItems:"center",title:v,description:y,icon:(0,r.tZ)(s.AM,{icon:(0,r.tZ)(i.Z,{})}),showClose:!1}),(0,r.tZ)(c.ex,{}),(0,r.tZ)(c.mz,{direction:"column",primaryButton:f?(0,r.tZ)(d.zx,{priority:"primary",rounded:!0,href:(0,u.W1P)(f,{user:g,addBase:!0,params:{utm_source:p.b3.feedCommentReplyRestriction}}),children:Z("free_subscriber"===h?"Subscribe":"Upgrade")}):void 0,secondaryButton:(0,r.tZ)(d.zx,{priority:"secondary",rounded:!0,onClick:n,children:Z(f?"Cancel":"Ok")})})]})}},29263:function(e,t,n){n.d(t,{e:()=>c});var r=n(16584),i=n(56953),o=n(95441),a=n(15771),l=n(6490),d=n(65523);function c(e){let{isOpen:t,onClose:n}=e,{iString:c}=(0,o.M1)();return(0,r.BX)(l.u_,{isOpen:t,onClose:n,children:[(0,r.tZ)(l.xB,{alignItems:"center",title:c("Confirm your email address"),description:c("Please confirm your email address before posting a note."),icon:(0,r.tZ)(d.AM,{icon:(0,r.tZ)(i.Z,{})}),showClose:!1}),(0,r.tZ)(l.ex,{}),(0,r.tZ)(l.mz,{direction:"column",primaryButton:(0,r.tZ)(a.zx,{priority:"primary",rounded:!0,onClick:n,children:c("Ok")}),secondaryButton:(0,r.tZ)(a.zx,{priority:"secondary",href:"/settings",children:c("Resend confirmation email")})})]})}},4354:function(e,t,n){n.d(t,{I:()=>d,t:()=>l});var r=n(16584),i=n(6400),o=n(30396);let a=(0,i.createContext)(null);function l(e){let{children:t}=e,[n,i]=(0,o.eJ)("email"),[l,d]=(0,o.eJ)(""),[c,s]=(0,o.eJ)(!1),[u,p]=(0,o.eJ)(null);return(0,r.tZ)(a.Provider,{value:{mode:n,email:l,verificationCodeEnabled:c,onboardingRedirect:u,setMode:e=>{"magic-link"!==e&&s(!1),i(e)},setEmail:d,setVerificationCodeEnabled:s,setOnboardingRedirect:p},children:t})}function d(){let e=(0,o.qp)(a);if(!e)throw Error("useSignIn must be used within an SignInProvider");return e}},65942:function(e,t,n){n.d(t,{v:()=>Z});var r=n(58865),i=n(16584),o=n(56953),a=n(95441),l=n(8635),d=n(52513),c=n(80026),s=n(6490),u=n(65523),p=n(4354),h=n(41233);function m(){let e=(0,r._)(["We've sent an email to ",". Click the magic link or enter the code below:"]);return m=function(){return e},e}function g(){let e=(0,r._)(["We've sent an email to ",". Click the magic link inside to continue."]);return g=function(){return e},e}let Z=e=>{let{noCloseButton:t,noExit:n,onCancel:r,onSuccess:o}=e;return(0,i.BX)(i.HY,{children:[(0,i.tZ)(f,{noCloseButton:!t||n,onCancel:r}),(0,i.tZ)(v,{onSuccess:o}),(0,i.tZ)(y,{})]})},f=e=>{let{noCloseButton:t,onCancel:n}=e,{iString:r,iTemplate:l}=(0,a.M1)(),{verificationCodeEnabled:d,email:c}=(0,p.I)();return(0,i.tZ)(u.xB,{title:r("Check your email to continue"),showClose:!t,onClose:n,icon:(0,i.tZ)(u.AM,{icon:(0,i.tZ)(o.Z,{size:20})}),alignItems:"center",description:l(d?m():g(),null!=c?c:"your email address")})};function v(e){let{onSuccess:t}=e,{verificationCodeEnabled:n,email:r,onboardingRedirect:o}=(0,p.I)();return(0,l.Z)(()=>{fetch("/api/v1/am_i_logged_in").then(async e=>{(await e.json()).loggedIn&&t()})},5e3),n?(0,i.tZ)(s.fe,{children:(0,i.tZ)(d.E,{email:r,redirect:o||document.location.href})}):(0,i.tZ)(s.ex,{})}let y=()=>{let{iString:e}=(0,a.M1)(),{setMode:t}=(0,p.I)();return(0,i.tZ)(h.et,{children:(0,i.BX)(i.HY,{children:[e("Didn't get the email? "),(0,i.tZ)(c.hh,{color:"substack",decoration:"hover-underline",onClick:()=>t("email"),cursor:"pointer",children:e("Try again")})]})})}},23276:function(e,t,n){n.d(t,{j:()=>Z});var r=n(16584),i=n(95441),o=n(33668),a=n(48980),l=n(7882),d=n(98914),c=n(80026),s=n(1844),u=n(6490),p=n(51776),h=n(4354),m=n(41233),g=n(14942);let Z=e=>{let{overrideTitle:t,noCloseButton:n,onCancel:i,onSignup:o,onUserCreated:a,redirectOverride:l}=e;return(0,r.BX)(r.HY,{children:[(0,r.tZ)(m.LZ,{overrideTitle:t,noCloseButton:n,onCancel:i,onSignup:o}),(0,r.tZ)(f,{onUserCreated:a,redirectOverride:l})]})};function f(e){let{onUserCreated:t,redirectOverride:n}=e,{iString:m}=(0,i.M1)(),{setMode:Z,setEmail:f,setVerificationCodeEnabled:v,setOnboardingRedirect:y,email:w}=(0,h.I)(),b=(0,o.e)(),C=(0,l.ib)({pathname:"/api/v1/email-login",method:"POST"});return(0,r.BX)("form",{onSubmit:e=>{if(e.preventDefault(),C.isLoading)return;let r=e.currentTarget.email.value;C.refetch({json:{email:r,redirect:n||location.pathname,can_create_user:!0}}).then(e=>{if(!(e instanceof a.kp)){if(!(e instanceof Error)&&"optional"===e.verification_code){v(!0),f(r),y(e.onboarding_redirect||null),Z("magic-link");return}if(!(e instanceof Error)&&e.user){if(t){t(e.user);return}window.location.reload()}f(r),Z("magic-link")}})},children:[(0,r.tZ)(u.fe,{className:g.Z.modalBody,children:(0,r.BX)(c.sg,{gap:16,children:[(0,r.tZ)(p.oi,{type:"email",name:"email",placeholder:m("Your email"),autoComplete:"email",ref:b,autoFocus:!0,defaultValue:w}),C.error&&(0,r.tZ)(s.y,{children:(0,d.zx)(C.error)})]})}),(0,r.tZ)(u.mz,{direction:"column",primaryButton:(0,r.tZ)(c.zx,{priority:"primary",type:"submit",loading:C.isLoading,children:m("Continue")}),secondaryButton:(0,r.tZ)(c.zx,{priority:"secondary-outline",onClick:()=>{var e;f((null===(e=b.current)||void 0===e?void 0:e.value)||""),Z("password")},children:m("Sign in with password")}),buttonDivider:(0,r.tZ)(c.ZC,{})})]})}},9003:function(e,t,n){n.d(t,{n:()=>m});var r=n(16584),i=n(45977),o=n(95441),a=n(48980),l=n(7882),d=n(52513),c=n(80026),s=n(6490),u=n(65523),p=n(4354),h=n(41233);let m=e=>{let{onSuccess:t}=e;return(0,r.BX)(r.HY,{children:[(0,r.tZ)(g,{}),(0,r.tZ)(Z,{onSuccess:t}),(0,r.tZ)(f,{})]})},g=()=>{let{iString:e}=(0,o.M1)();return(0,r.tZ)(u.xB,{title:e("Enter the code from your authenticator app"),description:e("This helps us make sure it's really you."),showClose:!1,icon:(0,r.tZ)(u.AM,{icon:(0,r.tZ)(i.Z,{size:20})}),alignItems:"center"})};function Z(e){let{onSuccess:t}=e,n=(0,l.ib)({pathname:"/api/v1/mfa-login",method:"Post"});return(0,r.tZ)(s.fe,{children:(0,r.tZ)(c.sg,{gap:16,children:(0,r.tZ)(d.R,{onComplete:e=>{!n.isLoading&&n.refetch({json:{code:e}}).then(e=>{e instanceof a.kp||t()})},error:n.error,isLoading:n.isLoading})})})}let f=()=>{let{iString:e}=(0,o.M1)(),{setMode:t}=(0,p.I)();return(0,r.tZ)(h.et,{children:(0,r.BX)(r.HY,{children:[e("Made a mistake? "),(0,r.tZ)(c.hh,{color:"substack",decoration:"hover-underline",onClick:()=>t("email"),cursor:"pointer",children:e("Start over")})]})})}},24142:function(e,t,n){n.d(t,{L:()=>v});var r=n(16584),i=n(30396),o=n(29493),a=n(95441),l=n(33668),d=n(48980),c=n(7882),s=n(98914),u=n(80026),p=n(1844),h=n(6490),m=n(51776),g=n(4354),Z=n(41233),f=n(14942);let v=e=>{let{overrideTitle:t,noCloseButton:n,noExit:i,onCancel:o,onSignup:a,onSuccess:l}=e;return(0,r.BX)(r.HY,{children:[(0,r.tZ)(Z.LZ,{overrideTitle:t,noCloseButton:n||i,onCancel:o,onSignup:a}),(0,r.tZ)(y,{onSuccess:l})]})};function y(e){let{onSuccess:t}=e,{iString:n}=(0,a.M1)(),{email:Z,setEmail:v,setMode:y}=(0,g.I)(),w=(0,c.ib)({pathname:"/api/v1/login",method:"post"}),b=(0,i.sO)(),C=(0,l.e)(),B=(0,l.e)(),_=async e=>{if(e.preventDefault(),w.isLoading)return;let n=Object.fromEntries(Array.from(e.currentTarget.elements).filter(e=>e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement).map(e=>[e.name,e.value]));b.current&&(n.captcha_response=b.current.getResponse());let r=await w.refetch({json:n});r instanceof Error||(r.mfa_required?y("mfa"):t())};return(0,r.BX)(r.HY,{children:[w.error instanceof d.kp&&401===w.error.response.status&&(0,r.tZ)(o.Z,{ref:b}),(0,r.BX)("form",{onSubmit:_,children:[(0,r.tZ)(h.fe,{className:f.Z.modalBody,children:(0,r.BX)(u.sg,{gap:8,children:[(0,r.tZ)(m.oi,{type:"email",name:"email",placeholder:n("Your email"),autoComplete:"email",ref:B,defaultValue:Z,autoFocus:!0}),(0,r.tZ)(m.oi,{type:"password",name:"password",placeholder:n("Your password"),ref:C}),w.error&&(0,r.tZ)(p.y,{children:(0,s.zx)(w.error)})]})}),(0,r.tZ)(h.mz,{direction:"column",primaryButton:(0,r.tZ)(u.zx,{priority:"primary",type:"submit",loading:w.isLoading,children:n("Continue")}),secondaryButton:(0,r.tZ)(u.zx,{priority:"secondary-outline",onClick:()=>{var e;v((null===(e=B.current)||void 0===e?void 0:e.value)||""),y("email")},children:n("Sign in with email")}),buttonDivider:(0,r.tZ)(u.ZC,{})})]})]})}},40991:function(e,t,n){n.d(t,{Z:()=>function* e(t){if(yield t,t.content)for(let n of t.content)yield*e(n)}})}}]);