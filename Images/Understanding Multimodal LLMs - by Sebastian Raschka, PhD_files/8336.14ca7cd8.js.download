"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["8336"],{18787:function(t,e,l){if(l.d(e,{f1:()=>K,qV:()=>V,sF:()=>M}),l(27412),!/^(2787|5288)$/.test(l.j))var a=l(7409);if(!/^(2787|5288)$/.test(l.j))var i=l(98848);var n=l(58865),o=l(16584),r=l(30396),s=l(94184),c=l.n(s),u=l(80569),d=l.n(u),p=l(83034),h=l(12620),m=l(75021),b=l(33665),f=l(12281),_=l(95441),v=l(68833),y=l(98914),w=l(94874),g=l(15771),Z=l(19081),k=l(6490),C=l(58175),N=l(40894),S=l(24791),P=l(60308),U=l(26111),X=l(23945),B=l(81821),x=l(47929),A=l(71004);function E(){let t=(0,n._)(["Available now for iOS and Android"]);return E=function(){return t},t}function O(){let t=(0,n._)([""," gifted you this paid post. Unlock it in the free Substack app"]);return O=function(){return t},t}function T(){let t=(0,n._)(["Upgrade to ",""]);return T=function(){return t},t}function I(){let t=(0,n._)(["Upgrade to ",""]);return I=function(){return t},t}function L(){let t=(0,n._)(["Already in the "," plan?"]);return L=function(){return t},t}function F(){let t=(0,n._)(["Already in the Founding Member plan?"]);return F=function(){return t},t}let K=t=>{var e,l,a;let i,{className:n=null,title:s,subtitle:u=null,reauthenticationTitle:f,publication:g,post:k,user:N,freeSignup:S=null,freeSignupEmail:A=null,email_form:T=!1,autoFocus:I=!1,isStatic:L=!1,coupon:F=null,showPostUnlockPrompt:K=!1,magicToken:j=null,onPostUnlockError:W=null,giftingUser:$=null,treatmentVariantForGiftPostPaywall:q=null}=t,M=null==N?void 0:N.reader_installed_at,{iString:R,iTemplate:z}=(0,_.M1)(),[Y,J]=(0,r.eJ)(!1),[Q,tt]=(0,r.eJ)(!1),{modal:te,open:tl}=(0,p.useAppModal)({utm_campaign:x.VX.paywallPostUnlockPrompt,utm_source:x.b3.substack,overrideCTA:M?R("Open in app"):void 0,overrideTitle:R(M?"Unlock your free post in the Substack app":"Get the free Substack app to unlock this post"),subTitle:z(E()),openUrl:null!==(e=M&&(0,P.K8_)(g.subdomain,k.slug))&&void 0!==e?e:void 0}),ta=N&&N.email||A||null,ti=!!((null==N?void 0:N.is_subscribed)&&(null==N?void 0:N.is_magic)),tn=(null==k?void 0:k.audience)==="founding",to=!!((null==N?void 0:N.is_free_subscribed)||S),tr=(0,P.uRy)(g,k),ts=(0,B.tq)({checkFirst4:!0}),tc=(0,r.I4)(async function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(0,v.j)(v.FP.PAYWALL_UNLOCK_CTA_CLICKED,{post_id:k.id,publication_id:g.id,from_email:t});try{await d().post("/api/v1/post_unlock_token").send({post_id:k.id,token:j}),ts?window.location.href=M?(0,P.K8_)(g.subdomain,k.slug,{redirect:"app-store",params:{utm_campaign:x.VX.paywallPostUnlockPrompt,utm_source:x.b3.paywall}}):(0,P.D4e)({utm_campaign:x.VX.paywallPostUnlockPrompt,utm_source:x.b3.paywall}):tl()}catch(t){null==W||W()}},[k.id,k.slug,g.id,g.subdomain,j,M,tl,W,ts]);(0,r.d4)(()=>{K&&(0,v.j)(v.FP.PAYWALL_UNLOCK_CTA_VIEWED,{publication_id:g.id,post_id:k.id})},[k.id,g.id,K]),(0,r.d4)(()=>{(0,U.x)("launch_post_unlock_offer")&&(tc(!0),window.history.replaceState({},document.title,(0,P.rhs)({launch_post_unlock_offer:null})))},[tc]);let tu=!!F&&!!F.id&&!tn&&!K;i=tu?R((null==k?void 0:k.type)==="podcast"?"Listen to this episode with a 7-day free trial":(null==k?void 0:k.type)==="video"?"Watch with a 7-day free trial":"Keep reading with a 7-day free trial"):ti?f:s;let td=async()=>{if(!$){console.warn("tried to claim gift post, but no gifting user");return}if((0,v.j)(v.FP.GIFT_POST_CLAIM_CTA_CLICKED,{post_id:k.id,pub_id:g.id,referring_user_id:$.id,user_id:null==N?void 0:N.id,variant:q,source:"paywall"}),!N){tt(!0);return}J(!0);try{await d().post("/api/v1/post_unlock_token").send({post_id:k.id,gifting_user_id:$.id,email:ta}),(0,y.uX)((0,P.K8_)(g.subdomain,k.slug,{redirect:"app-store",source:x.b3.paywall}))}catch(t){null==W||W()}finally{J(!1)}};return $&&q&&K?(0,o.BX)("div",{role:"region","aria-label":R("Gift post paywall"),children:[Q&&(0,o.tZ)(m.f,{user:N,post:k,pub:g,referringUser:$,freeSignupEmail:null!=A?A:void 0,variant:q,startOnEmailCollection:!0}),(0,o.BX)("div",{className:c()("paywall",n),"data-testid":"paywall","data-component-name":"Paywall",children:[(0,o.tZ)(w.qE,{photoUrl:null!==(l=$.photo_url)&&void 0!==l?l:void 0,size:64,className:L?"paywall-unlock-avatar-static":"paywall-unlock-avatar"}),(0,o.tZ)(m.E,{style:{position:"absolute",left:"calc(50% + 5px)",top:"5px"},size:24}),(0,o.tZ)(C.xv,{weight:"light",className:c()("paywall-title","unlock-treatment-new"),children:z(O(),(0,X.Q1)($.name))}),(0,o.tZ)(D,{isStatic:L,onClick:()=>td(),btnClassName:c()(K&&"paywall-cta-icon"),disabled:Y,children:R("Claim my free post")}),to?(0,o.BX)(G,{isStatic:L,publication:g,post:k,postUrl:tr,coupon:F,useCoupon:tu,children:[R("Or upgrade your subscription.")," ",(0,o.tZ)("b",{children:(0,o.tZ)(b.n,{pub:g,user:N,isStatic:!0})})]}):(0,o.tZ)("div",{className:"paywall-login",children:(0,o.BX)("a",{href:(0,P.uXE)({for_pub:g.subdomain,change_user:!!ta}),native:!0,children:[V({post:k,publication:g,isPaid:!T})," ",(0,o.tZ)("b",{children:R(ta?"Switch accounts":"Sign in")})]})})]})]}):(0,o.BX)("div",{className:c()("paywall",n),"data-testid":"paywall","data-component-name":"Paywall",role:"region","aria-label":R("Paywall"),children:[K&&(0,o.tZ)(w.qE,{photoUrl:null!==(a=g.author_photo_url)&&void 0!==a?a:void 0,size:64,className:L?"paywall-unlock-avatar-static":"paywall-unlock-avatar"}),ta&&!K&&(0,o.BX)(C.xv,{translated:!0,as:"div",className:"paywall-intro",paddingBottom:8*!!K,children:["Hi ",(0,o.tZ)("b",{children:I18N.p(ta)})]}),(0,o.tZ)("h2",{className:c()("paywall-title",K&&"unlock-treatment-new"),children:i}),u&&!tu&&(0,o.tZ)("p",{className:"paywall-subtitle",children:u}),tu&&(0,o.BX)("div",{className:"paywall-free-trial-subtitle",children:[(null==k?void 0:k.type)==="podcast"&&(0,o.BX)(C.xv,{translated:!0,as:"p",className:"paywall-subtitle",children:["Subscribe to"," ",(0,o.tZ)(C.xv,{as:"span",weight:"bold",fontStyle:"italic",children:I18N.p(g.name)})," ","to listen to this post and get 7 days of free access to the full post archives."]}),(null==k?void 0:k.type)==="video"&&(0,o.BX)(C.xv,{translated:!0,as:"p",className:"paywall-subtitle",children:["Subscribe to"," ",(0,o.tZ)(C.xv,{as:"span",weight:"bold",fontStyle:"italic",children:I18N.p(g.name)})," ","to watch this video and get 7 days of free access to the full post archives."]}),(null==k?void 0:k.type)==="newsletter"&&(0,o.BX)(C.xv,{translated:!0,as:"p",className:"paywall-subtitle",children:["Subscribe to"," ",(0,o.tZ)(C.xv,{as:"span",weight:"bold",fontStyle:"italic",children:I18N.p(g.name)})," ","to keep reading this post and get 7 days of free access to the full post archives."]}),(null==k?void 0:k.type)==="adhoc_email"&&(0,o.BX)(C.xv,{translated:!0,as:"p",className:"paywall-subtitle",children:["Subscribe to"," ",(0,o.tZ)(C.xv,{weight:"bold",fontStyle:"italic",children:I18N.p(g.name)})," ","to keep reading this email and get 7 days of free access to the full post archives."]})]}),T?!to&&(0,o.tZ)(Z.gq,{paddingTop:24,justifyContent:"center",children:(0,o.tZ)(h.Z,{autoFocus:null==I||I,email:ta,freeSignup:S,freeSignupEmail:A,onAccentBackground:!0,pub:g,source:"post-unlock",submitButtonText:R((null==k?void 0:k.type)==="podcast"?"Start listening":(null==k?void 0:k.type)==="video"?"Start watching":"Start reading"),user:N,onSuccess:()=>document.location.reload()})}):K?(0,o.BX)(o.HY,{children:[te,(0,o.tZ)(D,{isStatic:L,onClick:()=>tc(!1),btnClassName:c()(K&&"paywall-cta-icon"),children:R("Claim my free post")})]}):(0,o.tZ)(H,{coupon:F,email:ta,isStatic:L,post:k,postUrl:tr,publication:g,useCoupon:tu,user:N}),K&&(0,o.BX)(G,{isStatic:L,publication:g,post:k,postUrl:tr,coupon:F,useCoupon:tu,children:[R("Or upgrade your subscription.")," ",(0,o.tZ)("b",{children:(0,o.tZ)(b.n,{pub:g,user:N,isStatic:!0})})]}),!ti&&!L&&!K&&(0,o.tZ)("div",{className:"paywall-login",children:(0,o.BX)("a",{href:(0,P.uXE)({for_pub:g.subdomain,change_user:!!ta}),native:!0,children:[V({post:k,publication:g,isPaid:!T})," ",(0,o.tZ)("b",{children:R(ta?"Switch accounts":"Sign in")})]})})]})},H=t=>{var e,l;let{coupon:a,email:i,isStatic:n,post:r,postUrl:s,publication:c,useCoupon:u,user:d}=t,p=!!(null==d?void 0:d.is_founding),h=!!(null==d?void 0:d.is_subscribed),m=!!((null==d?void 0:d.is_subscribed)&&(null==d?void 0:d.is_magic)),f=(null==r?void 0:r.audience)==="founding",{iString:v,iTemplate:y}=(0,_.M1)();if(n){if(!c.plans)return null;let t=f?N.W.FOUNDING_CHECKOUT_URL:N.W.CHECKOUT_URL,l=u?"&coupon=".concat(null==a?void 0:a.id):"",i=f?y(T(),null!==(e=(0,S.H$)(c))&&void 0!==e?e:""):u?v("Start trial"):(0,o.tZ)(b.n,{pub:c,user:d,isStatic:n});return(0,o.tZ)(j,{href:"".concat(t,"simple=true&utm_source=").concat(x.b3.paywall,"&utm_medium=").concat(x.lP.email,"&utm_content=").concat(r.id,"&next=").concat(s).concat(l),children:i})}return!p&&f?c.plans?(0,o.tZ)(W,{href:(0,P.Zs0)(c,{simple:!0,next:document.location.href,utm_source:x.b3.paywall,utm_medium:x.lP.web,utm_content:r?r.id:null,plan:"founding"}),children:y(I(),null!==(l=(0,S.H$)(c))&&void 0!==l?l:"")}):null:h?m?(0,o.tZ)(W,{href:(0,P.uXE)({for_pub:c.subdomain,email:i}),children:v("Click here to sign in")}):null:c.plans?(0,o.tZ)(W,{href:(0,P.Zs0)(c,{simple:!0,next:document.location.href,utm_source:u?x.b3.paywallFreeTrial:x.b3.paywall,utm_medium:n?x.b3.email:x.b3.web,utm_content:r?r.id:null,coupon:u?null==a?void 0:a.id:null}),children:u?v("Start trial"):(0,o.tZ)(b.n,{pub:c,user:d,isStatic:n})}):null},j=t=>{let{children:e,href:l}=t;return(0,o.tZ)("div",{className:"paywall-cta",children:(0,o.tZ)("a",{className:"button primary subscribe-btn",href:l,children:(0,o.tZ)("span",{children:e})})})},W=t=>{let{children:e,href:l}=t;return(0,o.tZ)("div",{className:"paywall-cta",children:(0,o.tZ)("a",{href:l,native:!0,children:(0,o.tZ)(g.kG,{resetCss:!0,className:c()("subscribe-btn",A.Z.subscribeButton),children:e})})})},G=t=>{let{post:e,isStatic:l,publication:a,onClick:i,children:n,postUrl:r,coupon:s,useCoupon:c}=t,u=(0,P.Zs0)(a,{simple:!0,next:document.location.href,utm_source:x.b3.paywall,utm_medium:l?x.lP.email:x.lP.web,utm_content:e?e.id:null,just_signed_up:!1});i=async()=>{window.location.href=u};let d=c?"&coupon=".concat(null==s?void 0:s.id):"",p="".concat(u,"simple=true&utm_source=").concat(x.b3.paywall,"&utm_medium=").concat(x.lP.email,"&utm_content=").concat(e.id,"&next=").concat(r).concat(d);return l?(0,o.tZ)($,{href:p,children:n}):(0,o.tZ)(q,{onClick:i,href:p,children:n})},$=t=>{let{children:e,href:l}=t;return(0,o.tZ)("div",{className:"paywall-secondary-cta",children:(0,o.tZ)("a",{href:l,children:e})})},q=t=>{let{children:e,href:l,onClick:a}=t;return(0,o.tZ)("div",{className:"paywall-secondary-cta",children:(0,o.tZ)("a",{onClick:a,href:l,native:!0,children:e})})},D=t=>{let{isStatic:e,onClick:l,children:a,btnClassName:i,disabled:n}=t;return e?(0,o.tZ)("div",{className:"paywall-cta",children:(0,o.tZ)("a",{className:c()("button","primary",i),href:"".concat(N.W.POST_URL,"&launch_post_unlock_offer=true"),children:a})}):(0,o.tZ)("div",{className:"paywall-cta",children:(0,o.tZ)("a",{onClick:l,native:!0,children:(0,o.tZ)(g.kG,{resetCss:!0,className:c()("subscribe-btn",A.Z.subscribeButton,i),disabled:n,children:a})})})};function M(t){let{isOpen:e,onClose:l}=t,n=(0,i._)(t,["isOpen","onClose"]);return(0,o.BX)(k.u_,{isOpen:e,onClose:l,children:[(0,o.tZ)(k.xB,{showClose:!0,onClose:l}),(0,o.tZ)(K,(0,a._)({className:"modal-paywall"},n))]})}function V(){let{post:t,publication:e,isPaid:l=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{iString:a,iTemplate:i}=I18N.i(e?{pub:e}:"en");if(!l)return a("Already a subscriber?");if((null==t?void 0:t.audience)==="founding"){var n;return(0,S.H$)(e)?i(L(),null!==(n=(0,S.H$)(e))&&void 0!==n?n:""):i(F())}return a("Already a paid subscriber?")}f.Z}}]);