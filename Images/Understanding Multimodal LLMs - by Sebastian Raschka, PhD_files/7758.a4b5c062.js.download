"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["7758"],{72925:function(e,t,n){n.d(t,{Z:()=>i});let i={themedSelectOption:"themedSelectOption-uLytVj",noUnderline:"noUnderline-eUUJmS",podcastPaywallMenuButton:"podcastPaywallMenuButton-pkG3vq",paywallMenuDropdown:"paywallMenuDropdown-r7kYMC",paywallMenuDropdownItem:"paywallMenuDropdownItem-DQmkqr",paywallMenuDropdownIcon:"paywallMenuDropdownIcon-hVB_f0",paywallMenuDropdownItemTop:"paywallMenuDropdownItemTop-fWca_0",paywallMenuDropdownDeleteItem:"paywallMenuDropdownDeleteItem-ChWkG9"}},21694:function(e,t,n){n.d(t,{Z:()=>i});let i={root:"root-LeqPP3",badge:"badge-WYVub3",circle:"circle-_ZTVoA"}},99987:function(e,t,n){n.d(t,{Z:()=>a});var i=n(7409),r=n(99282),o=n(16584),l=n(64515);let a=e=>(0,o.BX)(l.l,(0,r._)((0,i._)({},e),{name:"PlayIconRound",svgParams:{height:24,width:24},children:[(0,o.tZ)("path",{className:"outer-circle",d:"M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z",strokeWidth:"1.5",strokeLinecap:"round","stroke-linejoin":"round"}),(0,o.tZ)("path",{className:"inner-triangle",d:"M10 8L16 12L10 16V8Z",strokeWidth:"1.5",strokeLinecap:"round","stroke-linejoin":"round"})]}))},28161:function(e,t,n){n.d(t,{Z:()=>a});var i=n(7409),r=n(99282),o=n(16584),l=n(64515);let a=e=>(0,o.BX)(l.l,(0,r._)((0,i._)({},e),{name:"SubstackLogoIcon",svgParams:{height:18,width:16,fill:"#ff6719",stroke:"none"},children:[(0,o.tZ)("path",{d:"M16 4H0V6H16V4Z"}),(0,o.tZ)("path",{d:"M0 8V18L7.9993 13.534L16 18V8H0Z"}),(0,o.tZ)("path",{d:"M16 0H0V2H16V0Z"})]}))},43470:function(e,t,n){n.d(t,{v:()=>$});var i=n(7409),r=n(16584),o=n(30396),l=n(94184),a=n.n(l),d=n(14293),s=n.n(d),c=n(98814),u=n(28161),m=n(75716),h=n(33804),p=n(99282),v=n(8971),f=n(64998),_=n(30356),g=n(94499),b=n(98422),w=n(19081),y=n(99916);let Z={subMenuTrigger:"subMenuTrigger-SKUcXd",subMenuItem:"subMenuItem-zrY1yO",disabled:"disabled-TCpkl9",chevron:"chevron-_e2GYQ"};function k(e){let{className:t,hideBorders:n,items:i,menuItemClassName:l,selectedMenuItemClassName:d,selectedSlug:s,pub:u}=e,{isMobile:m}=(0,b.v9)(),h=(0,o.sO)(null),[p,k]=(0,o.eJ)(!1),[x,C]=(0,o.eJ)(!1);function B(e){let{scrollLeft:t,scrollWidth:n,clientWidth:i}=e;k(t>10),C(n-(i+t)>10)}let I=e=>()=>{let{current:t}=h;t&&t.scrollBy({left:250*e,behavior:"smooth"})};return(0,o.d4)(()=>{B(h.current)},[]),(0,r.tZ)("div",{className:a()("overflow-list-container",t),children:(0,r.BX)(w.gq,{borderBottom:n?void 0:"detail",borderTop:n||m?void 0:"detail",className:a()("section-bar",{scroll:!0,"overflow-left":p,"overflow-right":x}),font:"text",height:m?44:48,justifyContent:m?"start":"center",paddingX:4,position:"relative",children:[(0,r.tZ)("div",{ref:h,className:"overflow-items",onScroll:e=>B(e.target),children:i.map(e=>{let{label:t,href:n,slug:i,isNative:o,onClick:c,noFollow:m,subItems:h,newTab:p}=e;return h?(0,r.tZ)(y.v2,{placement:"bottom-start",trigger:(0,r.tZ)("div",{className:a()("menu-item",{selected:i===s},l,d&&{[d]:i===s}),children:(0,r.BX)(g.Z,{className:Z.subMenuTrigger,native:o,rel:m?"nofollow":null,onClick:c,children:[(0,r.tZ)("span",{className:"overflow-item-text",children:t}),(0,r.tZ)(v.Z,{className:Z.chevron,size:16})]})}),children:h.map(e=>{let{label:t,href:n,slug:i,isNative:o,onClick:l,noFollow:d,logoUrl:s}=e,c=!!i&&parseInt("".concat(i))===(null==u?void 0:u.id),m=s||(null==u?void 0:u.logo_url);return(0,r.tZ)(y.sN,{className:a()(Z.subMenuItem,{[Z.disabled]:c}),disabled:c,href:n,leading:m?(0,r.tZ)(_.k,{height:24,radius:"xs",src:m,width:24}):null,native:o,rel:d?"nofollow":void 0,onClick:l,children:t})})}):(0,r.tZ)("div",{className:a()("menu-item",{selected:i===s},l,d&&{[d]:i===s}),children:(0,r.tZ)(g.Z,{href:n,native:o,newTab:p,rel:m?"nofollow":null,onClick:c,children:(0,r.tZ)("span",{className:"overflow-item-text",children:t})})})})}),(0,r.tZ)("div",{className:"left-button",children:(0,r.tZ)("div",{className:"scroll-button-hitbox",role:"button",onClick:I(-1),children:(0,r.tZ)(c.Z,{strokeWidth:1.5})})}),(0,r.tZ)("div",{className:"right-button",children:(0,r.tZ)("div",{className:"scroll-button-hitbox",role:"button",onClick:I(1),children:(0,r.tZ)(f.Z,{strokeWidth:1.5})})})]})})}var x=n(95441),C=n(56629),B=n(40647),I=n(48884),M=n(76819),N=n(6070),S=n(63651),T=n(84864);let L={zeteo:{121146:"We’re Not Kidding"}},O=["/about","/chat","/archive","/newsletters","/videos","/watch"],P=e=>{let{isChatActive:t,isMeetingsActive:n,pub:i,selectedSectionId:o}=e,{language:l}=(0,x.M1)(),{getSettingFor:a}=(0,C.So)(),{getConfigFor:d}=(0,B.xR)(),s=!!d("publication_tabs_reorder"),c=!!a("notes_feed_enabled"),u=!!(a("reader_referrals_enabled")&&a("reader_referrals_leaderboard_enabled")),m=X({groupNewsletters:!!a("group_sections_and_podcasts_in_menu_enabled"),navBarItems:(0,M.Rx)(i.navigationBarItems||[],{isFeedEnabled:c,isChatActive:!!t,isChatEnabled:!!i.threads_v2_enabled,isMeetingsActive:!!n,hasMultipleNewsletters:i.sections&&i.sections.length>0,isReaderReferralsLeaderboardActive:u,language:l,useReordering:s}).filter(e=>!e.is_hidden),pub:i,language:l});return(0,r.tZ)(k,{items:m,className:"sections-overflow",selectedSlug:o,pub:i})},X=e=>{let{groupNewsletters:t,navBarItems:n,pub:i,language:r}=e,{iString:o}=I.mb.i(r),l=[];l.push({href:"/",label:o("Home"),slug:"/home"}),i.podcast_enabled&&i.show_pub_podcast_tab&&l.push({href:"/podcast",label:o("Podcast"),slug:"/podcast"});let a=[];return(0,N.Vb)({pub:i})?a=E({navBarItems:n,groups:[{label:"Shows",condition:e=>!!e.section}]}):(0,N.jC)({pub:i})?a=E({navBarItems:n,groups:[{condition:e=>{var t;return(null===(t=e.section)||void 0===t?void 0:t.id)===118995},excludeFromOthers:!0,isStandalone:!0},{condition:e=>{var t;return(null===(t=e.section)||void 0===t?void 0:t.id)===121146},excludeFromOthers:!0,isStandalone:!0},{label:"Shows",condition:e=>{var t,n;return!!(null===(t=e.section)||void 0===t?void 0:t.is_podcast)||(null===(n=e.postTag)||void 0===n?void 0:n.slug)==="townhall"}},{label:"Columns",condition:e=>{var t,n,i;return!!e.section&&!(null===(t=e.section)||void 0===t?void 0:t.is_podcast)&&![132068,243259].includes(null!==(i=null===(n=e.section)||void 0===n?void 0:n.id)&&void 0!==i?i:-1)}},{label:"Documentaries",condition:e=>{var t,n;return[132068,214805,243259].includes(null!==(n=null===(t=e.section)||void 0===t?void 0:t.id)&&void 0!==n?n:-1)}}]}):(0,N.VL)({pub:i})?(l.push({href:"/listen",label:"Shows",slug:"/listen"}),a=E({navBarItems:n.filter(e=>!e.section||!e.section.is_podcast||(0,T.sectionIsSpecificallyMarkedAsNewsletter)({section:e.section,pub:i})),groups:[{label:"Newsletters",condition:e=>!!e.section}]})):a=(0,N.p$)({pub:i})?E({navBarItems:n,groups:[{label:"Projects",condition:e=>{var t,n;return[146942,146943,150226].includes(null!==(n=null===(t=e.section)||void 0===t?void 0:t.id)&&void 0!==n?n:-1)},excludeFromOthers:!0},{label:"News / Research",condition:e=>{var t,n;return[146936,146935].includes(null!==(n=null===(t=e.section)||void 0===t?void 0:t.id)&&void 0!==n?n:-1)},excludeFromOthers:!0},{label:"Calls-to-Action",condition:e=>{var t,n;return[146939,146941,146949].includes(null!==(n=null===(t=e.section)||void 0===t?void 0:t.id)&&void 0!==n?n:-1)},excludeFromOthers:!0},{label:"Recommendations",condition:e=>{var t,n;return[146958].includes(null!==(n=null===(t=e.section)||void 0===t?void 0:t.id)&&void 0!==n?n:-1)||"https://bookshop.org/shop/globalfreedoms"===e.link_url},excludeFromOthers:!0},{label:"Podcasts",condition:e=>{var t;return!!(null===(t=e.section)||void 0===t?void 0:t.is_podcast)},excludeFromOthers:!0}]}):t?E({navBarItems:n,groups:[{label:o("Newsletters"),condition:e=>{var t;return!!e.section&&!(null===(t=e.section)||void 0===t?void 0:t.is_podcast)}},{label:o("Podcasts"),condition:e=>{var t;return!!(null===(t=e.section)||void 0===t?void 0:t.is_podcast)}}]}):n,[...l,...A({groupedNavBarItems:a,pub:i})]},E=e=>{let{navBarItems:t,groups:n}=e,i=[...t],r=[],o=[...t];for(let e of n)if(e.isStandalone){let t=i.find(e.condition);if(!t)continue;r.push(t),o=o.filter(e=>e!==t),e.excludeFromOthers&&(i=i.filter(e=>e!==t))}else{var l;let t=i.filter(e.condition);if(0===t.length)continue;r.push({label:null!==(l=e.label)&&void 0!==l?l:"Other",navBarItems:t}),o=o.filter(t=>!e.condition(t)),e.excludeFromOthers&&(i=i.filter(t=>!e.condition(t)))}return[...r,...o]},A=e=>{let{groupedNavBarItems:t,pub:n}=e;return t.map(e=>"navBarItems"in e?{label:e.label,subItems:e.navBarItems.map(e=>V({navBarItem:e,pub:n}))}:V({navBarItem:e,pub:n}))},V=e=>{var t,n,r,o,l,a;let{navBarItem:d,pub:s}=e;if(d.section){let e=d.section,a=e.is_podcast&&null!==(o=null===(n=s.sections.find(t=>t.id===e.id))||void 0===n?void 0:null===(t=n.podcastSettings)||void 0===t?void 0:t.podcast_art_url)&&void 0!==o?o:e.logo_url;return(0,p._)((0,i._)({label:null!==(l=null===(r=L[s.subdomain])||void 0===r?void 0:r[e.id])&&void 0!==l?l:(0,T.truncateText)(e.name,30),href:(0,S.Ucy)(s,{section:e})},a?{logoUrl:a}:null),{slug:e.id})}let c=(0,M.Hs)(d),u="link"===c&&!(d.standard_key||O.includes(null!==(a=d.link_url)&&void 0!==a?a:"")),m=u&&s.tier<2;return(0,p._)((0,i._)({href:(0,S.Oz)(s,d,{addBase:u}),label:(0,T.truncateText)((0,M.ye)(d),30)},m?{noFollow:m}:null,"page"===c?{isNative:!0}:null),{slug:(0,S.Oz)(s,d,{addBase:!1}),newTab:u})};var F=n(347),D=n(98914);let R=()=>Math.max(document.documentElement.scrollTop||document.body.scrollTop,0),q=e=>{let{alwaysShow:t,disable:n,menuContentRef:i,menuHeight:r}=e,l=(0,o.sO)(!1),a=(0,o.sO)(R()),d=(0,o.sO)(R()),s=(0,o.I4)((e,t)=>{a.current=t,i.current&&(i.current.style.position=e,i.current.style.top="fixed"===e&&t>=0?"":"".concat(t,"px"))},[i]),c=(0,o.I4)(()=>{s("absolute",R()-r),l.current=!1},[r,s]),u=(0,o.I4)(e=>{let t=e.target;((null==t?void 0:t.classList.contains("footnote-number"))||(null==t?void 0:t.classList.contains("footnote-anchor")))&&(l.current=!0,setTimeout(c,0))},[c]),m=(0,o.I4)(()=>{var e;if(t){s("fixed",0);return}if(l.current)return;let o=d.current;d.current=R();let c=d.current,u=(null===(e=i.current)||void 0===e?void 0:e.style.position)==="fixed",m=c<=0||0>=(0,D.bs)(),h=c>=(0,D.bs)(),p=c>o,v=c<o;if(m){s("fixed",0);return}if(n){s("absolute",0);return}if(!h){if(p){if(u&&a.current>=0){s("absolute",c);return}if(!u&&a.current<c-r){s("fixed",-r);return}}if(v){if(a.current>c){s("fixed",c);return}let e=Math.max(c-r,0);if(a.current<e){s("absolute",e);return}}}},[t,i,n,s,r]);(0,o.d4)(()=>{if("undefined"!=typeof window)return window.addEventListener("scroll",m),window.addEventListener("click",u),m(),()=>{window.removeEventListener("scroll",m),window.removeEventListener("click",u)}},[n,u,m,s])};var z=n(68833),j=n(9682),U=n(15771),W=n(10510),H=n(63474),J=n(58175),Y=n(21959),G=n(60308),Q=n(47929);let K={mainMenuContent:"mainMenuContent-DME8DR",profileContext:"profileContext-urkyyv",topBar:"topBar-pIF0J1",titleWithWordmark:"titleWithWordmark-GfqxEZ",titleContainer:"titleContainer-DJYq5v",title:"title-oOnUGd",buttonsContainer:"buttonsContainer-SJBuep",logoContainer:"logoContainer-p12gJb"},$=e=>{var t;let{className:n,freeSignup:l,freeSignupEmail:d,hasViralGiftsCount:s,hideNavBar:h,hideTitle:p,isAccountContext:v,isChatActive:f,isMeetingsActive:_,isPostView:g,pub:y,selectedSectionId:Z,showCustomerSupportModeModal:k,user:x,profile:C}=e;p="profile"===y.homepage_type||p;let{getConfigFor:I}=(0,B.xR)(),{isMobile:M}=(0,b.v9)(),[T]=(0,j.tv)(),L=(0,o.sO)(null),O=(0,o.sO)(null),X=(0,o.sO)(null),E="profile"===y.homepage_type,A=E&&T.path.match(/\/profile\/(subscribers|followers|following)/),V=!E&&!!y.logo_url&&!(0,N.kb)({pub:y}),F=!!(!p&&y.logo_url_wide),D=g?!!I("show_menu_on_posts"):!h,R=(0,N.kb)({pub:y})||!!(I("larger_wordmark_on_publication_homepage")&&F),{currentMenuHeight:Y,currentTopBarHeight:$,isMinimized:ei,maxMenuHeight:er}=ee({hasExpandableTopBar:R,forceMaximized:!g&&!v,forceMinimized:!!v,isMobile:M,showNavBar:D,showWordmark:F}),eo=!M&&R&&ei?20:0,el=M?R?32:20:R?72:36,ea=!M&&R&&ei?.5555555555555556:1;q({alwaysShow:!1,disable:!g,menuContentRef:L,menuHeight:Y});let{shouldCenterTitle:ed}=et({buttonsRef:X,titleRef:O,horizontalGap:12,horizontalPadding:R?40:20}),es=M||!ed,ec=v?(0,S.SVA)(y):"/",eu=E&&!g&&!v&&!M;return(0,r.tZ)(en,{profile:C,pub:y,useAccentTheme:!!v,children:(0,r.BX)("div",{className:a()("main-menu",n),"data-testid":"navbar",children:[(0,r.BX)("div",{ref:L,className:a()(K.mainMenuContent,eu&&K.profileContext),children:[(0,r.BX)(w.gq,{alignItems:"center",borderBottom:D?void 0:"detail",className:K.topBar,gap:12,justifyContent:"space-between",paddingBottom:M?12*!D:void 0,paddingTop:M?12:void 0,paddingX:M?12:R?40:20,style:M?void 0:{position:"relative",height:$-1},children:[(0,r.BX)("div",{className:K.logoContainer,style:(0,i._)({display:E||!V&&es?"none":null,flexBasis:0,flexGrow:+!es},R?{transform:"translateX(-".concat(eo,"px)")}:null),children:[E&&(0,r.BX)(w.gq,{alignItems:"center",gap:40,children:[(0,r.tZ)(w.hs,{alignItems:"center",as:"a",height:20,href:(0,S.n1t)((0,S.SVA)(),{utm_content:Q.fZ.islandSubstackLogo}),justifyContent:"center",tabIndex:-1,width:20,children:M?(0,r.tZ)(u.Z,{height:24}):(0,r.tZ)(u.Z,{style:{transform:"scale(1.4)"}})}),A&&(0,r.tZ)(U.hU,{className:K.backButton,href:(0,G.TJI)(y),size:M?"sm":"md",children:(0,r.tZ)(c.Z,{size:20})})]}),V&&(0,r.tZ)(W.jM,{href:ec,pub:y,size:M?32:40,onClick:()=>{(0,z.j)(z.FP.NAV_BAR_HOME_LINK_CLICKED)}})]}),!p&&(0,r.tZ)("div",{ref:O,className:K.titleContainer,style:(0,i._)({flexGrow:0},R?{transform:"translateX(".concat(es?-eo:0,"px)")}:null),children:(0,r.tZ)(J.xv,{as:"h1",className:a()(K.title,{[null!==(t=K.titleWithWordmark)&&void 0!==t?t:""]:y.logo_url_wide}),font:"pub-headings",children:(0,r.tZ)(H.A0,{href:ec,children:y.logo_url_wide?(0,r.tZ)("img",{alt:y.name,src:(0,S.zF4)(y.logo_url_wide,null,{height:2*el,crop:"limit",leadingSegments:["e_trim:10:white","e_trim:10:transparent"]}),style:(0,i._)({display:"block",height:el},R?{transform:"scale(".concat(ea,")"),transformOrigin:es?"left":"center"}:null)}):y.name})})}),(0,r.tZ)(w.gq,{alignItems:"center",justifyContent:"end",style:{flexBasis:0,flexGrow:1},children:(0,r.tZ)("div",{ref:X,className:K.buttonsContainer,style:R?{transform:"translateX(".concat(eo,"px)")}:void 0,children:(0,r.tZ)(m.Z,{freeSignup:l,freeSignupEmail:d,hasViralGiftsCount:s,isMeetingsActive:_,pub:y,showCustomerSupportModeModal:k,user:x})})})]}),D&&(0,r.tZ)(P,{isChatActive:f,isMeetingsActive:_,pub:y,selectedSectionId:Z})]}),(0,r.tZ)("div",{style:{height:er}})]})})},ee=e=>{let{forceMaximized:t,forceMinimized:n,hasExpandableTopBar:i,isMobile:r,showNavBar:l,showWordmark:a}=e,[d,c]=(0,o.eJ)(!1),u=(0,o.sO)(null),m=!!n||!t&&d,h=e=>r?l?44:56:i?e?72:120:a?88:72,p=l?r?45:50:0,v=h(n)+p,f=h(m),_=(0,o.I4)(()=>{let e=u.current,t=document.documentElement.scrollTop||document.body.scrollTop;if(u.current=t,!s()(e))t>e?t>v+5&&c(!0):t<=0&&c(!1)},[v]);return(0,o.d4)(()=>(window.addEventListener("scroll",_),()=>window.removeEventListener("scroll",_)),[_]),{currentMenuHeight:f+p,currentTopBarHeight:f,isMinimized:m,maxMenuHeight:v}},et=e=>{let{buttonsRef:t,titleRef:n,horizontalGap:i,horizontalPadding:r}=e,{isMobile:l}=(0,b.v9)(),[a,d]=(0,o.eJ)(!l),s=(0,o.I4)(()=>{if(!t.current||!n.current)return;if(l){d(!1);return}let e=t.current.getBoundingClientRect().width,o=n.current.getBoundingClientRect().width;d(.5*document.body.clientWidth-e-i-r>.5*o)},[t,i,r,l,n]);return(0,o.d4)(()=>(window.addEventListener("resize",s),s(),setTimeout(s,0),()=>{window.removeEventListener("resize",s)}),[s]),{shouldCenterTitle:a}},en=e=>{let{profile:t,pub:n,useAccentTheme:i,children:o}=e;return i?(0,r.tZ)(h.w,{children:o}):"profile"===n.homepage_type&&t?(0,r.tZ)(Y.S,{theme:t.theme,children:o}):(0,r.tZ)(F.h,{children:o})}},13561:function(e,t,n){n.d(t,{A:()=>b});var i=n(16584),r=n(6400),o=n(30396),l=n(19425),a=n(79403),d=n(94184),s=n.n(d),c=n(50308),u=n.n(c),m=n(41352),h=n(347),p=n(15771),v=n(19081),f=n(63124),_=n(88e3);let g={modal:"modal-Suw4en",modalBody:"modalBody-s4SL_V",modalBodyStretched:"modalBodyStretched-aq1p4E"},b=e=>{let{children:t,disableCloseOnBackdropClick:n=!1,fullscreenMobile:d,hideCloseButton:c,initialFocus:b,isOpen:w,maxFullscreenMobile:y,overflow:Z,testId:k="modal",width:x=660,stretchModal:C=!1,onClose:B=()=>void 0,onEscape:I}=e,M=(0,o.sO)(null);return(0,i.tZ)(h.h,{children:(0,i.tZ)(l.u,{as:r.Fragment,show:w,children:(0,i.BX)(a.V,{as:"div",className:g.modal,"data-testid":k,initialFocus:void 0===b?M:b,onClick:e=>e.stopPropagation(),onClose:n?u():B,onKeyDown:I?e=>{let{code:t}=e;I&&"Escape"===t&&I(e)}:void 0,onMouseDown:e=>e.stopPropagation(),onMouseUp:e=>e.stopPropagation(),children:[(0,i.tZ)("div",{ref:M,"aria-hidden":"true",style:{position:"absolute",left:"-9999px"},tabIndex:-1}),(0,i.BX)(f.Uv,{children:[(0,i.tZ)(f.sc,{children:(0,i.tZ)(f._n,{})}),(0,i.tZ)(_.Q,{children:(0,i.tZ)(_.l,{className:C?s()(g.modalBodyStretched,"the-free-press-theme"):s()(g.modalBody,"the-free-press-theme"),fullscreenMobile:d,maxFullscreenMobile:y,overflow:Z,width:x,children:(0,i.tZ)(h.h,{children:(0,i.BX)(v.tu,{paddingTop:c?24:8,children:[!c&&(0,i.tZ)(v.gq,{justifyContent:"end",children:(0,i.tZ)(p.hU,{priority:"quaternary",onClick:B,children:(0,i.tZ)(m.Z,{})})}),t]})})})})]})]})})})}},35543:function(e,t,n){n.d(t,{Sv:()=>S,Xe:()=>I,oJ:()=>M,oh:()=>N,yr:()=>T});var i=n(7409),r=n(99282),o=n(58865),l=n(16584),a=n(30396),d=n(82569),s=n.n(d),c=n(21442),u=n(24028),m=n(69241),h=n(19548),p=n(95441),v=n(60807),f=n(54371),_=n(6910),g=n(48980),b=n(63018),w=n(98914),y=n(99916),Z=n(70379),k=n(81043),x=n(23945);function C(){let e=(0,o._)(["Followed ",""]);return C=function(){return e},e}function B(){let e=(0,o._)(["Unfollowed ",""]);return B=function(){return e},e}function I(e){let t=(0,v.aF)();return(0,b._I)("/api/v1/feed/following",(0,i._)({auto:!!t},e))}function M(){let{mutate:e}=(0,m.kY)();return function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];return e("/api/v1/feed/following",...n)}}function N(e,t,n){let{isFollowing:i,toggle:r}=S(e,t,n),o=(0,v.aF)(),a=(0,h.gc)(null==e?void 0:e.id),d=!!(o&&e&&o.id!==e.id)&&!a,s=[];return d&&s.push((0,l.tZ)(y.sN,{leading:i?(0,l.tZ)(_.m,{stroke:"var(--color-fg-primary)"}):(0,l.tZ)(f.w,{stroke:"var(--color-fg-primary)"}),onClick:r,children:i?"Unfollow":"Follow"})),s}function S(e,t,n,o){let a=(0,v.aF)(),{onboardingModalRef:d,requireLogin:m}=(0,k.SJ)(),h=function(e,t){let{data:n}=I(t);return(null!=n?n:[]).includes(null!=e?e:0)}(null==e?void 0:e.id,o),{mutate:f,data:_}=I(o),b=(0,Z.pm)(),y=(0,x.Q1)((null==e?void 0:e.name)||""),{iString:M,iTemplate:N}=(0,p.M1)(),S=async o=>{if(e){if(!a&&d.current){m?m():d.current.open();return}f(function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return o?[...t,e.id]:s()(t,e.id)},{revalidate:!1});try{await (0,g.rd)("/api/v1/feed/".concat(e.id,"/follow"),{method:o?"POST":"DELETE",json:{surface:t,noteId:n}}),b.popToast(e=>(0,l.tZ)(Z.FN,(0,r._)((0,i._)({},e),{Icon:o?c.Z:u.Z,text:o?N(C(),y):N(B(),y),cta:M("Undo"),onAccept:()=>S(!o)})))}catch(e){b.popToast(t=>(0,l.tZ)(Z.FN,(0,r._)((0,i._)({},t),{text:(0,w.zx)(e)})));return}}};return{isFollowing:h,toggle:()=>S(!h),isLoaded:!!_}}function T(e,t,n){let{isFollowing:i,toggle:r}=S(e,t,n),[o,l]=(0,a.eJ)(!1);return{isFollowing:i,buttonProps:{onClick:()=>{r(),i||l(!0)},onMouseLeave:()=>l(!1)}}}},99259:function(e,t,n){n.d(t,{M$:()=>s,Nj:()=>d});var i=n(16584),r=n(6400),o=n(30396),l=n(14773);let a=(0,r.createContext)({isOnDestination:(0,l.MM)()});function d(e){let{children:t}=e,n=(0,o.Ye)(()=>({isOnDestination:(0,l.MM)()}),[]);return(0,i.tZ)(a.Provider,{value:n,children:t})}function s(){return(0,o.qp)(a)}a.displayName="IsDestinationContext"},93155:function(e,t,n){n.d(t,{DY:()=>d,dd:()=>s});var i=n(16584),r=n(6400),o=n(30396),l=n(10704);let a=(0,r.createContext)({openModal:()=>{},closeModal:()=>{}});function d(e){let{children:t}=e,[n,r]=(0,o.eJ)(!1),[d,s]=(0,o.eJ)({width:540,children:null}),c=()=>{r(!1)};return(0,i.BX)(a.Provider,{value:{openModal:e=>{s(e),r(!0)},closeModal:c},children:[(0,i.tZ)(l.u_,{isOpen:n,onClose:c,width:d.width,overflow:"hidden",children:d?d.children:null}),t]})}function s(){return(0,o.qp)(a)}a.displayName="ModalContext"},36518:function(e,t,n){n.d(t,{N$:()=>p,lR:()=>f});var i=n(16584),r=n(6400),o=n(30396),l=n(32351),a=n(14952),d=n(48980),s=n(8635),c=n(7882),u=n(98750),m=n(98914),h=n(6070);function p(e){let{defaultState:t,shouldLoad:n=!0,shouldPoll:r=!1,activityToken:o,children:l}=e;return(0,i.tZ)(_,{defaultState:null==t?void 0:t.activity,shouldLoad:n,shouldPoll:r,activityToken:o,children:l})}let v=(0,r.createContext)({lastViewedAt:null,activityUnreadCount:0,activityUnreadAtMax:!1,refetch:async()=>!0,markAllAsRead:async()=>{},hasLoadedOnce:!1});function f(){return(0,o.qp)(v)}function _(e){let{defaultState:t,shouldLoad:n=!0,shouldPoll:r=!1,activityToken:p,children:f}=e,_=(0,c.ib)({pathname:"/api/v1/activity/unread",deps:[],auto:n,initialResult:t,query:{token:p}}),g=(0,a.Ij)(),b=!!g&&(0,h.HD)({pub:g}),w=!(0,u.th)()&&!b,y=async()=>{let e=await (0,d.rd)("/api/v1/activity/unread",{method:"post",json:{after:new Date().toISOString(),token:p}});_.setResult(e)};(0,s.Z)(async()=>{if(r&&n&&(0,m.dr)()){var e;let t=(null===(e=_.result)||void 0===e?void 0:e.count)||0,n=await _.refetch();if(t!==(!(n instanceof Error)&&n.count||0))return!0}},6e4);let Z=null!=_.result?_.result.count:0;return(0,o.d4)(()=>{try{var e,t;null===(e=(t=navigator).setAppBadge)||void 0===e||e.call(t,Z)}catch(e){console.warn(e)}},[Z]),(0,i.BX)(v.Provider,{value:{lastViewedAt:null!=_.result?_.result.lastViewedAt:null,activityUnreadCount:Z,activityUnreadAtMax:null!=_.result&&_.result.max,refetch:_.refetch,markAllAsRead:y,hasLoadedOnce:_.hasLoadedOnce},children:[(0,i.tZ)(l.Metadata,{badge:w?Z:void 0}),f]})}v.displayName="NotificationsContext"},5952:function(e,t,n){n.d(t,{Bk:()=>q,WS:()=>E,bN:()=>A});var i=n(7409),r=n(99282),o=n(16584),l=n(30396),a=n(87764),d=n(64998),s=n(85685),c=n(57391),u=n(95441),m=n(92291),h=n(77338),p=n(42375),v=n(93963),f=n(62903),_=n(25991),g=n(19619),b=n(85527),w=n(53678),y=n(16451),Z=n(76721),k=n(68833),x=n(80878),C=n(7882),B=n(98914),I=n(19081),M=n(58175),N=n(15503),S=n(27744),T=n(2009),L=n(50312);n(33017);var O=n(31377),P=n(63651),X=n(5749);function E(e){var t,n,l,a,d;let{comment:s,item:c,isParent:u,showReplyingTo:h,showContext:w,utm_content:Z,parentCommentUserId:M,hideable:L=!1}=e,X=(0,p.rI)(),E=(0,b.F)(),V=(0,S.de)(c),F=()=>(0,N.rw)(c,X,"profile",{tabId:E}),q=!s.ancestor_path,z=c.publication&&c.post&&(0,O.getPostAuthor)(c.publication,c.post),j=(0,C.ib)({pathname:"/api/v1/trending-topics/toggle",method:"POST"}),U=null;if(!q){let e=null===(t=s.ancestor_path)||void 0===t?void 0:t.split(".").pop(),i=e&&Number(e);U=null!==(l=null===(n=c.parentComments)||void 0===n?void 0:n.find(e=>(null==e?void 0:e.id)===i))&&void 0!==l?l:null}let W=h&&(q&&z||!q&&U),H=(0,N.Gv)(c,{isModuleItem:!0}),J=async()=>{var e,t,n,i,r;(0,N.rw)(c,X,"context",{tabId:E}),(0,k.j)(k.FP.SEE_MORE_NOTES_IN_CATEGORY_CLICKED,{tagId:null===(e=c.context.tag)||void 0===e?void 0:e.id,noteId:null===(t=c.comment)||void 0===t?void 0:t.id}),await j.refetch({method:"POST",json:{enable:!0,categoryID:null===(i=c.context)||void 0===i?void 0:null===(n=i.tag)||void 0===n?void 0:n.id}}),(0,B.uX)("/home/category/".concat(null===(r=c.context.tag)||void 0===r?void 0:r.id),{local_navigation:!1})},Y=(0,O.getCommentAuthor)(s),G=!u&&["comment_like","comment_restack","note_like"].includes(c.context.type);return(0,o.tZ)(y.oM,{showGutter:u,hasContext:w,onClick:e=>{if(!e.defaultPrevented&&!V){(0,N.rw)(c,X,"item",{tabId:E});let t="search"===X&&"undefined"!=typeof location?location.pathname:null,n=(0,P.Sgq)(s,{noBase:!s.hidden&&T.L,urlParams:{utmSource:t}});(0,x.Q)(e,s.hidden&&c.publication?(0,P.W1P)(c.publication,{addBase:!0,params:{next:n}}):n,{newTab:!!s.hidden,native:s.hidden,state:{showBack:!0}})}},entityKey:c.entity_key,children:(0,o.BX)(g.n,{user:Y,item:c,comment:s,children:[w||G?(0,o.tZ)(f.L,{context:c.context,onClick:()=>(0,N.rw)(c,X,"context",{tabId:E}),utm_content:Z}):null,c.context.tag?(0,o.tZ)(f.L,{context:(0,r._)((0,i._)({},c.context),{type:"topic"}),onClick:J,utm_content:Z}):null,(0,o.BX)(I.gq,{gap:12,alignItems:"start",children:[(0,o.tZ)(y.Fb,{user:Y,onClick:F,utm_content:Z}),(0,o.BX)(I.tu,{gap:8,flex:"grow",minWidth:0,children:[(0,o.BX)(I.tu,{gap:12,children:[(0,o.BX)(I.tu,{gap:4,children:[(0,o.tZ)(_.Ev,{author:Y,post:null!==(a=c.post)&&void 0!==a?a:void 0,comment:s,onClick:F,utm_content:Z,publication:null!==(d=c.publication)&&void 0!==d?d:void 0,item:c,allowHide:L,parentCommentUserId:M}),W&&(0,o.tZ)(R,{isTopLevel:q,postAuthor:z,parentComment:U,item:c}),s.body&&(0,o.tZ)(A,{comment:s,item:c})]}),s.attachments&&(0,o.tZ)(m.yd,{parent:s,attachments:s.attachments,onAttachmentClick:function(){let{commentId:e,attachmentType:t,attachmentId:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,N.rw)(c,X,"attachment",{tabId:E,extraEventProps:{commentId:e,clicked_attachment_type:t,clicked_attachment_id:n}})},onSavePostClick:H,utm_content:Z,item:c}),(0,o.tZ)(D,{item:c,surface:X})]}),!s.hidden&&(0,o.tZ)(v.$w,{item:c,comment:s})]})]})]})})}function A(e){let{comment:t,item:n,large:i,paddingRight:r}=e,a=(0,p.rI)(),d=(0,b.F)(),{bodyJson:s,truncatedBodyJson:c,isTruncated:u,shouldExpandInline:m}=(0,Z.Z)(t),[v,f]=(0,l.eJ)(!1),_=i||!u||v,g=_?s:c;return(0,o.BX)(I.tu,{className:X.Z.feedCommentBody,paddingRight:r,children:[(0,o.tZ)(y.sP,{children:t.hidden&&n?(0,o.tZ)(V,{pub:null==n?void 0:n.publication}):g&&(0,o.tZ)(h.x,{content:g,onLinkClicked:()=>{n&&(0,N.rw)(n,a,"link",{tabId:d,extraEventProps:{commentId:t.id}})},attachedLinks:q(t)},_)}),!_&&(0,o.tZ)(F,{onClick:e=>{n&&(0,N.rw)(n,a,"see_more",{tabId:d,extraEventProps:{commentId:t.id}}),m?(e.preventDefault(),f(!0)):(0,B.uX)((0,P.Sgq)(t,{noBase:T.L,urlParams:{utmSource:"search"===a&&"undefined"!=typeof location?location.pathname:null}}),{event:e,state:{showBack:!0}})}})]})}function V(e){let{pub:t}=e;return(0,o.BX)(o.HY,{children:[(0,o.BX)("i",{children:["This comment is only visible to paid subscribers of ",null==t?void 0:t.name]}),(0,o.tZ)("br",{}),(0,o.tZ)("b",{children:"Subscribe to view →"})]})}function F(e){let{iString:t}=(0,u.M1)();return(0,o.BX)(I.hs,{className:X.Z.seeMore,children:[(0,o.tZ)(I.hs,{className:X.Z.seeMoreFade}),(0,o.tZ)(M.xv.B3,{color:"secondary",weight:"medium",className:X.Z.seeMoreText,children:(0,o.tZ)(w.hh,(0,r._)((0,i._)({},e),{children:t("See more")}))})]})}let D=e=>{let{item:t,surface:n}=e,{getExperimentVariant:i,exposeExperiment:r}=(0,c.jc)(),[s,u]=(0,l.eJ)(!1),{trendingTopic:m}=t;if((0,l.d4)(()=>{m&&(r("web_notes_trending_topics_enabled"),"treatment"===i("web_notes_trending_topics_enabled")&&u(!0))},[m,r,i]),!m||!s)return null;let h=(0,P.BxF)(m.query,"feed-comment"),p=m.readableName||m.query.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ");return(0,o.tZ)(L.r,{href:h,target:"_blank",onClick:()=>{(0,N.rw)(t,n,"topic")},children:(0,o.BX)(I.gq,{display:"inline-flex",radius:"sm",bg:"secondary",alignItems:"center",padding:4,children:[(0,o.tZ)(a.Z,{height:14}),(0,o.tZ)(M.xv,{fontSize:11,color:"primary",fontWeight:"bold",children:p}),(0,o.tZ)(d.Z,{height:14})]})})};function R(e){var t;let{isTopLevel:n,postAuthor:i,parentComment:r,item:l}=e,a=n?i:r?{id:r.user_id,user_id:r.user_id,name:r.name,photo_url:r.photo_url}:i,d=n?(0,P.mx9)(l.publication,l.post,{noBase:T.L}):(0,P.Sgq)(r,{noBase:T.L}),c=(null===(t=n?i:r)||void 0===t?void 0:t.name)||"";return a?(0,o.BX)(M.xv.B5,{color:"secondary",translated:!0,children:["Replying to"," ",(0,o.tZ)(s.ProfileHoverCard,{subject:a,dontStopPropagation:!0,utmSource:"feed",children:(0,o.tZ)(w.hh,{href:d,children:I18N.p(c)})})]}):null}function q(e){return e.attachments?e.attachments.map(e=>"link"===e.type?e.linkMetadata.url:"post"===e.type?(0,P.uRy)(e.publication,e.post):"publication"===e.type?(0,P.SVA)(e.publication):"comment"===e.type?(0,P.Sgq)(e.comment):"").filter(Boolean):[]}},69181:function(e,t,n){n.d(t,{C:()=>b,Qn:()=>_,j0:()=>g,u0:()=>w});var i=n(16584),r=n(30396),o=n(64998),l=n(60129),a=n(64729),d=n(95441),s=n(42375),c=n(98170),u=n(6246),m=n(85527),h=n(63474),p=n(43570),v=n(15503),f=n(20063);let _=()=>{let{iString:e}=(0,d.M1)();return(0,i.tZ)(p.Vp,{theme:"error",priority:"primary",className:f.Z.livePill,children:e("LIVE")})},g=()=>{let{iString:e}=(0,d.M1)();return(0,i.tZ)(a.i,{children:(0,i.tZ)(p.D7,{priority:"primary",children:e("WAS LIVE")})})},b=e=>{let{viewerCount:t}=e;return(0,i.tZ)(p.D7,{priority:"primary",leading:(0,i.tZ)(l.Z,{size:18}),children:(0,u.T)(t)})},w=e=>{let{item:t,pub:n,post:l,onViewEpisodeClick:a}=e,{iString:u}=(0,d.M1)(),h=(0,c.vE)({post:l,publication:n}),f=(0,s.rI)(),_=(0,r.qp)(m.q);return(0,i.tZ)(p.D7,{priority:"primary",onClick:e=>{t&&(0,v.rw)(t,f,"watch_full_episode",{tabId:_}),null==a||a(),h(e)},trailing:(0,i.tZ)(o.Z,{size:16}),children:u("View full episode")})};(0,h.zo)({display:"flex",direction:"row",gap:8,alignItems:"center",className:f.Z.viewerCountContainer})},42375:function(e,t,n){n.d(t,{$U:()=>m,rI:()=>p});var i=n(16584),r=n(98661),o=n(30396),l=n(25642),a=n(27744),d=n(75822),s=n(81043),c=n(75419),u=n(41233);function m(e){let{state:t,dispatch:n,surface:r,children:m}=e,{onboardingModalRef:p}=(0,s.SJ)(),v=(0,o.Ye)(()=>({dispatch:n}),[]);return(0,i.tZ)(h.Provider,{value:r,children:(0,i.tZ)(a.RR.Provider,{value:v,children:(0,i.tZ)(a.ev.Provider,{value:t,children:(0,i.tZ)(l.ju,{children:(0,i.tZ)(c.Au,{children:(0,i.BX)(d.qS,{children:[m,(0,i.tZ)(u.fA,{isOpen:!!t.isSigningIn,onCancel:()=>n({type:"sign_in",payload:{isSigningIn:!1}}),onSuccess:()=>{n({type:"sign_in",payload:{isSigningIn:!1}}),document.location.reload()},onSignup:()=>{var e;n({type:"sign_in",payload:{isSigningIn:!1}}),null===(e=p.current)||void 0===e||e.open()},noExit:t.signInNoExit})]})})})})})})}let h=(0,r.createContext)("feed");function p(){return(0,o.qp)(h)}},43251:function(e,t,n){n.d(t,{Lw:()=>r});var i=n(60308);function r(e,t){return(null==e?void 0:e.profile_set_up_at)?(0,i.NNq)(e,t):(0,i.Nhr)((null==t?void 0:t.utm_source)?{utm_source:t.utm_source}:void 0)}},98750:function(e,t,n){n.d(t,{MW:()=>d,UM:()=>a,th:()=>s});var i=n(30396),r=n(46914),o=n(98914);function l(e,t){let{root:n,threshold:o=0,rootMargin:l,disabled:a=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},d=(0,r.z)(e=>{t(e.some(e=>e.isIntersecting),e)});(0,i.d4)(()=>{if("undefined"==typeof IntersectionObserver||!e.current||a)return;let t=new IntersectionObserver(d,{root:n,threshold:o,rootMargin:l});return t.observe(e.current),function(){t.disconnect()}},[n,o,l,a])}function a(e,t){let{root:n,threshold:r=0,rootMargin:o,disabled:a=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},d=(0,i.sO)(!1);l(e,e=>{e&&!d.current&&(d.current=!0,t())},{root:n,threshold:r,rootMargin:o,disabled:a||d.current})}function d(e,t,n){let{root:o,rootMargin:a,disabled:d=!1}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=(0,i.sO)({firstVisibleTime:null,lastVisibleTime:null}),c=()=>{let{current:e}=s;if(null!==e.firstVisibleTime){let t=e.lastVisibleTime?Date.now()-e.lastVisibleTime:0;null!=e.lastVisibleTime&&(n(t),e.lastVisibleTime=null)}},u=(0,r.z)(()=>{let{current:e}=s;null==e.firstVisibleTime&&(e.firstVisibleTime=Date.now(),t()),e.lastVisibleTime=Date.now()});return l(e,(0,r.z)((e,t)=>{var n;let i=null===(n=window)||void 0===n?void 0:n.innerHeight,r=t.some(e=>{let t=e.intersectionRatio>=.9&&e.isIntersecting,n=i&&e.boundingClientRect.height*e.intersectionRatio>=.5*i;return t||n}),o=t.some(e=>e.intersectionRatio<.3&&!e.isIntersecting);r?u():o&&c()}),{root:o,threshold:[.3,.5,.7,.9],rootMargin:a,disabled:d}),(0,i.d4)(()=>{let{current:e}=s;return"undefined"==typeof IntersectionObserver&&u(),()=>{null!==e.lastVisibleTime&&c()}},[]),u}function s(e){let[t,n]=(0,i.eJ)(!1);return(0,i.d4)(()=>{let t=()=>{let t=(0,o.dr)();n(t),null==e||e(t)};return(0,o.ut)(t),()=>{(0,o.kE)(t)}},[e]),t}},46234:function(e,t,n){n.d(t,{B:()=>s});var i=n(7409),r=n(16584),o=n(19081),l=n(58175),a=n(14773),d=n(63651);let s=e=>{let{firehoseFeedUrl:t,pub:n,section:s,trackingSource:c,variant:u="default"}=e,m=(0,a.n1)("/p/how-do-i-add-a-bulwark-member-only",(0,i._)({utm_source:c},s?{utm_content:s.id}:null)),h=(0,a.n1)("/account/add-all-podcasts",(0,i._)({utm_source:c},s?{utm_content:s.id}:null)),p=t?(0,r.BX)(l.xv.B3,{as:"li",font:"text",children:["Click here to set up your podcast app for"," ",(0,r.tZ)("a",{href:t,rel:"noopener noreferrer",target:"_blank",children:"everything in one feed"})]}):null,v=(0,d.W1P)(n,{params:{utm_source:c}});return(0,r.tZ)("div",{className:"container-o06YlK",children:"member-only"===u?(0,r.BX)(o.tu,{as:"ul",gap:4,children:[(0,r.BX)(l.xv.B3,{as:"li",font:"text",children:["Want to listen without ads? Join Bulwark+ for exclusive ad-free versions of all Bulwark shows."," ",(0,r.tZ)("a",{href:v,rel:"noopener noreferrer",target:"_blank",children:"Upgrade now"})]}),(0,r.BX)(l.xv.B3,{as:"li",font:"text",children:["Already a Bulwark+ member? Login to access premium shows. ",(0,r.tZ)("a",{href:m,children:"Learn more here"})]})]}):(0,r.BX)(o.tu,{as:"ul",gap:4,children:[(0,r.BX)(l.xv.B3,{as:"li",font:"text",children:["Learn about"," ",(0,r.tZ)("a",{href:m,rel:"noopener noreferrer",target:"_blank",children:"setting up your Bulwark+ private podcast feeds"})]}),p||(0,r.BX)(l.xv.B3,{as:"li",font:"text",children:["Add the Bulwark Premium Show"," ",(0,r.tZ)("a",{href:h,rel:"noopener noreferrer",target:"_blank",children:"super feed"})]})]})})}},30733:function(e,t,n){n.d(t,{N:()=>a});var i=n(16584),r=n(94184),o=n.n(r),l=n(71068);let a=e=>{let{children:t,columns:n=2,paddingTop:r=24}=e,a=(0,l.oB)({paddingTop:r,paddingX:16,paddingBottom:32});return(0,i.tZ)("div",{className:o()("container-kIrj2N",a,{"containerThreeColumn-Rot594":3===n,"containerFourColumn-vOHVwe":4===n}),children:t})}},84370:function(e,t,n){n.d(t,{T:()=>a});var i=n(16584),r=n(43570),o=n(58175),l=n(52503);function a(e){let{modifier:t,children:n,className:a}=e,d=function(e){let t=navigator.platform.toLowerCase().includes("mac");switch(null==e?void 0:e.toLowerCase()){case"cmd":return t?"⌘":"Ctrl + ";case"shift":return t?"⇧":"Shift + ";case"alt":case"opt":return t?"⌥":"Alt + ";case"ctrl":return t?"⌃":"Ctrl + ";case"esc":return"Esc";case"left":return"←";case"right":return"→";case"up":return"↑";case"down":return"↓";default:return""}}(t);return(0,i.tZ)(r.Vp,{priority:"secondary-outline",theme:"default",className:a,children:(0,i.BX)(o.xv,{as:"kbd",font:"text",weight:"regular",color:"secondary",className:l.Z.kbd,children:[d,n]})})}},78096:function(e,t,n){n.d(t,{dm:()=>f,gd:()=>_,yo:()=>g});var i=n(7409),r=n(99282),o=n(98848),l=n(16584),a=n(94184),d=n.n(a),s=n(98661),c=n(86374),u=n(95441),m=n(15771),h=n(19081),p=n(99916),v=n(87815);let f=e=>{var{priority:t="secondary-outline",size:n="md"}=e,r=(0,o._)(e,["priority","size"]);"secondary-outline"===t&&(t="tertiary");let a="tertiary"===t;return(0,l.tZ)(w.Provider,{value:{priority:t,size:n},children:(0,l.tZ)(h.X2,(0,i._)({radius:"sm"===n?"xs":"sm",className:d()(v.Z.group,a&&v.Z.outlined)},r))})},_=e=>{var{children:t,priority:n="primary",size:a="md",menuItems:d,additionalMenuProps:s={}}=e,m=(0,o._)(e,["children","priority","size","menuItems","additionalMenuProps"]);let{iString:h}=(0,u.M1)();return(0,l.BX)(f,{priority:n,size:a,children:[(0,l.tZ)(g,(0,r._)((0,i._)({},m),{children:t})),(0,l.tZ)(p.v2,(0,r._)((0,i._)({},s),{placement:"bottom-end",trigger:(0,l.tZ)(b,(0,r._)((0,i._)({},m),{"aria-label":h("Dropdown menu"),children:(0,l.tZ)(c.Z,{size:"sm"===a?16:"md"===a?20:24})})),children:d}))]})},g=(0,s.forwardRef)((e,t)=>{var{className:n}=e,a=(0,o._)(e,["className"]);let{priority:c,size:u}=(0,s.useContext)(w);return(0,l.tZ)(m.zx,(0,r._)((0,i._)({priority:c,size:u,className:d()(v.Z.segment,n)},a),{ref:t}))}),b=(0,s.forwardRef)((e,t)=>{var{className:n}=e,a=(0,o._)(e,["className"]);let{priority:c,size:u}=(0,s.useContext)(w);return(0,l.tZ)(m.hU,(0,r._)((0,i._)({priority:c,size:u,className:d()(v.Z.segment,n)},a),{ref:t}))}),w=(0,s.createContext)({priority:"primary",size:"md"})},57693:function(e,t,n){n.d(t,{l:()=>_});var i=n(16584),r=n(30396),o=n(19425),l=n(20160),a=n(57391),d=n(36518),s=n(60807),c=n(68833),u=n(7882),m=n(19081),h=n(74312),p=n(98012);let v={alert:"alert-pEnrFa",transition:"transition-FsyEAS",enterFrom:"enterFrom-dljIVN",enterTo:"enterTo-HLLVxF",leaveFrom:"leaveFrom-aHkaAL",leaveTo:"leaveTo-k1oI5e"},f=e=>{(0,c.j)(c.FP.NOTIFICATIONS_ALERT_SHOWN,["comment_audience","comment_id","community_comment_id","created_at","id","mention_id","publication_id","sender_count","target_comment_id","target_community_comment_id","target_community_post_id","target_post_id","target_user_id","type"].reduce((t,n)=>(t[n]=null==e?void 0:e[n],t),{}))};function _(){var e;let{activityUnreadCount:t}=(0,d.lR)(),{exposeExperiment:c,getExperimentVariant:_}=(0,a.jc)(),{isLoading:g,result:b,refetch:w}=(0,u.ib)({pathname:"/api/v1/activity-feed-web",query:{limit:1},auto:!1});(0,r.d4)(()=>{t>0&&w()},[t]);let[y,Z]=(0,r.eJ)(!1),[k,x]=(0,r.eJ)(!1),{isLoading:C,fetch:B,result:I}=(0,h.Oe)({module:"./MiniNotificationsViewer",onRequest:()=>Promise.all([n.e("9669"),n.e("4466"),n.e("7833"),n.e("8875")]).then(n.bind(n,79075)),fetchImmediately:!1}),M=(0,p.Z)(),{userSettings:N,changeSetting:S}=(0,s.SE)(),T=null==b?void 0:null===(e=b.activityItems)||void 0===e?void 0:e[0],L=(null==T?void 0:T.created_at)?(0,p.Z)(null==T?void 0:T.created_at):M.subtract(100,"year"),O=(null==N?void 0:N.last_notification_alert_shown_at)?(0,p.Z)(N.last_notification_alert_shown_at):M.subtract(100,"year"),P=7>M.diff(L,"day")&&L.diff(O,"hour")>2,X=(0,r.sO)(null),E=()=>{X.current&&window.clearTimeout(X.current)},A=()=>{E(),X.current=window.setTimeout(()=>{Z(!1)},6e3)};return(0,r.d4)(()=>{P&&t>0&&(c("notification_alert_improved"),"treatment"!==_("notification_alert_improved")||(I&&!y?window.setTimeout(()=>{Z(!0),S("last_notification_alert_shown_at",(0,p.Z)().toISOString()),f(T),A()},2e3):I||C||B()))},[g,b,t,C,P,y,Z]),(0,i.tZ)(i.HY,{children:(y||k)&&b&&(0,i.tZ)(o.u,{style:{position:"fixed",left:"auto",right:20,top:92,zIndex:100},appear:!0,show:y,beforeEnter:()=>x(!0),afterLeave:()=>x(!1),enter:v.transition,enterFrom:v.enterFrom,enterTo:v.enterTo,leave:v.transition,leaveFrom:v.leaveFrom,leaveTo:v.leaveTo,children:(0,i.tZ)(l.W,{children:(0,i.tZ)(m.hs,{radius:"md",border:"detail",className:v.alert,onMouseEnter:E,onMouseLeave:A,shadow:"lg",bg:"primary",children:(0,i.tZ)(h.cr,{module:"@/frontend/reader2/activity/MiniNotificationsViewer",resolve:e=>e.MiniNotificationsStack,onRequest:()=>Promise.all([n.e("9669"),n.e("4466"),n.e("7833"),n.e("8875")]).then(n.bind(n,79075)),result:b,isReadOnly:!0})})})})})}},83010:function(e,t,n){n.d(t,{H:()=>c,n:()=>u});var i=n(7409),r=n(99282),o=n(16584),l=n(6400),a=n(30396),d=n(68833);let s=(0,l.createContext)({surface:null,platform:"web"});function c(e){let{children:t,trackingProps:n}=e,r=(0,a.qp)(s),l=(0,a.Ye)(()=>(0,i._)({},r,n),Object.values(n));return(0,o.tZ)(s.Provider,{value:l,children:t})}function u(){let e=(0,a.qp)(s);return(t,n)=>(0,d.j)(t,(0,i._)((0,r._)((0,i._)({},e),{ui:"page"===e.surface?"activity-page":e.surface}),n))}},8828:function(e,t,n){n.d(t,{dd:()=>o,oH:()=>r});var i=n(48980);let r=function(){let{before:e,tab:t="all"}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return async n=>{try{var r,o;let l=await (0,i.rd)("/api/v1/messages/inbox",{query:{paginate:"true",tab:t,before:e}});n({type:"inbox-new_items",payload:{threads:null==l?void 0:l.threads,hasMore:null==l?void 0:l.more,directMessagesUnreadCount:null==l?void 0:l.directMessagesUnreadCount,pendingInviteCount:null==l?void 0:l.pendingInviteCount,pendingInviteUnreadCount:null!==(r=null==l?void 0:l.pendingInviteUnreadCount)&&void 0!==r?r:null==l?void 0:l.pendingInviteCount,pubChatUnreadCount:null!==(o=null==l?void 0:l.pubChatUnreadCount)&&void 0!==o?o:0,mostRecentChatTimestamp:l.mostRecentChatTimestamp}})}catch(e){if(console.warn("error",e),e instanceof i.kp)n({type:"inbox-new_error",payload:{error:e}});else throw e}}},o=e=>async t=>{"direct-message"===e&&t(r({tab:"people"})),t({type:"inbox-set_filter",payload:e})}},76819:function(e,t,n){n.d(t,{Hs:()=>l,Rx:()=>a,ye:()=>o});var i=n(7409),r=n(75561);function o(e){var t,n,i;return e.link_title||(null===(t=e.postTag)||void 0===t?void 0:t.name)||(null===(n=e.section)||void 0===n?void 0:n.name)||(null===(i=e.post)||void 0===i?void 0:i.title)||""}function l(e){var t;return e.postTag?"tag":e.section?"section":(null===(t=e.post)||void 0===t?void 0:t.type)==="page"?"page":e.post?"post":"link"}function a(e,t){let{isChatActive:n,isMeetingsActive:o,hasMultipleNewsletters:l,isChatEnabled:a,isFeedEnabled:d,isReaderReferralsLeaderboardActive:s,language:c="en",useReordering:u=!1}=t,m=e.filter(e=>!e.standard_key),h=new Map(e.filter(e=>e.standard_key).map(e=>[e.standard_key,e])),{iString:p}=I18N.i(c);for(let e of m){var v;(null===(v=e.section)||void 0===v?void 0:v.hide_from_navbar)&&(e.is_hidden=!0)}let f=[d&&{standard_key:"notes",link_title:"Notes",link_url:"/notes"},a&&{standard_key:"chat",link_title:"Chat",link_url:"/chat",is_hidden:!n},o&&{standard_key:"meetings",link_title:"Meetings",link_url:"/meetings"},...m,{standard_key:"archive",link_title:p("Archive"),link_url:"/archive"},l&&{standard_key:"newsletters",link_title:p("Newsletters"),link_url:"/newsletters",is_hidden:!0},s&&{standard_key:"leaderboard",link_title:p("Leaderboard"),link_url:"/leaderboard"},{standard_key:"about",link_title:p("About"),link_url:"/about"}].filter(e=>!!e).map(e=>{if(e.standard_key){let t=h.get(e.standard_key);if(t)return(0,r.CD)((0,i._)({},e),t)}return e});if(u){let e=["about","notes","chat","archive"];return[...f.filter(t=>!e.includes(t.standard_key||"")),...e.map(e=>f.find(t=>t.standard_key===e)).filter(e=>!!e)].filter(e=>!!e)}return f}},62515:function(e,t,n){n.d(t,{Ds:()=>d,Rm:()=>o,aD:()=>l,gp:()=>a});var i=n(14773),r=n(63651);function o(e,t){return(0,i.Q2)("/chat/".concat(e),t)}function l(e,t){return(0,i.Q2)("/chat/".concat(e),t)}function a(e){return(0,i.Q2)("/chat/new",e)}function d(e){let{userId:t,userName:n}=e,o=(0,r.JlE)({userId:t,userName:n});return"".concat((0,i.ZX)(),"/chat/dm/user/").concat(o)}}}]);