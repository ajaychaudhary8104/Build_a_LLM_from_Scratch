"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["4937"],{66149:function(e,t,i){i.d(t,{EB:()=>D,_0:()=>U});var n=i(27412);if(5288!=i.j)var a=i(7409);if(5288!=i.j)var o=i(99282);if(5288!=i.j)var l=i(98848);var r=i(58865),s=i(16584),c=i(6400),u=i(30396),d=i(94184),h=i.n(d),p=i(14293),m=i.n(p),v=i(41705),b=i(20253),f=i(57391),g=i(95441),Z=i(68833),y=i(48980),_=i(71068),w=i(15771),B=i(17352),S=i(82402),k=i(19081),x=i(1844),C=i(68709),X=i(6490),N=i(10510),E=i(17688),I=i(58175),T=i(64300),P=i(51776),F=i(57641),L=i(48884),A=i(60308),j=i(70408),z=i(59613);function O(){let e=(0,r._)([""," on Substack"]);return O=function(){return e},e}class R extends c.Component{componentDidMount(){if(this.props.autoSubmit){var e,t,i;this.isComplete()?null===(e=this.formRef.current)||void 0===e||e.handleSubmit():null===(t=(i=this.props).onAutoSubmitFailed)||void 0===t||t.call(i)}}isComplete(){let{user:e,needsPhoto:t}=this.props;return e&&!e.is_magic&&e.name&&(!t||e.photo_url)}onError(e){var t,i,n;this.props.autoSubmit&&!this.state.autoSubmitFailed&&(this.setState({autoSubmitFailed:!0}),null===(i=(n=this.props).onAutoSubmitFailed)||void 0===i||i.call(n)),this.setState({sentLoginEmail:!1}),(null===(t=e.response)||void 0===t?void 0:t.status)===401&&this.sendLoginEmail()}async createDefaultPublication(e,t){let{iTemplate:i}=this.props;try{let n=await (0,y.rd)("/api/v1/publication/suggestion"),a=t||i(O(),e);await (0,y.rd)("/api/v1/publication",{method:"post",json:{name:e,subdomain:n.subdomain,hero_text:a,tos:!0}})}catch(e){(0,Z.j)(Z.FP.DEFAULT_PUBLICATION_CREATION_FAILED),console.warn("couldn't set up a default publication",e)}}async sendLoginEmail(){let e=this.state.newEmail||this.props.freeSignupEmail;if(!this.state.loading&&e){this.setState({loading:!0});try{await (0,y.rd)("/api/v1/email-login",{method:"post",json:{email:e,redirect:document.location.href}}),this.setState({sentLoginEmail:!0})}catch(e){console.error("Failed send login email:",e)}this.setState({loading:!1})}}render(e,t){let{className:i,user:n,numVisibleSubscriptions:a,numSubscriptions:o,freeSignup:l,freeSignupEmail:r,needsPhoto:c,optionalPhoto:u,showHandle:d=!0,token:p,text:f,onSuccess:g,prepareData:Z,pageTitle:y,primaryEligiblePublications:X,isPostInvite:A,complete:O,profileExists:R,onSkip:U,onEditReadVisibility:D,barebones:H,onEditRecommendations:q,numRecommendationsToMake:W,noSubscribeCta:Y,style:J,iString:M,iPlural:V,showSocialHandle:G,pub:K}=e,{newPhotoUrl:Q,newName:$,newHandle:ee,newEmail:et,loading:ei,sentLoginEmail:en,sentAccountConfirmationEmail:ea,newBio:eo,createPublication:el,selectedSocial:er,selectedSocialHandle:es,tosAccepted:ec,subscribeToNewsletter:eu}=t,ed=Q||(0,j.ln)(n,{}),eh="string"==typeof y||null===y?y:M(this.isComplete()?"Update your profile":"Create your profile"),ep=$||n&&n.name||"",em=ee||(null==n?void 0:n.handle)||"",ev="string"==typeof eo?eo:n&&n.bio||"",eb=(!n||n.is_magic)&&!r&&!A,ef=!R&&!!q&&!m()(W)&&W>0,eg=A&&X&&(null==n?void 0:n.has_publication)&&X.length>1,eZ="number"==typeof a&&!m()(o)&&o>0&&D,ey=!Y&&!(n&&(n.is_subscribed||n.is_free_subscribed)||l),e_=A&&!(null==n?void 0:n.has_publication),ew=async(e,t)=>{if(e.body.emailConfirmationRequired){this.setState({sentAccountConfirmationEmail:!0});return}el&&await this.createDefaultPublication(ep,ev),g(e,t)};return(0,s.BX)("div",{className:h()("profile-updater",i),style:J,children:[eh&&(0,s.tZ)(I.xv.H4,{align:"left",paddingBottom:20,children:eh}),(ed||c||u)&&(0,s.tZ)(k.X2,{flex:"grow",justifyContent:"center",alignItems:"center",children:(0,s.tZ)(v.U,{user:{photo_url:Q||(null==n?void 0:n.photo_url)||null},onChangePhoto:e=>{let{photo_url:t}=e;return this.setState({newPhotoUrl:t})}})}),(0,s.BX)(b.ZP,{ref:this.formRef,method:"put",action:"/api/v1/user/profile",prepareData:Z,onSuccess:ew,onError:e=>this.onError(e),noInlineErrors:!0,loading:ei,autoLock:!0,children:[(0,s.BX)(k.sg,{gap:20,children:[(0,s.BX)(P.fv,{children:[(0,s.tZ)(C.Y5,{htmlFor:"name",children:M("Name")}),K?(0,s.tZ)("input",{type:"hidden",name:"pub_id",value:K.id}):null,(0,s.tZ)(P.oi,{autoFocus:!0,type:"text",className:"profile-name",placeholder:M("Type your name..."),name:"name",id:"name",value:ep,onInput:e=>{this.setState({newName:e.currentTarget.value})}})]}),eb&&(0,s.BX)(P.fv,{children:[(0,s.tZ)(C.Y5,{htmlFor:"email",children:M("Email")}),(0,s.tZ)(P.oi,{type:"email",placeholder:M("Enter your email address..."),name:"email",value:null!=et?et:void 0,onInput:e=>{this.setState({newEmail:e.currentTarget.value})}})]}),d&&(0,s.BX)(P.fv,{children:[(0,s.tZ)(C.__,{htmlFor:"handle",children:M("Handle")}),(0,s.tZ)(P.oi,{type:"text",className:"profile-name",placeholder:M("Type your handle..."),name:"handle",id:"handle",value:em,onInput:e=>{this.setState({newHandle:e.currentTarget.value})}})]}),!H&&(0,s.BX)(P.fv,{children:[(0,s.tZ)(C.__,{htmlFor:"bio",children:M("Bio")}),(0,s.tZ)(T.g,{placeholder:M("Say something about yourself..."),name:"bio",id:"bio",value:ev,onInput:e=>{this.setState({newBio:e.currentTarget.value})}}),A&&(0,s.tZ)(x.p6,{align:"left",children:M("Tip: this will be shown at the bottom of your guest post")})]}),A&&(0,s.tZ)("input",{type:"hidden",name:"needs_bio",value:"true"}),G&&(0,s.BX)(P.fv,{children:[(0,s.tZ)(C.OV,{htmlFor:"social",hint:M("Optional"),children:M("Where else can you be found?")}),(0,s.BX)(k.X2,{gap:8,wrap:"wrap",children:[(0,s.tZ)(k.X2,{flex:"grow",minWidth:200,children:(0,s.BX)(E.i,{flex:"grow",name:"social",value:er,onChange:e=>{this.setState({selectedSocial:e.currentTarget.value})},children:[(0,s.tZ)(E.d,{children:M("Select a social network")}),(0,s.tZ)("option",{value:"twitter",children:M("Twitter")}),(0,s.tZ)("option",{value:"instagram",children:M("Instagram")}),(0,s.tZ)("option",{value:"tiktok",children:M("Tiktok")}),(0,s.tZ)("option",{value:"linkedin",children:M("LinkedIn")}),(0,s.tZ)("option",{value:"youtube",children:M("Youtube")})]})}),(0,s.tZ)(k.X2,{flex:"grow",minWidth:200,children:(0,s.tZ)(P.oi,{flex:"grow",type:"text",placeholder:M("@yourhandle"),name:"socialHandle",value:es,onInput:e=>{this.setState({selectedSocialHandle:e.currentTarget.value})}})})]})]}),eg&&(0,s.BX)(P.fv,{children:[(0,s.tZ)(C.__,{children:M("Publication to display")}),(0,s.tZ)(B.Z,{padding:12,gap:12,children:X.map((e,t)=>{var i,n;return(0,s.tZ)(C.__,{for:"primary-radio-".concat(e.id),children:(0,s.BX)(k.X2,{gap:12,alignItems:"center",children:[(0,s.tZ)("input",{id:"primary-radio-".concat(e.id),type:"radio",name:"primary_publication_user_id",value:e.id,checked:0===t}),(0,s.tZ)(N.wk,{pub:e.publication,size:24}),(0,s.tZ)(I.xv.B3,{as:"span",children:null!==(n=null===(i=e.publication)||void 0===i?void 0:i.name)&&void 0!==n?n:""})]})})})})]}),ey&&(0,s.BX)(k.gq,{as:"label",className:z.Z.checkbox,gap:8,children:[(0,s.tZ)(S.X,{size:"sm",name:"free_signup",defaultChecked:!0,checked:eu,onChange:e=>this.setState({subscribeToNewsletter:e})}),(0,s.tZ)(I.xv.B3,{as:"span",children:M("Subscribe to the newsletter")})]}),e_&&(0,s.BX)(k.gq,{as:"label",className:z.Z.checkbox,gap:8,children:[(0,s.tZ)(S.X,{type:"checkbox",name:"create_publication",id:"create-publication-checkbox",checked:el,onChange:e=>{this.setState({createPublication:e})}}),(0,s.tZ)(I.xv.B3,{as:"span",children:M("Create a Substack publication for me")})]}),(0,s.tZ)("input",{type:"hidden",name:"confirmation_redirect_pathname",value:document.location.pathname}),(0,s.tZ)("input",{type:"hidden",name:"photo_url",value:null!=ed?ed:void 0}),(0,s.tZ)("input",{type:"hidden",name:"user_id",value:(null==n?void 0:n.id)||""}),(0,s.tZ)("input",{type:"hidden",name:"needs_photo",value:!!c}),(0,s.tZ)("input",{type:"hidden",name:"token",value:p}),O&&(0,s.tZ)("input",{type:"hidden",name:"complete",value:!0}),(0,s.BX)("div",{id:"error-container",children:[en&&(0,s.BX)(I.xv,{as:"div",translated:!0,className:"error other-error",children:["If you have an account with us, we've sent an email to ",(0,s.tZ)("b",{children:L.mb.p(null!=et?et:"")})," with a link that you can use to sign in."]}),ea&&(0,s.tZ)("div",{className:"error other-error",children:M("We have sent you a confirmation email. Please check your inbox before continuing.")})]}),eZ&&(0,s.BX)(I.xv.B3,{as:"span",children:[(0,s.tZ)(I.hh,{cursor:"pointer",decoration:"underline",onClick:D,children:V("1 subscription","%1 subscriptions",a)})," ",M("will be displayed on your profile.")]}),ef&&(0,s.BX)(I.xv.B3,{as:"span",children:[(0,s.tZ)(I.hh,{cursor:"pointer",decoration:"underline",onClick:q,children:V("1 recommendation","%1 recommendations",W)})," ",M("will be made on your publication.")]})]}),(0,s.BX)(k.sg,{gap:8,children:[!n&&(0,s.tZ)(_.xu,{className:z.Z.tosCheckboxContainer,paddingTop:20,paddingBottom:12,children:(0,s.tZ)(F.O,{checked:ec,onCheckboxChange:e=>this.setState({tosAccepted:e}),style:{display:"flex"}})}),(0,s.tZ)(w.zx,{priority:"primary",disabled:!n&&!ec,type:"submit",size:"lg",children:f||M("Save")}),U&&(0,s.tZ)(w.zx,{priority:"secondary",onClick:U||(()=>{}),children:M("Skip")})]})]})]})}constructor(e,t){var i;super(e,t),(0,n._)(this,"formRef",void 0),this.formRef=(0,c.createRef)();let a=!!e.isPostInvite||!!e.profileExists;this.state={newName:null,newHandle:null,newBio:null,newEmail:e.user&&e.user.is_magic?e.user.email:null,selectedSocial:"instagram",createPublication:!!e.isPostInvite&&!(null===(i=e.user)||void 0===i?void 0:i.has_publication),tosAccepted:a,subscribeToNewsletter:!0}}}let U=(0,f.f9)((0,g.fz)(R));function D(e){var{isOpen:t,onClose:i,contributor:n}=e,r=(0,l._)(e,["isOpen","onClose","contributor"]);return(0,s.BX)(X.u_,{isOpen:t,onClose:()=>i(),width:490,children:[(0,s.tZ)(X.xB,{showClose:!0,onClose:()=>i()}),(0,s.tZ)(X.fe,{children:n?(0,s.tZ)(H,(0,o._)((0,a._)({},r),{user:r.user,pub:r.pub,profile:r.profile,onSuccess:()=>i()})):(0,s.tZ)(U,(0,o._)((0,a._)({},r),{onSuccess:()=>i()}))})]})}let H=e=>{let{profile:t,user:i,pub:n,onSuccess:a,isOwnProfile:o}=e,{iString:l}=(0,g.M1)(),[r,c]=(0,u.eJ)(null),d=r||t&&t.photo_url,[h,p]=(0,u.eJ)(t.name),[m,f]=(0,u.eJ)(t.bio);return(0,s.BX)("div",{className:"profile-updater",children:[(0,s.tZ)("h2",{className:"page-title profile-updater-title",children:"Edit contributor profile"}),(0,s.tZ)("div",{className:"profile-photo-wrap",children:(0,s.tZ)(v.U,{user:{photo_url:r||(null==t?void 0:t.photo_url)||null},onChangePhoto:e=>{let{photo_url:t}=e;return c(t)}})}),(0,s.BX)(b.ZP,{method:"patch",action:"/api/v1/publication/users/".concat(t.id),onSuccess:a,autoLock:!0,children:[(0,s.tZ)("input",{type:"text",className:"profile-name",placeholder:"Contributor's name…",name:"name",value:h,onInput:e=>{p(e.target.value)}}),(0,s.tZ)("textarea",{className:"profile-bio",placeholder:"Contributor's bio…",name:"bio",value:m,onInput:e=>{f(e.target.value)}}),(0,s.tZ)("input",{type:"hidden",name:"photo_url",value:d}),(0,s.BX)("span",{className:"notice",children:[(0,s.BX)(I.xv,{translated:!0,as:"p",children:[(0,s.tZ)("b",{children:"Note:"})," This is a contributor profile, viewable by ",L.mb.p(n.name),"'s readers."]}),o&&(0,s.BX)(I.xv,{translated:!0,as:"p",children:["You may also edit your"," ",(0,s.tZ)("a",{native:!0,href:"".concat((0,A.NNq)(i)),children:"personal profile"}),"."]})]}),(0,s.tZ)(w.zx,{priority:"primary",type:"submit",children:l("Update profile")})]})]})}}}]);