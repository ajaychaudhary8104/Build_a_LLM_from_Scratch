"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["8041"],{31704:function(e,t,i){i.d(t,{FQ:()=>O,EB:()=>q,_0:()=>Y});var n=i(27412),a=i(7409),l=i(99282);if(/^(1612|2787|3154|4153|6909)$/.test(i.j))var o=i(98848);var r=i(58865),s=i(16584),c=i(6400),u=i(30396),d=i(94184),p=i.n(d),h=i(14293),m=i.n(h),b=i(13361),v=i(65530),f=i(20253),y=i(93666),g=i(57391),Z=i(95441),_=i(68833),k=i(48980),w=i(71068),B=i(15771),S=i(17352),C=i(82402),x=i(19081),N=i(1844),X=i(68709),E=i(10510),I=i(17688),T=i(58175),F=i(64300),P=i(51776),L=i(57641),D=i(48884),j=i(60308),R=i(70408);let z={checkbox:"checkbox-jbvy_H",tosCheckboxContainer:"tosCheckboxContainer-vfMi_Y"};function A(){let e=(0,r._)([""," on Substack"]);return A=function(){return e},e}let H=e=>{let{sub:t,onSetVisibility:i}=e,n=t.publication;return(0,s.BX)("div",{className:"edit-sub-visibility-row",children:[(0,s.BX)("div",{className:"left",children:[(0,s.tZ)(E.wk,{pub:n}),(0,s.tZ)("span",{children:n.name})]}),(0,s.tZ)("div",{className:"right",children:(0,s.tZ)(b.p,{checked:"public"===t.visibility,onChange:()=>i("public"===t.visibility?"private":"public")})})]})},O=e=>{let{profile:t,onFinalizeVisibility:i,onSetVisibility:n,source:o}=e,{iString:r}=(0,Z.M1)();if(!t)return null;let c=t.subscriptions.every(e=>{let{visibility:t}=e;return"public"===t}),u=e=>i=>{n(t.subscriptions.reduce((t,n)=>{let{visibility:o,publication:r}=n;return(0,l._)((0,a._)({},t),{[r.id]:r.id===e.id?i:o})},{})),(0,_.j)(_.FP.PROFILE_EDITED,{type:"read_visibility_toggled",visibility:i})},d=(0,s.tZ)("button",{className:"small",onClick:()=>{n(t.subscriptions.reduce((e,t)=>{let{publication:i}=t;return(0,l._)((0,a._)({},e),{[i.id]:c?"private":"public"})},{})),(0,_.j)(_.FP.PROFILE_EDITED,{type:"visibility_toggled_all",for:"reads",count:t.subscriptions.length})},children:r(c?"Hide all":"Show all")});return(0,s.BX)("div",{className:"edit-sub-visibility-form",children:[(0,s.tZ)("div",{className:"bulk-action-row",children:d}),(0,s.tZ)("div",{className:"edit-sub-visibility-frame",children:t.subscriptions.map(e=>(0,s.tZ)(H,{sub:e,onSetVisibility:u(e.publication),source:o}))}),(0,s.tZ)("div",{className:"modal-ctas",children:(0,s.tZ)(B.zx,{priority:"primary",onClick:i,children:r("Done")})})]})};class U extends c.Component{componentDidMount(){if(this.props.autoSubmit){var e,t,i;this.isComplete()?null===(e=this.formRef.current)||void 0===e||e.handleSubmit():null===(t=(i=this.props).onAutoSubmitFailed)||void 0===t||t.call(i)}}isComplete(){let{user:e,needsPhoto:t}=this.props;return e&&!e.is_magic&&e.name&&(!t||e.photo_url)}onError(e){var t,i,n;this.props.autoSubmit&&!this.state.autoSubmitFailed&&(this.setState({autoSubmitFailed:!0}),null===(i=(n=this.props).onAutoSubmitFailed)||void 0===i||i.call(n)),this.setState({sentLoginEmail:!1}),(null===(t=e.response)||void 0===t?void 0:t.status)===401&&this.sendLoginEmail()}async createDefaultPublication(e,t){let{iTemplate:i}=this.props;try{let n=await (0,k.rd)("/api/v1/publication/suggestion"),a=t||i(A(),e);await (0,k.rd)("/api/v1/publication",{method:"post",json:{name:e,subdomain:n.subdomain,hero_text:a,tos:!0}})}catch(e){(0,_.j)(_.FP.DEFAULT_PUBLICATION_CREATION_FAILED),console.warn("couldn't set up a default publication",e)}}async sendLoginEmail(){let e=this.state.newEmail||this.props.freeSignupEmail;if(!this.state.loading&&e){this.setState({loading:!0});try{await (0,k.rd)("/api/v1/email-login",{method:"post",json:{email:e,redirect:document.location.href}}),this.setState({sentLoginEmail:!0})}catch(e){console.error("Failed send login email:",e)}this.setState({loading:!1})}}render(e,t){let{className:i,user:n,numVisibleSubscriptions:a,numSubscriptions:l,freeSignup:o,freeSignupEmail:r,needsPhoto:c,optionalPhoto:u,showHandle:d=!0,token:h,text:b,onSuccess:y,prepareData:g,pageTitle:Z,primaryEligiblePublications:_,isPostInvite:k,complete:j,profileExists:A,onSkip:H,onEditReadVisibility:O,barebones:U,onEditRecommendations:Y,numRecommendationsToMake:q,noSubscribeCta:M,style:J,iString:V,iPlural:W,showSocialHandle:$,pub:Q}=e,{newPhotoUrl:G,newName:K,newHandle:ee,newEmail:et,loading:ei,sentLoginEmail:en,sentAccountConfirmationEmail:ea,newBio:el,createPublication:eo,selectedSocial:er,selectedSocialHandle:es,tosAccepted:ec,subscribeToNewsletter:eu}=t,ed=G||(0,R.ln)(n,{}),ep="string"==typeof Z?Z:V(this.isComplete()?"Update your profile":"Create your profile"),eh=K||n&&n.name||"",em=ee||(null==n?void 0:n.handle)||"",eb="string"==typeof el?el:n&&n.bio||"",ev=(!n||n.is_magic)&&!r&&!k,ef=!A&&!!Y&&!m()(q)&&q>0,ey=k&&_&&(null==n?void 0:n.has_publication)&&_.length>1,eg="number"==typeof a&&!m()(l)&&l>0&&O,eZ=!M&&!(n&&(n.is_subscribed||n.is_free_subscribed)||o),e_=k&&!(null==n?void 0:n.has_publication),ek=async(e,t)=>{if(e.body.emailConfirmationRequired){this.setState({sentAccountConfirmationEmail:!0});return}eo&&await this.createDefaultPublication(eh,eb),y(e,t)};return(0,s.BX)("div",{className:p()("profile-updater",i),style:J,children:[(0,s.tZ)(T.xv.H4,{align:"left",paddingBottom:20,children:ep}),(ed||c||u)&&(0,s.tZ)(x.X2,{flex:"grow",justifyContent:"center",alignItems:"center",children:(0,s.tZ)(v.U,{user:{photo_url:G||(null==n?void 0:n.photo_url)||null},onChangePhoto:e=>{let{photo_url:t}=e;return this.setState({newPhotoUrl:t})}})}),(0,s.BX)(f.ZP,{ref:this.formRef,method:"put",action:"/api/v1/user/profile",prepareData:g,onSuccess:ek,onError:e=>this.onError(e),noInlineErrors:!0,loading:ei,autoLock:!0,children:[(0,s.BX)(x.sg,{gap:20,children:[(0,s.BX)(P.fv,{children:[(0,s.tZ)(X.Y5,{htmlFor:"name",children:V("Name")}),Q?(0,s.tZ)("input",{type:"hidden",name:"pub_id",value:Q.id}):null,(0,s.tZ)(P.oi,{autoFocus:!0,type:"text",className:"profile-name",placeholder:V("Type your name..."),name:"name",id:"name",value:eh,onInput:e=>{this.setState({newName:e.currentTarget.value})}})]}),ev&&(0,s.BX)(P.fv,{children:[(0,s.tZ)(X.Y5,{htmlFor:"email",children:V("Email")}),(0,s.tZ)(P.oi,{type:"email",placeholder:V("Enter your email address..."),name:"email",value:null!=et?et:void 0,onInput:e=>{this.setState({newEmail:e.currentTarget.value})}})]}),d&&(0,s.BX)(P.fv,{children:[(0,s.tZ)(X.__,{htmlFor:"handle",children:V("Handle")}),(0,s.tZ)(P.oi,{type:"text",className:"profile-name",placeholder:V("Type your handle..."),name:"handle",id:"handle",value:em,onInput:e=>{this.setState({newHandle:e.currentTarget.value})}})]}),!U&&(0,s.BX)(P.fv,{children:[(0,s.tZ)(X.__,{htmlFor:"bio",children:V("Bio")}),(0,s.tZ)(F.g,{placeholder:V("Say something about yourself..."),name:"bio",id:"bio",value:eb,onInput:e=>{this.setState({newBio:e.currentTarget.value})}}),k&&(0,s.tZ)(N.p6,{align:"left",children:V("Tip: this will be shown at the bottom of your guest post")})]}),k&&(0,s.tZ)("input",{type:"hidden",name:"needs_bio",value:"true"}),$&&(0,s.BX)(P.fv,{children:[(0,s.tZ)(X.OV,{htmlFor:"social",hint:V("Optional"),children:V("Where else can you be found?")}),(0,s.BX)(x.X2,{gap:8,children:[(0,s.BX)(I.i,{name:"social",value:er,onChange:e=>{this.setState({selectedSocial:e.currentTarget.value})},children:[(0,s.tZ)(I.d,{children:V("Select a social network")}),(0,s.tZ)("option",{value:"twitter",children:V("Twitter")}),(0,s.tZ)("option",{value:"instagram",children:V("Instagram")}),(0,s.tZ)("option",{value:"tiktok",children:V("Tiktok")}),(0,s.tZ)("option",{value:"linkedin",children:V("LinkedIn")}),(0,s.tZ)("option",{value:"youtube",children:V("Youtube")})]}),(0,s.tZ)(P.oi,{flex:"grow",type:"text",placeholder:V("@yourhandle"),name:"socialHandle",value:es,onInput:e=>{this.setState({selectedSocialHandle:e.currentTarget.value})}})]})]}),ey&&(0,s.BX)(P.fv,{children:[(0,s.tZ)(X.__,{children:V("Publication to display")}),(0,s.tZ)(S.Z,{padding:12,gap:12,children:_.map((e,t)=>{var i,n;return(0,s.tZ)(X.__,{for:"primary-radio-".concat(e.id),children:(0,s.BX)(x.X2,{gap:12,alignItems:"center",children:[(0,s.tZ)("input",{id:"primary-radio-".concat(e.id),type:"radio",name:"primary_publication_user_id",value:e.id,checked:0===t}),(0,s.tZ)(E.wk,{pub:e.publication,size:24}),(0,s.tZ)(T.xv.B3,{as:"span",children:null!==(n=null===(i=e.publication)||void 0===i?void 0:i.name)&&void 0!==n?n:""})]})})})})]}),eZ&&(0,s.BX)(x.gq,{as:"label",className:z.checkbox,gap:8,children:[(0,s.tZ)(C.X,{size:"sm",name:"free_signup",defaultChecked:!0,checked:eu,onChange:e=>this.setState({subscribeToNewsletter:e})}),(0,s.tZ)(T.xv.B3,{as:"span",children:V("Subscribe to the newsletter")})]}),e_&&(0,s.BX)(x.gq,{as:"label",className:z.checkbox,gap:8,children:[(0,s.tZ)(C.X,{type:"checkbox",name:"create_publication",id:"create-publication-checkbox",checked:eo,onChange:e=>{this.setState({createPublication:e})}}),(0,s.tZ)(T.xv.B3,{as:"span",children:V("Create a Substack publication for me")})]}),(0,s.tZ)("input",{type:"hidden",name:"confirmation_redirect_pathname",value:document.location.pathname}),(0,s.tZ)("input",{type:"hidden",name:"photo_url",value:null!=ed?ed:void 0}),(0,s.tZ)("input",{type:"hidden",name:"user_id",value:(null==n?void 0:n.id)||""}),(0,s.tZ)("input",{type:"hidden",name:"needs_photo",value:!!c}),(0,s.tZ)("input",{type:"hidden",name:"token",value:h}),j&&(0,s.tZ)("input",{type:"hidden",name:"complete",value:!0}),(0,s.BX)("div",{id:"error-container",children:[en&&(0,s.BX)(T.xv,{as:"div",translated:!0,className:"error other-error",children:["If you have an account with us, we've sent an email to ",(0,s.tZ)("b",{children:D.mb.p(null!=et?et:"")})," with a link that you can use to sign in."]}),ea&&(0,s.tZ)("div",{className:"error other-error",children:V("We have sent you a confirmation email. Please check your inbox before continuing.")})]}),eg&&(0,s.BX)(T.xv.B3,{as:"span",children:[A?W("1 subscription is displayed on your profile.","%1 subscriptions are displayed on your profile.",a):W("1 subscription will be displayed on your profile.","%1 subscriptions will be displayed on your profile.",a)," ",(0,s.tZ)(T.hh,{decoration:"underline",onClick:O,children:V("Edit")})]}),ef&&(0,s.BX)(T.xv.B3,{as:"span",children:[W("1 recommendation will be made on your publication.","%1 recommendations will be made on your publication.",q)," ",(0,s.tZ)(T.hh,{decoration:"underline",onClick:Y,children:V("Edit")})]})]}),(0,s.BX)(x.sg,{gap:8,paddingTop:20,children:[!n&&(0,s.tZ)(w.xu,{className:z.tosCheckboxContainer,paddingBottom:12,children:(0,s.tZ)(L.O,{checked:ec,onCheckboxChange:e=>this.setState({tosAccepted:e}),style:{display:"flex"}})}),(0,s.tZ)(B.zx,{priority:"primary",disabled:!n&&!ec,type:"submit",size:"lg",children:b||V("Save")}),H&&(0,s.tZ)(B.zx,{priority:"secondary",onClick:H||(()=>{}),children:V("Skip")})]})]})]})}constructor(e,t){var i;super(e,t),(0,n._)(this,"formRef",void 0),this.formRef=(0,c.createRef)();let a=!!e.isPostInvite||!!e.profileExists;this.state={newName:null,newHandle:null,newBio:null,newEmail:e.user&&e.user.is_magic?e.user.email:null,selectedSocial:"instagram",createPublication:!!e.isPostInvite&&!(null===(i=e.user)||void 0===i?void 0:i.has_publication),tosAccepted:a,subscribeToNewsletter:!0}}}let Y=(0,g.f9)((0,Z.fz)(U));class q extends(/^(1612|2787|3154|4153|6909)$/.test(i.j)?y.p:null){renderChildren(){let e=this.props,{ref:t,onBeforeClose:i,contributor:n}=e,r=(0,o._)(e,["ref","onBeforeClose","contributor"]);return(0,s.tZ)("div",{className:"profile-updater-modal",children:n?(0,s.tZ)(M,(0,l._)((0,a._)({},r),{user:r.user,pub:r.pub,profile:r.profile,onSuccess:()=>this.close(!0)})):(0,s.tZ)(Y,(0,l._)((0,a._)({},r),{onSuccess:()=>this.close(!0)}))})}}let M=e=>{let{profile:t,user:i,pub:n,onSuccess:a,isOwnProfile:l}=e,{iString:o}=(0,Z.M1)(),[r,c]=(0,u.eJ)(null),d=r||t&&t.photo_url,[p,h]=(0,u.eJ)(t.name),[m,b]=(0,u.eJ)(t.bio);return(0,s.BX)("div",{className:"profile-updater",children:[(0,s.tZ)("h2",{className:"page-title profile-updater-title",children:"Edit contributor profile"}),(0,s.tZ)("div",{className:"profile-photo-wrap",children:(0,s.tZ)(v.U,{user:{photo_url:r||(null==t?void 0:t.photo_url)||null},onChangePhoto:e=>{let{photo_url:t}=e;return c(t)}})}),(0,s.BX)(f.ZP,{method:"patch",action:"/api/v1/publication/users/".concat(t.id),onSuccess:a,autoLock:!0,children:[(0,s.tZ)("input",{type:"text",className:"profile-name",placeholder:"Contributor's name…",name:"name",value:p,onInput:e=>{h(e.target.value)}}),(0,s.tZ)("textarea",{className:"profile-bio",placeholder:"Contributor's bio…",name:"bio",value:m,onInput:e=>{b(e.target.value)}}),(0,s.tZ)("input",{type:"hidden",name:"photo_url",value:d}),(0,s.BX)("span",{className:"notice",children:[(0,s.BX)(T.xv,{translated:!0,as:"p",children:[(0,s.tZ)("b",{children:"Note:"})," This is a contributor profile, viewable by ",D.mb.p(n.name),"'s readers."]}),l&&(0,s.BX)(T.xv,{translated:!0,as:"p",children:["You may also edit your"," ",(0,s.tZ)("a",{native:!0,href:"".concat((0,j.NNq)(i)),children:"personal profile"}),"."]})]}),(0,s.tZ)(B.zx,{priority:"primary",type:"submit",children:o("Update profile")})]})]})}}}]);