"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["8336"],{18787:function(t,e,l){if(l.d(e,{f1:()=>K,qV:()=>V,sF:()=>M}),l(27412),!/^(2787|5288)$/.test(l.j))var a=l(7409);if(!/^(2787|5288)$/.test(l.j))var i=l(98848);var n=l(58865),r=l(16584),o=l(30396),s=l(94184),c=l.n(s),u=l(80569),d=l.n(u),p=l(83034),h=l(12620),m=l(75021),b=l(93666),f=l(33665),_=l(12281),v=l(95441),y=l(68833),w=l(98914),g=l(94874),Z=l(15771),k=l(19081),N=l(58175),S=l(40894),C=l(24791),P=l(60308),U=l(26111),X=l(23945),x=l(81821),B=l(47929),A=l(71004);function E(){let t=(0,n._)(["Available now for iOS and Android"]);return E=function(){return t},t}function T(){let t=(0,n._)([""," gifted you this paid post. Unlock it in the free Substack app"]);return T=function(){return t},t}function I(){let t=(0,n._)(["Upgrade to ",""]);return I=function(){return t},t}function L(){let t=(0,n._)(["Upgrade to ",""]);return L=function(){return t},t}function O(){let t=(0,n._)(["Already in the "," plan?"]);return O=function(){return t},t}function F(){let t=(0,n._)(["Already in the Founding Member plan?"]);return F=function(){return t},t}let K=t=>{var e,l,a;let i,{className:n=null,title:s,subtitle:u=null,reauthenticationTitle:b,publication:_,post:Z,user:S,freeSignup:C=null,freeSignupEmail:A=null,email_form:I=!1,autoFocus:L=!1,isStatic:O=!1,coupon:F=null,showPostUnlockPrompt:K=!1,magicToken:H=null,onPostUnlockError:W=null,giftingUser:G=null,treatmentVariantForGiftPostPaywall:q=null}=t,M=null==S?void 0:S.reader_installed_at,{iString:R,iTemplate:z}=(0,v.M1)(),[Y,J]=(0,o.eJ)(!1),[Q,tt]=(0,o.eJ)(!1),{modal:te,open:tl}=(0,p.useAppModal)({utm_campaign:B.VX.paywallPostUnlockPrompt,utm_source:B.b3.substack,overrideCTA:M?R("Open in app"):void 0,overrideTitle:R(M?"Unlock your free post in the Substack app":"Get the free Substack app to unlock this post"),subTitle:z(E()),openUrl:null!==(e=M&&(0,P.K8_)(_.subdomain,Z.slug))&&void 0!==e?e:void 0}),ta=S&&S.email||A||null,ti=!!((null==S?void 0:S.is_subscribed)&&(null==S?void 0:S.is_magic)),tn=(null==Z?void 0:Z.audience)==="founding",tr=!!((null==S?void 0:S.is_free_subscribed)||C),to=(0,P.uRy)(_,Z),ts=(0,x.tq)({checkFirst4:!0}),tc=(0,o.I4)(async function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(0,y.j)(y.FP.PAYWALL_UNLOCK_CTA_CLICKED,{post_id:Z.id,publication_id:_.id,from_email:t});try{await d().post("/api/v1/post_unlock_token").send({post_id:Z.id,token:H}),ts?window.location.href=M?(0,P.K8_)(_.subdomain,Z.slug,{redirect:"app-store",params:{utm_campaign:B.VX.paywallPostUnlockPrompt,utm_source:B.b3.paywall}}):(0,P.D4e)({utm_campaign:B.VX.paywallPostUnlockPrompt,utm_source:B.b3.paywall}):tl()}catch(t){null==W||W()}},[Z.id,Z.slug,_.id,_.subdomain,H,M,tl,W,ts]);(0,o.d4)(()=>{K&&(0,y.j)(y.FP.PAYWALL_UNLOCK_CTA_VIEWED,{publication_id:_.id,post_id:Z.id})},[Z.id,_.id,K]),(0,o.d4)(()=>{(0,U.x)("launch_post_unlock_offer")&&(tc(!0),window.history.replaceState({},document.title,(0,P.rhs)({launch_post_unlock_offer:null})))},[tc]);let tu=!!F&&!!F.id&&!tn&&!K;i=tu?R((null==Z?void 0:Z.type)==="podcast"?"Listen to this episode with a 7-day free trial":(null==Z?void 0:Z.type)==="video"?"Watch with a 7-day free trial":"Keep reading with a 7-day free trial"):ti?b:s;let td=async()=>{if(!G){console.warn("tried to claim gift post, but no gifting user");return}if((0,y.j)(y.FP.GIFT_POST_CLAIM_CTA_CLICKED,{post_id:Z.id,pub_id:_.id,referring_user_id:G.id,user_id:null==S?void 0:S.id,variant:q,source:"paywall"}),!S){tt(!0);return}J(!0);try{await d().post("/api/v1/post_unlock_token").send({post_id:Z.id,gifting_user_id:G.id,email:ta}),(0,w.uX)((0,P.K8_)(_.subdomain,Z.slug,{redirect:"app-store",source:B.b3.paywall}))}catch(t){null==W||W()}finally{J(!1)}};return G&&q&&K?(0,r.BX)("div",{role:"region","aria-label":R("Gift post paywall"),children:[Q&&(0,r.tZ)(m.f,{user:S,post:Z,pub:_,referringUser:G,freeSignupEmail:null!=A?A:void 0,variant:q,startOnEmailCollection:!0}),(0,r.BX)("div",{className:c()("paywall",n),"data-testid":"paywall","data-component-name":"Paywall",children:[(0,r.tZ)(g.qE,{photoUrl:null!==(l=G.photo_url)&&void 0!==l?l:void 0,size:64,className:O?"paywall-unlock-avatar-static":"paywall-unlock-avatar"}),(0,r.tZ)(m.E,{style:{position:"absolute",left:"calc(50% + 5px)",top:"5px"},size:24}),(0,r.tZ)(N.xv,{weight:"light",className:c()("paywall-title","unlock-treatment-new"),children:z(T(),(0,X.Q1)(G.name))}),(0,r.tZ)(D,{isStatic:O,onClick:()=>td(),btnClassName:c()(K&&"paywall-cta-icon"),disabled:Y,children:R("Claim my free post")}),tr?(0,r.BX)($,{isStatic:O,publication:_,post:Z,postUrl:to,coupon:F,useCoupon:tu,children:[R("Or upgrade your subscription.")," ",(0,r.tZ)("b",{children:(0,r.tZ)(f.n,{pub:_,user:S,isStatic:!0})})]}):(0,r.tZ)("div",{className:"paywall-login",children:(0,r.BX)("a",{href:(0,P.uXE)({for_pub:_.subdomain,change_user:!!ta}),native:!0,children:[V({post:Z,publication:_,isPaid:!I})," ",(0,r.tZ)("b",{children:R(ta?"Switch accounts":"Sign in")})]})})]})]}):(0,r.BX)("div",{className:c()("paywall",n),"data-testid":"paywall","data-component-name":"Paywall",role:"region","aria-label":R("Paywall"),children:[K&&(0,r.tZ)(g.qE,{photoUrl:null!==(a=_.author_photo_url)&&void 0!==a?a:void 0,size:64,className:O?"paywall-unlock-avatar-static":"paywall-unlock-avatar"}),ta&&!K&&(0,r.BX)(N.xv,{translated:!0,as:"div",className:"paywall-intro",paddingBottom:8*!!K,children:["Hi ",(0,r.tZ)("b",{children:I18N.p(ta)})]}),(0,r.tZ)("h2",{className:c()("paywall-title",K&&"unlock-treatment-new"),children:i}),u&&!tu&&(0,r.tZ)("p",{className:"paywall-subtitle",children:u}),tu&&(0,r.BX)("div",{className:"paywall-free-trial-subtitle",children:[(null==Z?void 0:Z.type)==="podcast"&&(0,r.BX)(N.xv,{translated:!0,as:"p",className:"paywall-subtitle",children:["Subscribe to"," ",(0,r.tZ)(N.xv,{as:"span",weight:"bold",fontStyle:"italic",children:I18N.p(_.name)})," ","to listen to this post and get 7 days of free access to the full post archives."]}),(null==Z?void 0:Z.type)==="video"&&(0,r.BX)(N.xv,{translated:!0,as:"p",className:"paywall-subtitle",children:["Subscribe to"," ",(0,r.tZ)(N.xv,{as:"span",weight:"bold",fontStyle:"italic",children:I18N.p(_.name)})," ","to watch this video and get 7 days of free access to the full post archives."]}),(null==Z?void 0:Z.type)==="newsletter"&&(0,r.BX)(N.xv,{translated:!0,as:"p",className:"paywall-subtitle",children:["Subscribe to"," ",(0,r.tZ)(N.xv,{as:"span",weight:"bold",fontStyle:"italic",children:I18N.p(_.name)})," ","to keep reading this post and get 7 days of free access to the full post archives."]}),(null==Z?void 0:Z.type)==="adhoc_email"&&(0,r.BX)(N.xv,{translated:!0,as:"p",className:"paywall-subtitle",children:["Subscribe to"," ",(0,r.tZ)(N.xv,{weight:"bold",fontStyle:"italic",children:I18N.p(_.name)})," ","to keep reading this email and get 7 days of free access to the full post archives."]})]}),I?!tr&&(0,r.tZ)(k.gq,{paddingTop:24,justifyContent:"center",children:(0,r.tZ)(h.Z,{autoFocus:null==L||L,email:ta,freeSignup:C,freeSignupEmail:A,onAccentBackground:!0,pub:_,source:"post-unlock",submitButtonText:R((null==Z?void 0:Z.type)==="podcast"?"Start listening":(null==Z?void 0:Z.type)==="video"?"Start watching":"Start reading"),user:S,onSuccess:()=>document.location.reload()})}):K?(0,r.BX)(r.HY,{children:[te,(0,r.tZ)(D,{isStatic:O,onClick:()=>tc(!1),btnClassName:c()(K&&"paywall-cta-icon"),children:R("Claim my free post")})]}):(0,r.tZ)(j,{coupon:F,email:ta,isStatic:O,post:Z,postUrl:to,publication:_,useCoupon:tu,user:S}),K&&(0,r.BX)($,{isStatic:O,publication:_,post:Z,postUrl:to,coupon:F,useCoupon:tu,children:[R("Or upgrade your subscription.")," ",(0,r.tZ)("b",{children:(0,r.tZ)(f.n,{pub:_,user:S,isStatic:!0})})]}),!ti&&!O&&!K&&(0,r.tZ)("div",{className:"paywall-login",children:(0,r.BX)("a",{href:(0,P.uXE)({for_pub:_.subdomain,change_user:!!ta}),native:!0,children:[V({post:Z,publication:_,isPaid:!I})," ",(0,r.tZ)("b",{children:R(ta?"Switch accounts":"Sign in")})]})})]})},j=t=>{var e,l;let{coupon:a,email:i,isStatic:n,post:o,postUrl:s,publication:c,useCoupon:u,user:d}=t,p=!!(null==d?void 0:d.is_founding),h=!!(null==d?void 0:d.is_subscribed),m=!!((null==d?void 0:d.is_subscribed)&&(null==d?void 0:d.is_magic)),b=(null==o?void 0:o.audience)==="founding",{iString:_,iTemplate:y}=(0,v.M1)();if(n){if(!c.plans)return null;let t=b?S.W.FOUNDING_CHECKOUT_URL:S.W.CHECKOUT_URL,l=u?"&coupon=".concat(null==a?void 0:a.id):"",i=b?y(I(),null!==(e=(0,C.H$)(c))&&void 0!==e?e:""):u?_("Start trial"):(0,r.tZ)(f.n,{pub:c,user:d,isStatic:n});return(0,r.tZ)(H,{href:"".concat(t,"simple=true&utm_source=").concat(B.b3.paywall,"&utm_medium=").concat(B.lP.email,"&utm_content=").concat(o.id,"&next=").concat(s).concat(l),children:i})}return!p&&b?c.plans?(0,r.tZ)(W,{href:(0,P.Zs0)(c,{simple:!0,next:document.location.href,utm_source:B.b3.paywall,utm_medium:B.lP.web,utm_content:o?o.id:null,plan:"founding"}),children:y(L(),null!==(l=(0,C.H$)(c))&&void 0!==l?l:"")}):null:h?m?(0,r.tZ)(W,{href:(0,P.uXE)({for_pub:c.subdomain,email:i}),children:_("Click here to sign in")}):null:c.plans?(0,r.tZ)(W,{href:(0,P.Zs0)(c,{simple:!0,next:document.location.href,utm_source:u?B.b3.paywallFreeTrial:B.b3.paywall,utm_medium:n?B.b3.email:B.b3.web,utm_content:o?o.id:null,coupon:u?null==a?void 0:a.id:null}),children:u?_("Start trial"):(0,r.tZ)(f.n,{pub:c,user:d,isStatic:n})}):null},H=t=>{let{children:e,href:l}=t;return(0,r.tZ)("div",{className:"paywall-cta",children:(0,r.tZ)("a",{className:"button primary subscribe-btn",href:l,children:(0,r.tZ)("span",{children:e})})})},W=t=>{let{children:e,href:l}=t;return(0,r.tZ)("div",{className:"paywall-cta",children:(0,r.tZ)("a",{href:l,native:!0,children:(0,r.tZ)(Z.kG,{resetCss:!0,className:c()("subscribe-btn",A.Z.subscribeButton),children:e})})})},$=t=>{let{post:e,isStatic:l,publication:a,onClick:i,children:n,postUrl:o,coupon:s,useCoupon:c}=t,u=(0,P.Zs0)(a,{simple:!0,next:document.location.href,utm_source:B.b3.paywall,utm_medium:l?B.lP.email:B.lP.web,utm_content:e?e.id:null,just_signed_up:!1});i=async()=>{window.location.href=u};let d=c?"&coupon=".concat(null==s?void 0:s.id):"",p="".concat(u,"simple=true&utm_source=").concat(B.b3.paywall,"&utm_medium=").concat(B.lP.email,"&utm_content=").concat(e.id,"&next=").concat(o).concat(d);return l?(0,r.tZ)(G,{href:p,children:n}):(0,r.tZ)(q,{onClick:i,href:p,children:n})},G=t=>{let{children:e,href:l}=t;return(0,r.tZ)("div",{className:"paywall-secondary-cta",children:(0,r.tZ)("a",{href:l,children:e})})},q=t=>{let{children:e,href:l,onClick:a}=t;return(0,r.tZ)("div",{className:"paywall-secondary-cta",children:(0,r.tZ)("a",{onClick:a,href:l,native:!0,children:e})})},D=t=>{let{isStatic:e,onClick:l,children:a,btnClassName:i,disabled:n}=t;return e?(0,r.tZ)("div",{className:"paywall-cta",children:(0,r.tZ)("a",{className:c()("button","primary",i),href:"".concat(S.W.POST_URL,"&launch_post_unlock_offer=true"),children:a})}):(0,r.tZ)("div",{className:"paywall-cta",children:(0,r.tZ)("a",{onClick:l,native:!0,children:(0,r.tZ)(Z.kG,{resetCss:!0,className:c()("subscribe-btn",A.Z.subscribeButton,i),disabled:n,children:a})})})};class M extends(/^(2787|5288)$/.test(l.j)?null:b.p){renderChildren(){let t=this.props,{ref:e}=t,l=(0,i._)(t,["ref"]);return(0,r.tZ)(K,(0,a._)({className:"modal-paywall"},l))}}function V(){let{post:t,publication:e,isPaid:l=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{iString:a,iTemplate:i}=I18N.i(e?{pub:e}:"en");if(!l)return a("Already a subscriber?");if((null==t?void 0:t.audience)==="founding"){var n;return(0,C.H$)(e)?i(O(),null!==(n=(0,C.H$)(e))&&void 0!==n?n:""):i(F())}return a("Already a paid subscriber?")}_.Z}}]);