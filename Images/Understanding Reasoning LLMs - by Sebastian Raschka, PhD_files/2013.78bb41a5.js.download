"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["2013"],{54416:function(t,n,e){e.d(n,{Z:()=>o});let o={visitedSurfacesIFrame:"visitedSurfacesIFrame-yy8AJL"}},68979:function(t,n,e){e.d(n,{Z:()=>_});var o=e(27412),i=e(7409),a=e(99282),r=e(16584),l=e(6400),d=e(40647),u=e(68833),s=e(59176),c=e(98914),m=e(63651);let h="".concat(m.tEc,"/fedcm/config.json");var p=e(60308),v=e(26111);let g="domain-redirect-time";class _ extends l.Component{componentDidMount(){let t=this.loadedWithLikelyLoggedInParam()?"param":null;t&&!this.shouldBlockLoginRedirect()?this.attemptLoginRedirect({source:t}):this.useFedCm()?this.initiateFedCmFlow():this.useIframe()&&window.addEventListener("message",t=>this.handleFrameMessage(t)),(0,c.iO)("triedSigningIn")}useFedCm(){var t;return(null===(t=this.state.pub)||void 0===t?void 0:t.custom_domain)&&!this.state.user&&this.context.getConfigFor("enable_fedcm")&&"undefined"!=typeof window&&"IdentityCredential"in window}async initiateFedCmFlow(){let t=await navigator.credentials.get({identity:{providers:[{configURL:h,clientId:"substack_custom_domain"}]}});(null==t?void 0:t.token)==="redirect-to-login"&&this.attemptLoginRedirect({source:"fedcm"})}shouldBlockLoginRedirect(){var t;let n=parseInt((0,s.mM)(g,0));return this.state.block_auto_login||!(null===(t=this.state.pub)||void 0===t?void 0:t.custom_domain)||this.state.user||"undefined"==typeof window||Date.now()-n<=864e5||this.state.triedSigningIn}handleFrameMessage(t){var n,e,o;if((null===(n=t.data)||void 0===n?void 0:n.type)!=="frame-state")return;let i=!this.shouldBlockLoginRedirect()&&(null===(e=t.data)||void 0===e?void 0:e.loggedInAtSubstack);(0,u.j)(u.FP.FRAME_MESSAGE_HANDLED,{loggedInAtSubstack:null===(o=t.data)||void 0===o?void 0:o.loggedInAtSubstack,loggedInAtCustomDomain:!!this.state.user,attemptRedirect:i}),i&&this.attemptLoginRedirect({source:"cookie"})}attemptLoginRedirect(){var t;let{source:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,u.j)(u.FP.CUSTOM_DOMAIN_LOGIN_REDIRECT_ATTEMPTED,{fromParam:"param"===n,source:n}),(0,s.ex)(g,"".concat(Date.now()));let e=(0,p.YZ5)({useOriginalUrl:!0});this.props.initialData.hide_intro_popup&&(e=(0,p.rhs)(e,{hide_intro_popup:!0})),location.href=(0,p.uXE)({for_pub:null===(t=this.state.pub)||void 0===t?void 0:t.subdomain,justTrying:!0,redirect:e})}loadedWithLikelyLoggedInParam(){return"undefined"!=typeof window&&window._preloads.original_url&&!!(0,v.x)(window._preloads.original_url,"lli")}useIframe(){var t,n,e;return!("undefined"==typeof window||this.loadedWithLikelyLoggedInParam()||!(null===(t=this.state.pub)||void 0===t?void 0:t.custom_domain)||(0,p.fF3)(null===(e=window)||void 0===e?void 0:null===(n=e.location)||void 0===n?void 0:n.href))}render(){return this.useIframe()?(0,r.tZ)("iframe",{src:"".concat((0,p.ZJn)(),"/channel-frame"),className:"channel-frame",width:"0",height:"0"}):null}constructor(t,n){var e;super(t,n),this.state=(0,a._)((0,i._)({},t.initialData),{triedSigningIn:null!==(e=(0,v.x)("triedSigningIn"))&&void 0!==e?e:void 0})}}(0,o._)(_,"contextType",d.QA)},15872:function(t,n,e){e.d(n,{W:()=>o});let o=(0,e(84864).randomString)()},49762:function(t,n,e){e.d(n,{Uw:()=>a,ZP:()=>r,kR:()=>l});var o=e(16584),i=e(40647);function a(t){var n;if(!t||"undefined"==typeof window||!(null===(n=window._preloads)||void 0===n?void 0:n.siteConfigs))return null;let e=window._preloads.siteConfigs[t];return void 0===e?null:e}let r=a;function l(t){let{configKey:n,children:e,value:a=!0}=t;return(0,i.xR)().getConfigFor(n)==a?(0,o.tZ)(o.HY,{children:e}):null}},31582:function(t,n,e){e.d(n,{$e:()=>o,vq:()=>i}),e(18029),e(98012),e(84864);let o=(t,n)=>{let e;if(n&&n!==t.currency){var o,i,a;if(!(null===(o=t.currency_options)||void 0===o?void 0:o[n]))return;e=null!==(a=null===(i=t.currency_options[n])||void 0===i?void 0:i.unit_amount)&&void 0!==a?a:null}else e="object"in t&&"price"===t.object?t.unit_amount:t.amount;return null!=e?e:0},i=(t,n)=>{var e;return n&&n!==t.currency?null===(e=t.metadata.minimum_local)||void 0===e?void 0:e[n]:t.metadata.minimum}},18967:function(t,n,e){e.d(n,{E4:()=>i,ML:()=>a});var o,i=((o={}).CompOneMonth="comp_one_month",o.CompThreeMonths="comp_three_months",o.CompSixMonths="comp_six_months",o.CompNineMonths="comp_nine_months",o.CompTwelveMonths="comp_twelve_months",o.Custom="custom",o);let a={comp_one_month:"1 month comp",comp_three_months:"3 month comp",comp_six_months:"6 month comp",comp_nine_months:"9 month comp",comp_twelve_months:"12 month comp",custom:"Custom"}},70408:function(t,n,e){e.d(n,{I4:()=>l,SM:()=>a,YL:()=>d,ln:()=>r});var o=e(14773),i=e(63651);function a(t,n){let e=r(t,n);return e||((null==n?void 0:n.darkMode)?s:u)}function r(t){let{preferAuthorPhoto:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n&&(null==t?void 0:t.author_photo_url)&&(0,i.zF4)(t.author_photo_url)?(0,i.zF4)(t.author_photo_url):(null==t?void 0:t.photo_url)&&(0,i.zF4)(t.photo_url)?(0,i.zF4)(t.photo_url):(null==t?void 0:t.id)!=null?l(t.id):null}function l(t){return"".concat((0,o.ZJ)(),"/img/avatars/").concat(["purple","yellow","orange","green","black"][t%5],".png")}function d(t){return t.startsWith("".concat((0,o.ZJ)(),"/img/avatars/"))}let u="".concat((0,o.ZJ)(),"/img/avatars/default-light.png"),s="".concat((0,o.ZJ)(),"/img/avatars/default-dark.png")}}]);