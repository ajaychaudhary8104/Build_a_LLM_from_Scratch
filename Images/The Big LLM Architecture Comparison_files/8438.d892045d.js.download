(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["8438"],{27361:function(e,t,r){var n=r(97786);e.exports=function(e,t,r){var u=null==e?void 0:n(e,t);return void 0===u?r:u}},43174:function(e,t,r){var n=r(55189)(function(e,t,r){e[+!r].push(t)},function(){return[[],[]]});e.exports=n},78718:function(e,t,r){var n=r(25970),u=r(99021)(function(e,t){return null==e?{}:n(e,t)});e.exports=u},73955:function(e,t,r){var n=r(79833),u=0;e.exports=function(e){var t=++u;return n(e)+t}},69241:function(e,t,r){"use strict";r.d(t,{JG:()=>i.JG,MA:()=>i.MA,ZP:()=>o,kY:()=>i.kY});var n=r(98661),u=r(61688),i=r(76750);let a=n.default.use||(e=>{if("pending"===e.status)throw e;if("fulfilled"===e.status)return e.value;if("rejected"===e.status)throw e.reason;throw e.status="pending",e.then(t=>{e.status="fulfilled",e.value=t},t=>{e.status="rejected",e.reason=t}),e}),s={dedupe:!0};i.$l.defineProperty(i.J$,"defaultValue",{value:i.u_});let o=(0,i.s6)((e,t,r)=>{let{cache:o,compare:l,suspense:d,fallbackData:c,revalidateOnMount:f,revalidateIfStale:g,refreshInterval:E,refreshWhenHidden:V,refreshWhenOffline:R,keepPreviousData:k}=r,[v,T,p,h]=i.DY.get(o),[L,w]=(0,i.qC)(e),b=(0,n.useRef)(!1),_=(0,n.useRef)(!1),C=(0,n.useRef)(L),m=(0,n.useRef)(t),N=(0,n.useRef)(r),O=()=>N.current,j=()=>O().isVisible()&&O().isOnline(),[y,A,D,I]=(0,i.JN)(o,L),P=(0,n.useRef)({}).current,S=(0,i.o8)(c)?r.fallback[L]:c,x=(e,t)=>{for(let r in P)if("data"===r){if(!l(e[r],t[r])&&(!(0,i.o8)(e[r])||!l($,t[r])))return!1}else if(t[r]!==e[r])return!1;return!0},M=(0,n.useMemo)(()=>{let e=!!L&&!!t&&((0,i.o8)(f)?!O().isPaused()&&!d&&(!!(0,i.o8)(g)||g):f),r=t=>{let r=(0,i.PM)(t);return(delete r._k,e)?{isValidating:!0,isLoading:!0,...r}:r},n=y(),u=I(),a=r(n),s=n===u?a:r(u),o=a;return[()=>{let e=r(y());return x(e,o)?(o.data=e.data,o.isLoading=e.isLoading,o.isValidating=e.isValidating,o.error=e.error,o):(o=e,e)},()=>s]},[o,L]),J=(0,u.useSyncExternalStore)((0,n.useCallback)(e=>D(L,(t,r)=>{x(r,t)||e()}),[o,L]),M[0],M[1]),F=!b.current,Y=v[L]&&v[L].length>0,q=J.data,G=(0,i.o8)(q)?S:q,U=J.error,W=(0,n.useRef)(G),$=k?(0,i.o8)(q)?W.current:q:G,B=(!Y||!!(0,i.o8)(U))&&(F&&!(0,i.o8)(f)?f:!O().isPaused()&&(d?!(0,i.o8)(G)&&g:(0,i.o8)(G)||g)),Z=!!(L&&t&&F&&B),z=(0,i.o8)(J.isValidating)?Z:J.isValidating,H=(0,i.o8)(J.isLoading)?Z:J.isLoading,K=(0,n.useCallback)(async e=>{let t,n;let u=m.current;if(!L||!u||_.current||O().isPaused())return!1;let a=!0,s=e||{},o=!p[L]||!s.dedupe,d=()=>i.w6?!_.current&&L===C.current&&b.current:L===C.current,c={isValidating:!1,isLoading:!1},f=()=>{A(c)},g=()=>{let e=p[L];e&&e[1]===n&&delete p[L]},E={isValidating:!0};(0,i.o8)(y().data)&&(E.isLoading=!0);try{if(o&&(A(E),r.loadingTimeout&&(0,i.o8)(y().data)&&setTimeout(()=>{a&&d()&&O().onLoadingSlow(L,r)},r.loadingTimeout),p[L]=[u(w),(0,i.u3)()]),[t,n]=p[L],t=await t,o&&setTimeout(g,r.dedupingInterval),!p[L]||p[L][1]!==n)return o&&d()&&O().onDiscarded(L),!1;c.error=i.i_;let e=T[L];if(!(0,i.o8)(e)&&(n<=e[0]||n<=e[1]||0===e[1]))return f(),o&&d()&&O().onDiscarded(L),!1;let s=y().data;c.data=l(s,t)?s:t,o&&d()&&O().onSuccess(t,L,r)}catch(r){g();let e=O(),{shouldRetryOnError:t}=e;!e.isPaused()&&(c.error=r,o&&d()&&(e.onError(r,L,e),(!0===t||(0,i.mf)(t)&&t(r))&&j()&&e.onErrorRetry(r,L,e,e=>{let t=v[L];t&&t[0]&&t[0](i.sj.ERROR_REVALIDATE_EVENT,e)},{retryCount:(s.retryCount||0)+1,dedupe:!0})))}return a=!1,f(),!0},[L,o]),Q=(0,n.useCallback)((...e)=>(0,i.BN)(o,C.current,...e),[]);if((0,i.LI)(()=>{m.current=t,N.current=r,(0,i.o8)(q)||(W.current=q)}),(0,i.LI)(()=>{if(!L)return;let e=K.bind(i.i_,s),t=0,r=(0,i.ko)(L,v,(r,n={})=>{if(r==i.sj.FOCUS_EVENT){let r=Date.now();O().revalidateOnFocus&&r>t&&j()&&(t=r+O().focusThrottleInterval,e())}else if(r==i.sj.RECONNECT_EVENT)O().revalidateOnReconnect&&j()&&e();else if(r==i.sj.MUTATE_EVENT)return K();else if(r==i.sj.ERROR_REVALIDATE_EVENT)return K(n)});return _.current=!1,C.current=L,b.current=!0,A({_k:w}),B&&((0,i.o8)(G)||i.W6?e():(0,i.kw)(e)),()=>{_.current=!0,r()}},[L]),(0,i.LI)(()=>{let e;function t(){let t=(0,i.mf)(E)?E(y().data):E;t&&-1!==e&&(e=setTimeout(r,t))}function r(){!y().error&&(V||O().isVisible())&&(R||O().isOnline())?K(s).then(t):t()}return t(),()=>{e&&(clearTimeout(e),e=-1)}},[E,V,R,L]),(0,n.useDebugValue)($),d&&(0,i.o8)(G)&&L){if(!i.w6&&i.W6)throw Error("Fallback data is required when using suspense in SSR.");m.current=t,N.current=r,_.current=!1;let e=h[L];if((0,i.o8)(e)||a(Q(e)),(0,i.o8)(U)){let e=K(s);(0,i.o8)($)||(e.status="fulfilled",e.value=!0),a(e)}else throw U}return{mutate:Q,get data(){return P.data=!0,$},get error(){return P.error=!0,U},get isValidating(){return P.isValidating=!0,z},get isLoading(){return P.isLoading=!0,H}}})}}]);