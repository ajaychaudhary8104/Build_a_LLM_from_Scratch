"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["1797"],{64473:function(e,t,n){n.d(t,{Z:()=>i});let i={iframe:"iframe-_GPXZ7",codeInput:"codeInput-elXe0s"}},8108:function(e,t,n){n.d(t,{Z:()=>i});let i={dropdownMenu:"dropdownMenu-ASlbF5",textInput:"textInput-kYr7wC"}},19961:function(e,t,n){n.d(t,{Z:()=>i});let i={chip:"chip-lJKwY5",textOnly:"textOnly-SPwDNp",leading:"leading-TvXpau",trailing:"trailing-lhDVKn",clickable:"clickable-IxUlBk",disabled:"disabled-F1nG5l",fillIcon:"fillIcon-jYnt2U"}},77747:function(e,t,n){n.d(t,{I:()=>M,Jg:()=>R,aQ:()=>L,oQ:()=>z});var i=n(7409),o=n(99282),r=n(16584),l=n(6400),a=n(98661),c=n(30396),d=n(94184),s=n.n(d),u=n(20160),p=n(93228),m=n(5772),h=n(60807),v=n(48980),f=n(7882),g=n(15771),y=n(80026),Z=n(86075),C=n(32700),b=n(21685),T=n(98248),x=n(85930),w=n(63474),I=n(58175),k=n(23710);let _=(0,l.createContext)({isLoading:!1,emojis:{suggestedReactionTypes:[],categories:[],reactionTypes:{}}});function M(e){let{children:t}=e,{user:n}=(0,h.SE)(),{result:i,isLoading:o}=(0,f.ib)({pathname:"/api/v1/threads/reactions",method:"GET",cacheTtl:6e5,auto:!!n});return(0,r.tZ)(_.Provider,{value:{emojis:i,isLoading:o},children:t})}function R(e){let{context:t,reactions:n,currentReaction:i,onReactionClick:o,isReadOnly:l,showCounts:a=!0,maxReactions:d,direction:p}=e,m=n&&Object.keys(n).some(e=>n[e]>0),h=(0,c.sO)(null),[v,f]=(0,c.eJ)(!1),{emojis:g,isLoading:Z}=(0,c.qp)(_),T=(0,c.Ye)(()=>n&&(null==g?void 0:g.reactionTypes)?Object.entries(n).sort((e,t)=>{let[n,i]=e,[o,r]=t;return i===r?n.localeCompare(o):r-i}).filter(e=>{let[t,n]=e;return n>0&&g.reactionTypes[t]}).slice(0,3):[],[n,g]);return(null==g?void 0:g.reactionTypes)?(0,r.tZ)(u.W,{children:(0,r.BX)(y.gq,{onClick:E,className:s()(k.Z.reactionsContainer,{[k.Z.show]:m||v,[k.Z.outgoing]:"outgoing"===p}),children:[T.map(e=>{let[n,l]=e,c=g.reactionTypes[n],d=n===i||c===i,u=(0,r.BX)(y.gq,{className:s()(k.Z.reaction,{[k.Z.selected]:a&&d}),shadow:"sm",bg:"primary",gap:4,alignItems:"center",justifyContent:"center",paddingX:6,onClick:()=>c&&o&&o(n,c),children:[(0,r.tZ)(I.xv.B4,{font:"emoji",children:c}),a&&(0,r.tZ)(I.xv.Meta,{fontWeight:"bold",color:d?"white":"primary",children:l})]},n);return["feed-recommended","direct-message"].includes(t.type)?u:(0,r.tZ)(C.z,{layerClassName:k.Z.nameCard,content:(0,r.tZ)(O,{context:t,reaction:n}),layerOptions:{placement:"bottom-center"},children:u},n)}),!l&&(!d||!i)&&(0,r.tZ)(b.J2,{trigger:(0,r.tZ)(j,{}),placement:"bottom",onOpen:()=>f(!0),onClose:()=>f(!1),children:e=>{let{close:t}=e;return(0,r.tZ)(S,{emojis:g,isLoading:Z,currentReaction:i,onPick:(e,n)=>{o&&o(e,n),t()},inputRef:h})}})]})}):null}let j=(0,a.forwardRef)((e,t)=>(0,r.tZ)(g.kG,(0,o._)((0,i._)({ref:t,resetCss:!0,className:k.Z.addReactButton,shadow:"sm",bg:"primary",paddingX:4,alignItems:"center"},e),{children:(0,r.tZ)(p.Z,{className:k.Z.addReactIcon})})));function S(e){var t;let{emojis:i,isLoading:o,currentReaction:l,onPick:a,inputRef:d}=e,s=(0,c.Ye)(()=>(null==i?void 0:i.reactionTypes)&&!o?Object.keys(i.reactionTypes):[],[null==i?void 0:i.reactionTypes,o]),{result:p,isLoading:h}=(0,f.Wf)(()=>n.e("7710").then(n.t.bind(n,54833,19)),[],{auto:!0}),v=(0,c.I4)(e=>[e,...(null==p?void 0:p[e])||[]],[p]),{filteredItems:g,setQuery:C,hasFiltered:b,query:w}=(0,m.R)({items:s,getKeys:v,deps:[s,v]});return(0,r.tZ)(u.W,{children:(0,r.BX)(y.tu,{sizing:"border-box",gap:12,padding:4,minWidth:320,height:400,onClick:E,overflowY:"auto",children:[(0,r.tZ)(x.M,{ref:d,onChange:C}),o||h?(0,r.tZ)(y.tu,{flex:"grow",justifyContent:"center",alignItems:"center",children:(0,r.tZ)(T.$j,{})}):(0,r.BX)(r.HY,{children:[b&&(g&&g.length>0?(0,r.tZ)(B,{reactions:g,currentReaction:l,onPick:a,emojiMap:i.reactionTypes,title:null}):(0,r.tZ)(Z.u,{title:"No results for ".concat(w),description:"Try another search"})),!b&&(0,r.BX)(r.HY,{children:[(0,r.tZ)(B,{reactions:i.suggestedReactionTypes,currentReaction:l,onPick:a,emojiMap:i.reactionTypes,title:"Suggested"}),null===(t=i.categories)||void 0===t?void 0:t.map(e=>(0,r.tZ)(B,{reactions:e.reactionTypes,currentReaction:l,onPick:a,emojiMap:i.reactionTypes,title:e.title},e.title))]})]})]})})}function O(e){var t;let{reaction:n,context:i}=e,o=["posts","feed-subscribed"].includes(i.type)?"/api/v1/community/posts/".concat(i.id,"/reactions"):"/api/v1/community/comments/".concat(i.id,"/reactions"),{result:l,isLoading:a}=(0,f.ib)({pathname:o,method:"GET",auto:!0});if(a)return(0,r.tZ)(T.$j,{});let c=(null!==(t=null==l?void 0:l.reactions.filter(e=>e.reaction===n))&&void 0!==t?t:[]).map(e=>e.user.name),d=c.slice(0,6),s=Math.max(0,c.length-6);return(0,r.BX)(y.tu,{gap:2,position:"relative",onClick:E,overflowY:"auto",children:[d.map(e=>(0,r.tZ)(P,{text:e})),s>0&&(0,r.tZ)(P,{text:"+ ".concat(s," ").concat(1===s?"other":"others")})]})}function B(e){let{reactions:t,currentReaction:n,onPick:i,emojiMap:o,title:l}=e;return(0,r.BX)(y.tu,{gap:4,children:[l&&(0,r.tZ)(I.xv.B4,{color:"secondary",children:l}),(0,r.tZ)(y.xu,{className:k.Z.emojiGrid,gap:2,alignItems:"center",justifyContent:"center",children:null==t?void 0:t.map(e=>(0,r.tZ)(X,{onClick:()=>i(e,o[e]),className:s()(k.Z.emojiBox,{[k.Z.selected]:e===n}),children:(0,r.tZ)(N,{children:o[e]})},e))})]})}function P(e){let{text:t}=e;return(0,r.tZ)(I.xv,{size:12,color:"primary",weight:"medium",font:"text",children:t})}let X=(0,w.zo)({bg:"primary",alignItems:"center",justifyContent:"center",radius:"sm",width:32,height:32,cursor:"pointer"},w.X2),N=(0,w.zo)({fontSize:20,lineHeight:20,color:"primary",fontWeight:"medium",font:"emoji"}),E=e=>{e.stopPropagation(),e.preventDefault()};async function z(e,t,n){try{return await (0,v.rd)("/api/v1/community/".concat(n,"/").concat(t,"/reaction"),{method:"POST",json:{reaction:e}})}catch(e){return e}}async function L(e,t,n){try{return await (0,v.rd)("/api/v1/community/".concat(n,"/").concat(t,"/reaction"),{method:"DELETE",query:{reaction:e}})}catch(e){return e}}},61649:function(e,t,n){n.d(t,{AO:()=>w,AT:()=>Z,BY:()=>_,MZ:()=>I,Sr:()=>M,Zl:()=>T,ar:()=>C,eD:()=>b,l7:()=>R,ss:()=>x});var i=n(7409),o=n(16584),r=n(6400),l=n(30396),a=n(74691),c=n.n(a),d=n(7654),s=n.n(d),u=n(14293),p=n.n(u),m=n(7314),h=n(31012),v=n(36671),f=n(68833),g=n(15771),y=n(19081);let Z=5,C=300,b=600,T=60,x=30,w=e=>{let t=c()(e,1,16),n=b-T;return c()(b-(t-1)/15*n,T,b)},I=e=>{for(let t=16;t>=1;t--)if(w(t)>=2*e)return c()(t,1,16);return 1},k=(0,r.createContext)({clipTimes:null,isClipping:!1,setClipEnd:()=>void 0,setClipStart:()=>void 0,setClipTitle:()=>void 0,virtualizedListRef:{current:null},onCancelClipping:()=>void 0,onStartClipping:()=>void 0,clipTitle:null,zoom:0,setZoom:()=>void 0}),_=e=>{let{children:t,postId:n,videoPlayerRef:r,virtualizedListRef:a}=e,[d,u]=(0,l.eJ)(!1),[m,h]=(0,l.eJ)(),[v,g]=(0,l.eJ)(),[y,b]=(0,l.eJ)(null),[T,w]=(0,l.eJ)(1),_=(0,l.sO)(!1),M=(0,l.Ye)(()=>p()(m)||p()(v)?null:{start:m,end:v},[v,m]);(0,l.d4)(()=>{_.current||void 0==m||void 0==v||(w(I(v-m)),_.current=!0)},[m,v]);let R=(0,l.I4)(e=>{var t,o,l,a,d,m,v,y,T;let{start:w,end:I,source:k,title:_}=e,M=null!==(v=null==r?void 0:null===(o=r.current)||void 0===o?void 0:null===(t=o.player)||void 0===t?void 0:t.duration)&&void 0!==v?v:300;s()(M)&&(M=300);let R=p()(w)||p()(I)?null:{start:w,end:Math.min(I,w+C)},j=null!=R?R:{start:Math.max(0,null!==(y=null==r?void 0:null===(a=r.current)||void 0===a?void 0:null===(l=a.player)||void 0===l?void 0:l.currentTime)&&void 0!==y?y:0),end:Math.min(null!=M?M:Z,(null!==(T=null==r?void 0:null===(m=r.current)||void 0===m?void 0:null===(d=m.player)||void 0===d?void 0:d.currentTime)&&void 0!==T?T:0)+x)};if(R?j.end=Math.max(j.start+Z,j.end):(j.start=c()(j.start,0,M-Z),j.end=c()(j.end,j.start+Z,Math.min(j.start+C,M))),h(j.start),g(j.end),u(!0),_&&b(_),(0,f.j)(f.FP.VIDEO_CLIP_INITIATED,(0,i._)({post_id:n,source:k},R)),!R&&!(null==r?void 0:r.current)){let e=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;setTimeout(()=>{var n,i;(null==r?void 0:null===(i=r.current)||void 0===i?void 0:null===(n=i.player)||void 0===n?void 0:n.readyState)!==4?t<10&&e(t+1):(h(0),g(Math.min(r.current.player.duration,x)))},100)};e()}},[n,r]),j=(0,l.I4)(e=>{var t,n,i;let o=null!==(i=null==r?void 0:null===(n=r.current)||void 0===n?void 0:null===(t=n.player)||void 0===t?void 0:t.duration)&&void 0!==i?i:0,l=c()(e,Z,o);g(l),h(e=>c()(null!=e?e:0,Math.max(l-C,0),l-Z))},[r]),S=(0,l.I4)(e=>{var t,n,i;let o=null!==(i=null==r?void 0:null===(n=r.current)||void 0===n?void 0:null===(t=n.player)||void 0===t?void 0:t.duration)&&void 0!==i?i:0,l=c()(e,0,o-Z);h(l),g(e=>c()(null!=e?e:0,l+Z,Math.min(l+C,o)))},[r]),O=(0,l.I4)(()=>{u(!1)},[]);return(0,o.tZ)(k.Provider,{value:{clipTimes:M,isClipping:d,setClipEnd:j,setClipStart:S,setClipTitle:b,virtualizedListRef:a,onCancelClipping:O,onStartClipping:R,clipTitle:y,zoom:T,setZoom:w},children:t})},M=()=>(0,l.qp)(k),R=()=>{let{zoom:e,setZoom:t}=M();return(0,o.BX)(y.gq,{gap:12,justifyContent:"center",alignItems:"center",children:[(0,o.tZ)(g.hU,{priority:"secondary-outline",size:"sm",onClick:()=>t(Math.max(1,e-1)),children:(0,o.tZ)(m.Z,{size:20})}),(0,o.tZ)(v.Z,{min:1,max:16,step:1,value:e,onChange:t}),(0,o.tZ)(g.hU,{priority:"secondary-outline",size:"sm",onClick:()=>t(Math.min(16,e+1)),children:(0,o.tZ)(h.Z,{size:20})})]})}},79094:function(e,t,n){n.d(t,{T7:()=>g,U:()=>f,zH:()=>y});var i=n(7409),o=n(16584),r=n(6400),l=n(30396),a=n(73510),c=n(10878),d=n(95441),s=n(60807),u=n(25991),p=n(48980),m=n(99916),h=n(84864);let v=(0,r.createContext)(()=>void 0);function f(e){let{children:t}=e,[n,i]=(0,l.eJ)(null),r=()=>i(null);return(0,o.BX)(v.Provider,{value:i,children:[t,(0,o.tZ)(c.u,{isOpen:!!n,onClose:r,pub:null==n?void 0:n.pub,canReportToAdmins:null==n?void 0:n.canReportToAdmins,onSubmit:async function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return r(),null==n?void 0:n.onSubmit(...t)}})]})}function g(){return(0,l.qp)(v)}function y(e){let{comment:t,publication:n,post:r,item:l}=e,c=(0,s.aF)(),v=g(),{iString:f}=(0,d.M1)();return t&&(0,h.canReportComment)(c,t)?(0,o.tZ)(m.sN,{leading:(0,o.tZ)(a.Z,{}),priority:"destructive",onClick:()=>{let e=!!t.publication_id;v({pub:null!=n?n:void 0,canReportToAdmins:e,onSubmit:async n=>{let{reportCategory:o,details:r,reportedToSubstack:l}=n;await (0,p.rd)("/api/v1/comment/".concat(t.id,"/report"),{method:"POST",json:(0,i._)({details:r,reportCategory:o,reportedToSubstack:l},e?{publication_id:t.publication_id}:{})})}})},children:f("Report")}):r&&n&&l&&"context"in l&&u.nH.includes(l.context.type)?(0,o.tZ)(m.sN,{leading:(0,o.tZ)(a.Z,{}),priority:"destructive",onClick:()=>{v({pub:n,canReportToAdmins:!1,onSubmit:async e=>{let{reportCategory:t,details:i}=e;await (0,p.rd)("/api/v1/publications/".concat(n.id,"/posts/").concat(r.id,"/report"),{method:"POST",json:{details:i,reportCategory:t}})}})},children:f("Report")}):null}},76720:function(e,t,n){n.d(t,{A:()=>s});var i=n(16584),o=n(94184),r=n.n(o),l=n(98661),a=n(80026),c=n(63474),d=n(19961);let s=(0,l.forwardRef)((e,t)=>{let{children:n,trailing:o,leading:l,href:s,onClick:u,fillIcon:p,newTab:m,flex:h,className:v,disabled:f}=e,g=s||u,y=!l&&!o;return(0,i.BX)(a.kG,{resetCss:!0,ref:t,className:r()(d.Z.chip,p&&d.Z.fillIcon,g&&d.Z.clickable,y&&d.Z.textOnly,f&&d.Z.disabled,v),flex:h,href:s,onClick:u,pressable:g?"sm":void 0,newTab:m,disabled:f,children:[l&&(0,i.tZ)(c.M5,{className:d.Z.leading,children:l}),(0,i.tZ)(a.xv.B4,{color:f?"tertiary":"primary",userSelect:"none",ellipsis:!0,children:n}),o&&(0,i.tZ)(c.M5,{className:d.Z.trailing,children:o})]})})},97434:function(e,t,n){n.d(t,{B:()=>m,c:()=>p});var i=n(7409),o=n(99282),r=n(98848),l=n(16584),a=n(6400),c=n(30396),d=n(6490),s=n(74312);let u=(0,a.createContext)({open:()=>void 0});function p(e){var t;let{children:n}=e,[r,a]=(0,c.eJ)(null),d=(0,c.Ye)(()=>({open:e=>a(e)}),[]);return(0,l.BX)(u.Provider,{value:d,children:[n,(0,l.tZ)(h,(0,o._)((0,i._)({},r),{source:null!==(t=null==r?void 0:r.source)&&void 0!==t?t:"substack",isOpen:!!r,onClose:()=>a(null)}))]})}function m(){return(0,c.qp)(u)}function h(e){var{isOpen:t,onClose:a}=e,c=(0,r._)(e,["isOpen","onClose"]);return(0,l.tZ)(d.u_,{isOpen:t,onClose:a,children:(0,l.tZ)(s.cr,(0,o._)((0,i._)({},c),{module:"@/frontend/reader2/chat/DmShareModal",onRequest:()=>n.e("2667").then(n.bind(n,84422)),resolve:e=>e.DmComposerModal,onClose:a}))})}},70293:function(e,t,n){n.d(t,{M:()=>o});var i=n(30396);function o(e,t,n){let{shouldCheck:o,threshold:r=200,bodyRef:l}=n,a=(0,i.sO)(),c=null!=l?l:a,d=()=>{let t=c.current;if(t){let{bottom:n}=t.getBoundingClientRect();n<window.innerHeight+r&&e()}};return(0,i.d4)(()=>{if(o)return window.addEventListener("scroll",d,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",d,{capture:!0})}},t),{bodyRef:c,check:d}}},84610:function(e,t,n){n.d(t,{H:()=>r});var i=n(16122),o=n(20591);function r(e){let{category:t,language:n="en"}=e,{iString:i}=I18N.i(n);switch(t){case"hate":return i("Hate");case"private_information":return i("Private information");case"plagiarism":return i("Plagiarism");case"impersonation":return i("Impersonation");case"illegal_activity":return i("Illegal activity");case"spam":return i("Spam");case"pornography":return i("Pornography");case"other":return i("Other");default:return console.error("unrecognized category",t),i("Other")}}let l=i.Ry({name:i.Z_().meta({title:"Name",description:"The name of the content policy"}),description:i.Z_().min(1).max(1e3).meta({title:"Description",description:"A short description of the policy"}),category:i.Km(o.Z_).meta({title:"Category",description:"The category of the content policy"}),violation_examples:i.IX(i.Z_().min(1).max(500)).meta({title:"Violation Examples",description:"Examples of content that violate the policy"}),non_violation_examples:i.IX(i.Z_().min(1).max(500)).meta({title:"Non-Violation Examples",description:"Examples of content that do not violate the policy"})}),a=i.Ry({content_policies:i.IX(l).meta({title:"Specifications",description:"Each of the policies below will be included in LLM prompts to help guide the model when evaluating content."})});i.Ry({main:a.meta({description:"Warning! Updates to this config will be applied in production immediately."}),test:a.meta({description:"Test changes to the content policies before applying them to the main config."})}).meta({$id:"moderation-config/content_policies/v2",title:"Content Policies",description:"The content policies to include in LLM prompts"})},12120:function(e,t,n){function i(e,t){let n=new Set(e);return n.add(t),n}function o(e,t){let n=new Set(e);return n.delete(t),n}function r(e,t){return new Set([...e].filter(e=>!t.has(e)))}n.d(t,{e5:()=>r,oR:()=>i,zu:()=>o})}}]);