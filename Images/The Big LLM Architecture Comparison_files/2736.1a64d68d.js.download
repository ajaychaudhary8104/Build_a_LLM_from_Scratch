"use strict";(self.webpackChunksubstack=self.webpackChunksubstack||[]).push([["2736"],{85131:function(e,t,i){i.d(t,{Z:()=>a});let a={gifPreview:"gifPreview-aspqQH",visible:"visible-LWauZo",image:"image-Aqe6vn",videoPlayerWrapper:"videoPlayerWrapper-cIRA2m",videoPlayerClassName:"videoPlayerClassName-wHpwKj",videoClassName:"videoClassName-F40TTj"}},20392:function(e,t,i){i.d(t,{Z:()=>a});let a={container:"container-AejwGn",tab:"tab-FhVbMD",highlight:"highlight-rZ7aQJ"}},90311:function(e,t,i){i.d(t,{SP:()=>J,fB:()=>V,hp:()=>Y});var a=i(27412),n=i(7409),o=i(99282),s=i(16584),l=i(6400),c=i(30396),r=i(94184),d=i.n(r),p=i(39693),h=i.n(p),m=i(33112),u=i(39432),v=i(64579),Z=i(21286),g=i(25265),_=i(21206),b=i(39929),f=i(54688),k=i(48917),N=i(94922),w=i(94442),y=i(85685),C=i(30329),S=i(95441),P=i(40647),x=i(90099),B=i(68833),M=i(7882),A=i(94874),L=i(24547),U=i(19081),X=i(58175),F=i(2009),W=i(98012),I=i(24430),R=i(40894),z=i(24791),T=i(31377),O=i(60308),E=i(33884),D=i(63651),H=i(84864),K=i(47929);class j extends l.Component{componentWillUnmount(){this.unmounted=!0}render(e){let{pub:t,post:i,showAuthor:a,showPhoto:l,fromPostPage:c}=e;return(0,w.F6)({pub:t,post:i,showAuthor:a,showPhoto:l})||(0,w.Cz)({pub:t,post:i,showAuthor:a})||(0,w.z5)({pub:t,post:i,showAuthor:a})?this.withAuthorLine(this.props,this.state):(0,s.tZ)($,(0,o._)((0,n._)({},this.props),{editOnRightSide:this.props.showUpdatedIcons,className:this.props.showUpdatedIcons?"alternative-meta":this.props.className,isMobileWidth:this.state.isMobileWidth,actionBarStyle:c?"post-header-compact":"post-preview"}))}constructor(e,t){var i;if(super(e,t),(0,a._)(this,"unmounted",void 0),(0,a._)(this,"withAuthorLine",(e,t)=>{let{pub:i,post:a,showAuthor:n,showPhoto:o,getConfigFor:l,isAppMode:c}=e,r="adhoc_email"===a.type,p=(0,H.getBylineUsers)(a).length,h=1===p&&(0,H.getBylineUsers)(a)[0],m=h&&h.is_guest&&!l("dont_show_guest_byline")&&!r,u=e.showDate||e.showDatetime,v=!a.is_published&&!e.inThreadHead&&u&&!r,Z=e.isFreePreview&&e.showAudience&&u&&!r,g=(0,T.isFoundingAudience)(a.audience)&&e.showAudience&&!Z&&u&&!r&&!(0,z.sv)({post:a}),_=(0,T.isPaidAudience)(a.audience)&&e.showAudience&&!g&&!Z&&u&&!r&&!(0,z.sv)({post:a}),b=(0,w.F6)({pub:i,post:a,showAuthor:n,showPhoto:o});return(0,s.tZ)(x.YF,{width:"100%",className:d()("post-meta"),children:(0,s.BX)("tr",{children:[(0,s.tZ)("td",{children:(0,s.BX)(x.i$,{children:[(0,s.tZ)(x.zK,{gap:4,children:(0,s.tZ)(X.xv.Meta,{color:"primary",className:I.A.postAuthor,children:p>0?(0,H.oxfordComma)((0,H.getBylineUsers)(a).map(e=>(0,s.tZ)(X.xv.Meta,{as:"a",href:c?(0,D.FA)({user_id:e.id,user_name:e.name,redirect:"app-store-no-desktop"}):(0,O.LwU)(e,i),color:"primary",style:"text-decoration: none",children:e.name}))):(0,H.getPrintedByline)(i,a)})}),(0,s.BX)(x.zK,{gap:4,children:[(0,s.tZ)(X.xv.Meta,{children:(e.showDate||e.showDatetime)&&a.post_date&&(0,s.tZ)("time",{dateTime:(0,W.Z)(a.post_date).toISOString(),children:(0,W.Z)(a.post_date).locale(this.context.language).standardDate()})}),_&&(0,s.BX)(x.zK,{gap:4,children:[(0,s.tZ)(X.xv.Meta,{children:"∙"}),(0,s.tZ)(X.xv.Meta,{color:"paid",translated:!0,children:"Paid"})]}),g&&(0,s.BX)(x.zK,{gap:4,children:[(0,s.tZ)(X.xv.Meta,{children:"∙"}),(0,s.tZ)(X.xv.Meta,{color:"paid",children:this.context.iString((0,z.a_)(i,a))})]}),Z&&(0,s.BX)(x.zK,{gap:4,children:[(0,s.tZ)(X.xv.Meta,{children:"∙"}),(0,s.tZ)(X.xv.Meta,{color:"paid",translated:!0,children:"Preview"})]}),m&&(0,s.BX)(x.zK,{gap:4,children:[(0,s.tZ)(X.xv.Meta,{children:"∙"}),(0,s.tZ)(X.xv.Meta,{translated:!0,children:"Guest post"})]}),v&&(0,s.BX)(x.zK,{gap:4,children:[(0,s.tZ)(X.xv.Meta,{children:"∙"}),(0,s.tZ)(X.xv.Meta,{translated:!0,children:"Draft"})]})]})]})}),b&&(0,s.tZ)("td",{align:"right",children:(0,s.tZ)(x.zK,{gap:4,children:p>0&&(0,H.getBylineUsers)(a).map((e,t)=>{var a;return t<4&&(0,s.tZ)("a",{href:c?(0,D.FA)({user_id:e.id,user_name:e.name,redirect:"app-store-no-desktop"}):(0,O.LwU)(e,i),children:(0,s.tZ)(x.NS,{src:null!==(a=e.photo_url)&&void 0!==a?a:"",size:p>1?32:40})})})})})]})})}),"undefined"!=typeof window&&(null===(i=window)||void 0===i?void 0:i.matchMedia)){let e=window.matchMedia("screen and (max-width: 650px)");this.state={isMobileWidth:e.matches};let t=e=>{this.unmounted||this.setState({isMobileWidth:e.matches})};e.addEventListener?e.addEventListener("change",t):e.addListener&&e.addListener(t)}}}(0,a._)(j,"contextType",S.wj);let J=(0,P.xY)(j);function V(e){var t,i;let{pub:a,post:o,user:r,reactors:d,secondaryFaces:p,mediaClipId:h}=e,[u,v]=(0,c.eJ)(null),[Z,g]=(0,c.eJ)(!1),_=(0,M.ib)({pathname:"primary"===u?"/api/v1/post/".concat(o.id,"/reactors"):"/api/v1/".concat(h?"media_clip":"post","/").concat(null!=h?h:o.id,"/restackers"),auto:!!u,deps:[o.id,u]}),b=Q(d,r,!!o.reaction,a),f=Q(p,r,!!o.restacked,a),k=b.concat(f.filter(e=>!!e.photo_url&&!b.find(t=>t.id===e.id))),N=Math.max(null!==(t=o.reactions["❤"])&&void 0!==t?t:0,(null!=b?b:[]).length),w=a.hide_post_restacks?0:null!==(i=o.restacks)&&void 0!==i?i:0,y=N>0?(0,H.pluralize)(N,"Like"):"",C="";return w>0&&(C="".concat((0,H.pluralize)(w,"Restack"))),(0,s.BX)(s.HY,{children:[(0,s.BX)(U.X2,{gap:16,alignItems:"center",color:"secondary",children:[(0,s.tZ)(L.H,{users:k,renderAvatar:e=>(0,s.tZ)(A.xV,(0,n._)({},e)),direction:"rtl",renderCount:()=>(0,s.tZ)(l.Fragment,{})}),(0,s.tZ)(X.xv.B4,{color:"secondary",children:(0,s.BX)(U.X2,{gap:4,alignItems:"center",children:[(0,s.tZ)(q,{label:y,onClick:()=>{N&&((0,B.j)(B.FP.POST_REACTIONS_MODAL_VIEWED,{post_id:o.id}),v("primary"),g(!0))}}),y&&C&&"∙",(0,s.tZ)(G,{post:o,label:C})]})})]}),_.result&&(0,s.tZ)(m.F,{isOpen:Z,modalLabel:y,faces:_.result,totalCount:N,onClose:()=>{g(!1),v(null)},utmSource:"post-reactions-modal"})]})}let q=e=>{let{label:t,onClick:i}=e;return(0,s.tZ)(X.hh,{onClick:i,color:"secondary",cursor:"pointer",children:t})},G=e=>{let{label:t,post:i}=e;return(0,s.tZ)(X.xv.B4,{color:"secondary",children:(0,s.tZ)(X.hh,{href:(0,E.Oi)(i.id,{noBase:F.L,urlParams:{utm_source:K.b3.substack,utm_content:K.fZ.facepileRestacks}}),color:"secondary",children:t})})};function Y(e){var t,i;let{post:a,user:o,pub:l,mediaClipId:c}=e,r=(0,M.ib)({pathname:"/api/v1/post/".concat(a.id,"/facepile"),auto:!0,deps:[a.id,c],query:{media_clip_id:c}});return(0,s.tZ)(V,(0,n._)({reactors:Q(null===(t=r.result)||void 0===t?void 0:t.reactors,o,!!a.reaction,l),secondaryFaces:Q(null===(i=r.result)||void 0===i?void 0:i.restackers,o,!!a.restacked,l)},e))}function Q(e,t,i,a){if(!e)return[];if(t){let n=e.findIndex(e=>e.id===t.id);i&&("private"!==t.subscription_visibility||46438===a.id)&&t.activity_likes_enabled&&n<0?e.splice(0,0,{id:t.id,name:t.name,photo_url:t.photo_url}):!i&&n>=0&&e.splice(n,1)}return e}function $(e){var t;let i,{additionalCommentCount:a=0,className:n,user:o,pub:l,post:c,showAudience:r=!1,showDate:p=!1,showEmailSent:m=!1,showDatetime:Z=!1,showReactions:S=!0,showComments:P=!0,showShare:x=!1,showRestack:B=!1,showPublicationName:M=!1,hidePinning:A=!1,reaction_token:L,onClick:U,onChange:F,isStatic:I=!1,isFreePreview:z=!1,allowSendEmail:E=!1,allowEdit:D=!1,shareTooltipText:j,showPins:J,sharedShareDialog:V,showUpdatedIcons:q,editOnRightSide:G=!1,onClickCommentButton:Y,showAuthor:Q,showPhoto:$,fromPostPage:et,isMobileWidth:ei,actionBarStyle:ea="post-header-compact"}=e,en=l.id===c.publication_id?l:void 0,eo="post-footer"===ea,es=eo?20:"post-preview"===ea?14:18,el="post-header-large"===ea?20:"post-preview"===ea?16:"thread-head"===ea||eo?14:18;i=c.comment_url_override?c.comment_url_override:I?"".concat(R.W.HALF_MAGIC_COMMENTS_URL,"&utm_source=").concat(K.b3.substack,"&utm_medium=").concat(K.lP.email):(0,O.uRy)(l,c,{comments:!0});let ec=a+(null!==(t=c.comment_count)&&void 0!==t?t:0),er=P&&!z&&(0,H.showCommentsOnPost)({publication:l,post:c})&&"restack"!==c.type,ed=S&&!z&&!["adhoc_email","restack"].includes(c.type),ep=(p||Z)&&c.post_date&&!c.is_draft,eh=m?!!c.email_sent_at:null,em=h()([m&&eh&&{className:"email-sent",title:"This post was sent as an email",content:(0,s.tZ)(u.Z,{className:"post-meta-icon",height:es,isStatic:I})},J&&c.is_section_pinned&&{className:"icon pinned",content:(0,s.tZ)(b.Z,{className:"post-meta-icon",isStatic:I})},"adhoc_email"===c.type?{className:"audience-adhoc",content:(0,s.tZ)(f.Z,{className:"post-meta-icon",isStatic:I})}:r&&(0,T.isPaidAudience)(c.audience)&&{className:"audience-lock",content:(0,s.tZ)(v.Z,{color:"#666666",height:es,isStatic:I})},(0,w.Er)({pub:l,post:c,showAuthor:Q,showPhoto:$,isMobileWidth:ei})&&{className:"author",content:(0,H.getBylineUsers)(c).length>0?(0,H.oxfordComma)((0,H.getBylineUsers)(c).map(e=>(0,s.tZ)(y.ProfileHoverCard,{disabled:I,subject:e,utmSource:"byline",children:(0,s.tZ)("a",{href:(0,O.LwU)(e,l),onClick:e=>e.stopPropagation(),children:e.name})}))):(0,H.getPrintedByline)(l,c)},M&&{className:"post-publication-name",content:l.name},q&&!G&&D&&!I&&o&&o.is_contributor&&{className:"post-meta-item icon edit-icon",onClick:e=>e.stopPropagation(),content:(0,s.tZ)(k.l,{pub:l,post:c,iconHeight:es,hidePinning:A,user:o,emailSent:eh,allowSendEmail:E,showUpdatedIcons:q})},ep&&{className:"post-date",title:(0,W.Z)(c.post_date).toISOString(),content:(0,s.tZ)(X.xv.Meta,{children:(0,s.tZ)("time",{dateTime:(0,W.Z)(c.post_date).toISOString(),children:(0,w.fh)({post:c,showDatetime:Z,isStatic:I,fromPostPage:et,showReactions:ed})})})},(null==en?void 0:en.community_enabled)&&c.slug&&ed&&!c.is_draft&&{className:"icon",onClick:e=>e.stopPropagation(),content:(0,s.tZ)(C.dJ,{user:o,pub:l,post:c,token:L,onChange:e=>{null==F||F(e)},height:el,isStatic:I,buttonStyle:eo,className:"post-meta-icon like-reaction-button",hideReactionCount:eo&&!I})},o&&{className:"icon",onClick:e=>e.stopPropagation(),content:(0,s.tZ)(ee,{post:c,isPostFooter:eo,isStatic:I,lucideIconHeight:el,onChange:F})},(null==en?void 0:en.community_enabled)&&c.slug&&er&&!c.is_draft&&{className:"icon",onClick:e=>e.stopPropagation(),content:(0,s.BX)("a",{className:eo?"post-meta-button button":"",href:i,native:en&&(0,O.Fdd)(document.location.pathname),onClick:Y,children:[(0,s.tZ)(g.Z,{className:"comment-icon post-meta-icon",isStatic:I,height:el,alt:"Comment",stroke:"#757575",fill:"transparent",strokeWidth:I?1:1.5,ampProps:{layout:"fixed"}}),!ec&&eo&&(0,s.tZ)("span",{className:"meta-button-label",children:"Comment"}),ec>0&&(0,s.tZ)("span",{className:"comment-count",children:(0,H.numberToString)(ec)})]})},B&&!eo&&{className:"icon",onClick:e=>e.stopPropagation(),content:(0,s.BX)("a",{href:R.W.RESTACK_URL,className:eo?"button post-meta-button":void 0,children:[(0,s.tZ)(_.Z,{className:"recommend-icon post-meta-icon",isStatic:I,height:el,alt:"Recommend",stroke:"#757575",fill:"transparent",strokeWidth:I?1:1.5,ampProps:{layout:"fixed"}}),eo&&(0,s.tZ)("span",{className:"meta-button-label",children:"Recommend"})]})},x&&"only_free"!==c.audience&&!c.is_draft&&!z&&{className:"icon",onClick:e=>e.stopPropagation(),content:(0,s.BX)(N.v,{user:o,pub:en,post:c,reaction_token:L,height:el,onChange:F,isStatic:I,sharedShareDialog:V,position:"post-footer"===ea?"post-footer":"post-header",linkClassName:eo?"button post-meta-button":void 0,children:[eo&&(0,s.tZ)("span",{className:"meta-button-label",children:"Share"}),j&&(0,s.tZ)("div",{className:"share-tooltip-wrap",children:(0,s.tZ)("div",{className:"share-tooltip",children:j})})]})},(!q||G)&&D&&!I&&o&&o.is_contributor&&{className:"icon edit-icon",onClick:e=>e.stopPropagation(),content:(0,s.tZ)(k.l,{pub:l,post:c,iconHeight:es,hidePinning:A,user:o,emailSent:eh,allowSendEmail:E,showUpdatedIcons:q})}]);return I?(0,s.tZ)("table",{className:d()("post-meta custom",{big:eo},n),cellpadding:"0",cellspacing:"0",onClick:U,children:(0,s.tZ)("tr",{children:em.map(e=>{let{className:t,title:i,onClick:a,content:n}=e;return(0,s.tZ)("td",{className:d()("post-meta-item",t),title:i,onClick:a,children:n})})})}):(0,s.tZ)("div",{className:d()("post-meta post-meta-actions-web custom",{big:eo},n),onClick:U,children:em.map(e=>{let{className:t,title:i,onClick:a,content:n}=e;return(0,s.tZ)("div",{className:d()("post-meta-item",t),title:i,onClick:a,children:n})})})}function ee(e){let{post:t,isPostFooter:i,isStatic:a,lucideIconHeight:l,onChange:c}=e,{onSave:r,isSaved:p}=(0,w.vk)({post:t,isSaved:t.is_saved});return(0,s.BX)("a",{className:d()("post-meta-save-button",i?"post-meta-button button":"",{isSaved:p}),href:a&&R.W.SAVE_POST_URL||void 0,onClick:()=>{let e=r();null==c||c({post:(0,o._)((0,n._)({},t),{is_saved:e})})},children:[(0,s.tZ)(Z.Z,{isStatic:a,height:l,stroke:"#757575",strokeWidth:a?1:1.5}),i&&(0,s.tZ)("span",{className:"meta-button-label",children:"Save"})]})}},93029:function(e,t,i){i.d(t,{Z:()=>d});var a=i(16584),n=i(30396),o=i(94184),s=i.n(o),l=i(74571),c=i(60308),r=i(85131);let d=e=>{let{post:t,containerRef:i,aspectRatio:o,size:d="small",alwaysShow:p=!1,className:h}=e,[m]=(0,l.i5)(i),[u,v]=(0,n.eJ)(!1),Z=(0,c.W$Z)({post:t,height:"large"===d?480:320});return Z&&(m||p)?(0,a.tZ)("div",{className:s()(r.Z.gifPreview,{[r.Z.visible]:u},h),children:(0,a.tZ)("img",{className:r.Z.image,src:Z,style:"aspect-ratio: ".concat(o),onLoad:()=>v(!0)})}):null}}}]);